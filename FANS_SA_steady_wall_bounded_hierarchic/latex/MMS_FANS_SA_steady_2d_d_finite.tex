\documentclass[10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amssymb, amsmath, amsfonts, amsthm, wasysym} % math
\usepackage{nicefrac}
\usepackage{geometry}
\usepackage{epsfig, subfigure} % graphics
%\usepackage[mathcal]{euscript}
\geometry{ top=2.5cm, bottom=2cm, left=2cm, right=2cm}
\usepackage[authoryear]{natbib}
\usepackage{pdflscape}
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm,  right=2cm}

\newcommand{\D}{\partial}
\newcommand{\Diff}[2] {\dfrac{\partial\left( #1\right)}{\partial #2}}
\newcommand{\diff}[2] {\dfrac{\partial #1}{\partial #2}}
\newcommand{\bv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}
\newcommand{\gv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}% for vectors of Greek letters
\newcommand{\grad}[1]{\gv{\nabla} #1}
\newcommand{\Rho}{\,\mathtt{Rho}}
%\newcommand{\PP}{\,\mathtt{P}}
\newcommand{\U}{\,\mathtt{U}}
\newcommand{\V}{\,\mathtt{V}}
\newcommand{\Nu}{\,\mathtt{Nu_{sa}}}
\newcommand{\T}{\,\mathtt{T}}
\newcommand{\Mu}{\,\mathtt{Mu}}
\newcommand{\Lo}{\,\mathcal{L}}
\newcommand{\Dueqplusyplus}{\, \frac{du_{eq}^+}{dy^+}\,}

% commands I like
\newcommand{\mbb}[1]{\mathbb{#1}}
\newcommand{\mbf}[1]{\mathbf{#1}}
\newcommand{\sbf}[1]{\boldsymbol{#1}}
\newcommand{\mcal}[1]{\mathcal{#1}}
\newcommand{\mfk}[1]{\mathfrak{#1}}
\newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\newcommand{\rarrow}{\rightarrow}
\newcommand{\Rarrow}{\Rightarrow}
\newcommand{\LRarrow}{\Leftrightarrow}
\newcommand{\jump}[1]{\llbracket #1 \rrbracket}
\newcommand{\avg}[1]{\{ #1 \}}
\def\etal{{\it et al.~}}
\newcommand{\vvvert}{|\kern-1pt|\kern-1pt|}
\newcommand{\enorm}[1]{\vvvert #1 \vvvert}
\newcommand{\ud}{\,\mathrm{d}}

\newcommand{\sa}{\nu_{\mathrm{sa}}}
\newcommand{\tsa}{\mathrm{sa}}
\newcommand{\brho}{\bar{\rho}}
\newcommand{\bp}{\bar{p}}
\newcommand{\bq}{\bar{q}}
\newcommand{\tu}{\tilde{u}}
\newcommand{\tv}{\tilde{v}}
\newcommand{\tS}{\tilde{S}}
\newcommand{\tE}{\tilde{E}}
\newcommand{\bmu}{\bar{\mu}}
\newcommand{\hh}{\tilde{h}}
%opening
\title{Manufactured Solution for the 2D steady Favre--Averaged Navier--Stokes Equations with Spalart--Allmaras turbulence model}

\author{Kemelli C. Estacio-Hiroms$^*$ \\ Todd Oliver\thanks{Center for Predictive Engineering and Computational Sciences (PECOS), Institute for Computational
    Engineering and Sciences, The University of Texas at Austin,
    Austin, TX 78712 (\{kemelli,oliver\}@ices.utexas.edu)}}

\begin{document}

\maketitle
\tableofcontents

\begin{abstract}
The Method of Manufactured Solutions is a valuable approach for code verification, providing means to verify how accurately the numerical method solves the partial differential equations of interest.
This document presents the source terms generated by the application of the Method of Manufactured Solutions on the 2D steady Favre--Averaged Navier--Stokes Equations with Spalart--Allmaras turbulence model using analytical manufactured solutions that  reasonably resemble the inner portion (viscous sublayer and logarithmic layer) of a zero pressure gradient boundary layer.
\end{abstract}



%%%For the sake of clarity and simplicity
%%%

\section{Mathematical Model}

%-------------------------------------------------
Turbulent flows occur at high Reynolds numbers, when the inertia of the fluid overwhelms the viscosity of the fluid, causing the laminar flow motions to become unstable. Under these conditions, the flow is characterized by rapid fluctuations in pressure and velocity which are inherently three dimensional and unsteady. Turbulent flow is composed of large eddies that migrate across the flow generating smaller eddies as they go. These smaller eddies in turn generates smaller eddies until they become small enough that their energy is dissipated due to the presence of molecular viscosity.

In practice, the effect of this sensitivity
is to make the value of any flow quantity at any particular point in
time and space uncertain.  Thus, these quantities may be viewed as
random variables with associated probability density functions,
allowing the use of statistical techniques in the description and
analysis of the flow. Or, in other words, the full influence of the turbulent fluctuations on the mean flow must be modeled.

For flows with significant density variations it is possible to  capture the turbulent effects using the Favre averaged Navier-Stokes equations (FANS), together with baseline compressible Spalart--Allmaras (SA) turbulent model~\citep{Oliver2010,Spalart_1994_One_Eqn_Turb_Model}. For the steady-state case, the equations are given as follows.

Mass conservation:
\begin{equation}\label{eq:ns01}
 \pp{}{x_i} (\bar{\rho}\tilde{u}_i) = 0, 
\end{equation}

Momentum conservation:
\begin{equation}\label{eq:ns02}
 \pp{}{x_j} \left(\bar{\rho} \tilde{u}_j \tilde{u}_i  \right) = - \, \pp{\bar{p}}{x_i} + \pp{}{x_j}\left( 2 (\bar{\mu} + \mu_t) \tilde{S}_{ji} \right), \\
\end{equation}

Total energy conservation:
\begin{equation}\label{eq:ns03}
 \pp{}{x_j} \left[ \bar{\rho} \tilde{u}_j \left( \tilde{h} + \frac{1}{2} \tilde{u}_i \tilde{u}_i \right) \right] =  \pp{}{x_j} \left( 2 (\bar{\mu} + \mu_t) \tilde{S}_{ji} \tilde{u}_i \right) + \pp{}{x_j} \left[ \left( \frac{\bar{\mu}}{\\Pr} + \frac{\mu_t}{\Pr_t} \right) \pp{\tilde{h}}{x_j} \right], \\
\end{equation}

Baseline compressible Spalart--Allmaras equation:
\begin{equation}\label{eq:ns04}
 \pp{}{x_j} (\bar{\rho} \tilde{u}_j \sa) =  c_{b1} S_{\mathrm{sa}} \bar{\rho} \sa - c_{w1} f_w \bar{\rho} \left( \frac{\sa}{d} \right)^2 + \frac{1}{\sigma_{\tsa}} \pp{}{x_k} \left[ (\bar{\mu} + \bar{\rho} \sa) \pp{\sa}{x_k} \right] + \frac{c_{b2}}{\sigma_{\tsa}} \bar{\rho} \pp{\sa}{x_k} \pp{\sa}{x_k},
\end{equation}
%
where $[\tilde{\,\,}]$ denotes a Favre-averaging variable and $[\bar{\,\,}]$ denotes Reynolds averaging.

To close the equations, many additional relationships are
necessary---e.g., a constitutive relation for the viscous stress, an
equation of state, etc. In this work, the gas is considered calorically perfect and:
%
\begin{equation}
 \begin{split}\label{eq:closure}
&\bar{\mu} =\texttt{constant}, \quad \tilde{S}_{ij} = \tilde{s}_{ij} - \frac{1}{3} \tilde{s}_{kk} \delta_{ij}, \quad \tilde{s}_{ij} = \frac{1}{2} \left( \pp{\tilde{u}_i}{x_j} + \pp{\tilde{u}_j}{x_i} \right), \\
&\bar{p} = \bar{\rho} R \tilde{T}, \quad \tilde{e} = c_v \tilde{T}, \quad \tilde{h} = c_p \,  \tilde{T} = \tilde{e} + \frac{\bar{p}}{\bar{\rho}}, \quad\mu_t \, = \bar{\rho} \nu_t = \bar{\rho} \sa f_{v1}, \\
& S_{\mathrm{sa}} = \Omega + S_m, \quad \Omega = \sqrt{2 \tilde{\Omega}_{ij} \tilde{\Omega}_{ij} }, \quad \widetilde{\Omega}_{ij} = \frac{1}{2} \left( \pp{\tilde{u}_i}{x_j} - \pp{\tilde{u}_j}{x_i} \right), \\
&f_{v2} = 1 - \frac{\chi}{1 + \chi f_{v1}}, \quad f_{v1} = \frac{\chi^3}{\chi^3 + c_{v1}^3}, \quad \chi = \frac{\sa}{\tilde{\nu}}, \\
&f_w = g \left( \frac{1 + c_{w3}^6}{g^6 + c_{w3}^6} \right)^{1/6}, \quad g = r + c_{w2} \left( r^6 - r \right), \quad r = \frac{\sa}{S_{\mathrm{sa}} \kappa^2  d^2}, 
 \end{split}
\end{equation}
%
where $d$ is the distance to the nearest no-slip wall. The constants $c_v$ and $c_p \, $ are fluid properties.  The constants $c_{b1}$, $c_{b2}$, $c_{v1}$, $\sigma_{\tsa}$,
$c_{w1}$, $c_{w2}$, $c_{w3}$, and $kappa $ are the SA model calibration parameters.

Note that the $S_{\mathrm{sa}}$ function is
modified to avoid bad behavior introduced by the $f_{v2}$ function; $S_m$ is defined as follows:
\begin{equation*}
S_m = \left\{ \begin{array}{cc}
S_{m, orig}, & S_{m,orig} \geq -c_{v2} \Omega \vspace{5pt}\\ 
\dfrac{\Omega (c_{v2}^2 \Omega + c_{v3} S_{m,orig})}{ (c_{v3}-2.0c_{v2}) \Omega - S_{m,orig}}, & \quad \mathrm{otherwise}.
\end{array}
\right.
\end{equation*}
with 
\begin{equation*}
S_{m, orig} = \frac{\sa}{\kappa^2 \, d^2} f_{v2}.
\end{equation*}

%The constants are set as $c_{v2} = 0.7$ and $c_{v3} = 0.9$.
\paragraph{Note:} Rigorously, the distance to the nearest no slip wall $d$ is defined by $d = \sqrt{(x-x_n)^2 + (y-y_n^2)}$ where $(x_n,y_n)$ is the nearest point on the boundary. The nearest point on the boundary is defined by $(x_n,y_n) = \arg \min f(x_b,y_b)$, where $f = \sqrt{(x-x_b)^2 + (y-y_b)^2}$ is simply the distance between $(x,y)$ and $(x_b,y_b)$.

In the problem considered here, $(x_n,y_n) = (x,0)$, which gives $d=y$.

\section{Manufactured Solutions}

The Method of Manufactured Solutions (MMS) applied to Favre--Averaged Navier--Stokes equations with baseline compressible Spalart--Allmaras turbulence model consists in modifying Equations~(\ref{eq:ns01})~--~(\ref{eq:ns04}) by adding a source term to the right-hand side of each equation, so the modified set of equations conveniently has the analytical solution chosen \textit{a priori}.

To exercise all of the terms in the equation, the
solution must satisfy the no-slip wall boundary condition for at least
some portion of the boundary.  To avoid pathological behavior in the
solution and required source terms, we strive to make the manufactured
solution reasonably resemble the inner portion (viscous sublayer +
logarithmic layer) of a zero pressure gradient boundary layer.  To
accomplish this goal, the manufactured solution is built using
well-known correlations for turbulent boundary layers. For details, see Appendix \ref{oliver}.

They are\footnote{Note that the tildes and overbars in Eq. (\ref{eq:manufactured_2d}) - and also throughout Appendix \ref{oliver} - have been omitted for the sake of clarity.}:
\begin{equation}
\begin{split}\label{eq:manufactured_2d}
u &= \frac{u_{\infty}}{A} \sin \left( \frac{A}{u_{\infty}} u_{eq} \right),\\
v &= -\eta_v \dd{u_{\tau}}{x} y,\\
T &= T_{\infty} \,  \left[ 1 + r_T \, \frac{\gamma - 1}{2} M_{\infty}^2 \, \left( 1 - \left(\frac{u}{u_{\infty}}\right)^2 \right) \right],\\
\rho &= \frac{p_0}{R T},\\
\sa &= \kappa \,  u_{\tau} y - \alpha y^2.
\end{split}
\end{equation}
 %
The pressure is chosen to be a constant $p = p_0$. Values $u_{\infty}$ and $A$ are constants, $\eta_v$ is a user-specified parameter. $T_{\infty} \, $, $M_{\infty}$, $r_T$, $\gamma$, $\kappa $ and $\alpha$ are additional constant parameters (e.g. see Tables \ref{tbl:soln_parameters} and \ref{tbl:additional_constants}). 

The van Driest equivalent velocity $u_{eq}$, the friction velocity $u_{\tau}$ and the non-dimensionalized van Driest velocity profile $u_{eq}^+$ are given by:
\begin{equation}
\begin{split}
u_{eq} &= u_{\tau} u_{eq}^+,\\
u_{\tau}  &= u_{\infty} \sqrt{\frac{c_f}{2}}, \\
u_{eq}^+ &= \frac{1}{\kappa } \log \left( 1 + \kappa \,  y^+ \right) + C_1 \left[ 1 - \exp({-y^+/\eta_1}) - \frac{y^+}{\eta_1} \exp({-y^+ b}) \right]
\end{split}
\end{equation}
with 
$$c_f = \dfrac{C_{cf}}{F_c} \left( \dfrac{Re_x}{F_c}  \right)^{-1/7}, \quad Re_x= \dfrac{\rho_{\infty} u_{\infty} x}{\mu}, \quad\text{and}\quad y^{+}= \dfrac{y u_\tau}{\nu_w},$$ 
where $\eta_1,$ $b$, $C_1 = -(1/\kappa ) \log(\kappa ) + C$, $C$, $C_{cf}$, $F_c$, $\rho_{\infty}$, and $\nu_w$ are constants that can be computed from the parameters
(Tables \ref{tbl:soln_parameters} and \ref{tbl:additional_constants}).

Additionally,
\begin{equation}\label{dueqplus}
\dd{u_{eq}^+}{y^+} = \frac{1}{\left( 1 + \kappa \,  y^+ \right)} + C_1 \left[ \frac{1}{\eta_1} \exp({-y^+/\eta_1}) - \frac{1}{\eta_1} \exp({-y^+ b}) + b \frac{y^+}{\eta_1} \exp({-y^+ b}) \right].
\end{equation}



Source terms  for mass conservation ($Q_{\brho}$), momentum ($Q_{\tu}$ and $Q_{\tv}$), total energy ($Q_{\tE}$) and SA variable ($Q_{\sa}$) equations are obtained by symbolic manipulations of FANS equations with SA turbulence model above using Maple~15~\citep{Maple15} and are presented in the following sections.



 \subsection{2D FANS Equations and SA Turbulence Model}\label{NS+SA}



MMS applied to the 2D steady FANS equations with SA turbulent model simply consists in modifying Equations~(\ref{eq:ns01})~--~(\ref{eq:ns04}) by adding a source term to the right-hand side of each equation:
 \begin{equation}
 \begin{split} \label{eq:ns2d_mod}
 &\nabla \cdot \left(\bar{\rho} \tilde{\bv{u}}\right) = Q_{\brho},\\
 &\nabla\cdot\left(\bar{\rho} \tilde{\bv{u}}\tilde{\bv{u}}\right) +\nabla \bar{p} -  \nabla \cdot ( 2(\bmu+\mu_t) \tilde{\bv{S}} )= Q_{\bv{\tu}},\\
 & \nabla \cdot (\bar{\rho} \tilde{\bv{u}} \tilde{H})-\nabla \cdot \bar{\bv{q}} - \nabla\cdot(2 (\bmu+\mu_t) \tilde{\bv{S}} \cdot \tilde{\bv{u}})= Q_{\tE},\\
 &\nabla \cdot (\bar{\rho} \tilde{\bv{u}} \sa) - c_{b1} S_\tsa \bar{\rho} \sa +c_{w1} f_w \brho \left(\dfrac{\sa}{d}\right)^2 - \dfrac{1}{\sigma_{\tsa}}\nabla \cdot \left( (\bmu+\bar{\rho}  \sa) \nabla \sa\right) -\dfrac{c_{b2} \bar{\rho} }{\sigma_{\tsa}} \nabla \sa \cdot \nabla \sa =Q_{\sa},
 \end{split}
 \end{equation}
so the modified set of Equations (\ref{eq:ns2d_mod}) has Equation (\ref{eq:manufactured_2d}) as analytical solution.

Recall that the averaged kinematic viscosity, total energy per unit mass and the total enthalpy per unit mass are given, respectively, by:
\begin{equation}
 \begin{split}\label{eq:closure01}
  \tilde{\nu}=\dfrac{\bar{\mu}}{\bar{\rho}},\qquad \tilde{E}=\tilde{e}+\dfrac{\tilde{\bv{u}}\cdot \tilde{\bv{u}}}{2}, \quad \tilde{H}=\tilde{h}+\dfrac{\tilde{\bv{u}}\cdot \tilde{\bv{u}}}{2},
 \end{split}
\end{equation}
with $\tilde{e}$ and $\tilde{h}$ defined in Equation (\ref{eq:closure}). The averaged absolute viscosity $\bmu$ is assumed to be constant (see Table \ref{tbl:source_parameters}).

 The laminar mean heat-flux vector $\bar{\bv{q}}=(\bar{q}_x,\bar{q}_y)$ is given by:
%
\begin{equation}\label{eq:closure02}
 \bar{q}_x = \left(\dfrac{\bar{\mu}}{\Pr}+\dfrac{\mu_t}{\Pr_t}\right)\diff{\tilde{h}}{x}\quad \mbox{and} \quad \bar{q}_y = \left(\dfrac{\bar{\mu}}{\Pr}+\dfrac{\mu_t}{\Pr_t}\right)\diff{\tilde{h}}{y},
 \end{equation}
where the Prandtl number, $\Pr$, and the turbulent Prandtl number, $\Pr_t$, are also assumed to be constant (Table \ref{tbl:source_parameters}).

Additionally, $\Omega$ and $\tilde{\bv{S}}$ in expression (\ref{eq:closure}) are:
\begin{gather*}
\label{eq:closure03}
 \Omega = \sqrt{\left( \diff{\tilde{u}}{y} - \diff{\tilde{v}}{x}\right)^2} \quad \mbox{and}\quad 
\tilde{\bv{S}}=\left[
\begin{array}{cc}
\tS_{xx} & \tS_{xy}\\
\tS_{yx} & \tS_{yy}
\end{array}\right] , 
\end{gather*}
with
\begin{equation*}
\tS_{xx}= \diff{\tilde{u}}{x}-\dfrac{1}{3} \nabla \cdot \tilde{\bv{u}},\quad \tS_{yy}= \diff{\tilde{v}}{y}-\dfrac{1}{3} \nabla \cdot \tilde{\bv{u}}, \quad \tS_{xy}= \tS_{yx}= \left( \diff{\tilde{u}}{y} + \diff{\tilde{v}}{x}\right).\\
\end{equation*}

% and  variable $\tilde{\bv{S}} $ ($\tS_{ij}$ in Equation. \ref{eq:closure05}) is the instantaneous viscous stress tensor:
% \begin{equation}\label{eq:closure06}
% \tS_{xx}= \diff{\tilde{u}}{x}-\dfrac{1}{3} \nabla \cdot \tilde{\bv{u}},\quad
% \tS_{yy}= \diff{\tilde{v}}{y}-\dfrac{1}{3} \nabla \cdot \tilde{\bv{u}}, \quad
% \tS_{xy}= \tS_{yx}= \left( \diff{\tilde{u}}{y} + \diff{\tilde{v}}{x}\right),
% \end{equation}



Source terms $Q_{\brho}$, $Q_{\tu}$, $Q_{\tv}$, $Q_{\tE}$ and $Q_{\sa}$ are presented in the subsequent sessions with the use of the auxiliary variables:
\begin{equation}
\label{eq:aux_2d}
\begin{split}
\U &= \frac{u_{\infty}}{A} \sin \left( \frac{A}{u_{\infty}} u_{eq} \right),\\
\V &= \dfrac{1}{14} \dfrac{\eta_v \,u_{\tau} \,y}{x},\\
\T &= T_{\infty} \,  \left[ 1 + r_T \, \frac{\gamma - 1}{2} M_{\infty}^2 \, \left( 1 - \left(\frac{u}{u_{\infty}}\right)^2 \right) \right],\\
\Rho &= \frac{p_0}{R T},\\
\Nu &= \kappa \,  u_{\tau} y - \alpha y^2,
\end{split}
\end{equation}
which simply are the manufactured solutions, and the derivatives: 

\begin{equation}\label{eq:aux_2d_02}
\begin{split}
 %\dfrac{d u_{eq}^+}{d y^+} &= \dfrac{1}{1 + \kappa \,   y^{+}} + C_1  \left( \dfrac{\exp(-y^{+}/\eta_1)}{\eta_1} - \dfrac{\exp(- b\,y^{+} \, )}{\eta_1} + \dfrac{ b  \, y^{+} \,  \exp(- b\, y^{+} \, )}{\eta_1}\right),\\
%
\diff{^2u_{eq}}{x^2}  &= -\dfrac{1}{196} \dfrac{ u_{\tau}\,  (y^{+})^2}{\eta_1 \, x^2} \Dueqplusyplus+\dfrac{1}{196} \dfrac{ u_{\tau}}{x^2}\left[17 y^{+} \,  \Dueqplusyplus+15 u_{eq}^{+} \right] +\\
  &-\dfrac{1}{196 x^2} \left( \dfrac{(b^2 \eta_1 \, y^{+} \, -2 b \eta_1 \,-b y^{+} \, +1) C_1 \,  u_{\tau} \,  (y^{+})^2 \,  \exp(-b y^{+} \, )}{\eta_1^2} +\dfrac{(  \kappa \,\eta_1 -\kappa \,  y^{+} \, -1) u_{\tau} \,  (y^{+})^2 }{(\kappa \,  y^{+} \, +1)^2 \eta_1 } \right),\\
%
\diff{^2u_{eq}}{y^2}&=\dfrac{ -u_{\tau} \,  (y^{+})^2 }{\eta_1 \, y^2}  \Dueqplusyplus -\dfrac{1}{y^2} \left( \dfrac{(b^2 \eta_1 \, y^{+} \, -2 b \eta_1 \,-b y^{+} \, +1) C_1 \,  u_{\tau} \,  (y^{+})^2 \,  \exp(-b y^{+} \, )}{\eta_1^2} +\dfrac{(  \kappa \,\eta_1 -\kappa \,  y^{+} \, -1) u_{\tau} \,  (y^{+})^2 }{(\kappa \,  y^{+} \, +1)^2 \eta_1 }\right ), \\
%
%
%%
%\diff{^2u_{eq}}{x^2} &= -\dfrac{1}{196} \dfrac{ u_{\tau} \,  (y^{+})^2 \,  }{\eta_1 x^2}\Dueqplusyplus - \dfrac{1}{196} \dfrac{C_1 u_{\tau}(y^{+})^2 \,  (b^2 \, \eta_1 \,  y^{+}-b \,  y^{+}+1-2 b \, \eta_1)  \exp(-b \,  y^{+})}{\eta_1^2 x^2}+\\
%  &+\dfrac{1}{196} \dfrac{ u_{\tau}(y^{+})^2 \,  (\kappa \,  y^{+}+\kappa \,  \eta_1+1)}{\eta_1 (\kappa \,  y^{+}+1)^2 x^2}+\dfrac{17}{196}\dfrac{ y^{+} \, u_{\tau} }{x^2}\Dueqplusyplus+\dfrac{15}{196} \dfrac{u_{\tau} u_{eq}^{+}}{x^2}, \\  
%
%\diff{^2u_{eq}}{y^2} &= -\dfrac{ u_{\tau} \,  (y^{+})^2 \,  }{\eta_1 y^2 } \Dueqplusyplus+ u_{\tau} \,  (y^{+})^2 \,   \left(-\dfrac{ C_1(b^2 \, \eta_1 \,  y^{+} \, -b \,  y^{+} \, +1-2 b \, \eta_1) \exp(-b \,  y^{+} \, ) }{\eta_1^2 y^2 }+\dfrac{\kappa \,  y^{+} \, -\kappa \,  \eta_1+1}{\eta_1 (\kappa \,  y^{+}+1)^2 y^2}\right), \\  
%
\diff{^2\U}{x^2}&\stackrel{\text{def}}{=} \diff{^2 u}{x^2}= -\dfrac{1}{196} \dfrac{A^2 u_{\tau}^2 \, \U }{u_{\infty}^2 x^2}\left[y^{+} \, \Dueqplusyplus + u_{eq}^{+}\right]^2+\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \diff{^2u_{eq}}{x^2}, \\ 
%
\diff{^2\U}{y^2} &\stackrel{\text{def}}{=} \diff{^2 u}{y^2}= -\dfrac{ A^2  u_{\tau}^2 \, (y^{+})^2 \,  \U}{u_{\infty}^2 y^2}\left(\Dueqplusyplus\right)^2 + \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\diff{^2u_{eq}}{y^2} , \\  
%
%older 
%\diff{^2u}{xy} &= \dfrac{1}{14}  \dfrac{ u_{\tau}(y^{+})^2 \,  (-1- \kappa   y^{+}+kappa  \, \eta_1)}{(1+kappa  y^{+})^2 \eta_1 xy} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) -\dfrac{1}{14}  \dfrac{ u_{\tau} y^{+}(-y^{+}+2 \eta_1) }{\eta_1 xy}\Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
%  &+\dfrac{1}{14} \dfrac{  y^{+} \, u_{\tau}^2 \, A^2 \U }{u_{\infty}^2 x y} \Dueqplusyplus\left[y^{+} \, \Dueqplusyplus +u_{eq}^{+}\right]+\dfrac{1}{14}  \dfrac{u_{\tau} \,  (y^{+})^2 \,  C_1 \exp({-y^{+} \, b}) (y^{+} \, b^2 \, \eta_1 \, -y^{+} \, b-2 \eta_1 b+1)  }{ \eta_1^2 xy}	  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right), \\
%
\diff{^2\U}{xy} &\stackrel{\text{def}}{=} \diff{^2 u}{xy} = \dfrac{1}{14} \dfrac{ A^2 u_{\tau}^2 \, y^{+} \, \U}{u_{\infty}^2 x y}  \Dueqplusyplus\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+}\right]-\dfrac{1}{7}  \dfrac{u_{\tau} y^{+}}{x y} \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) -\dfrac{1}{14} \dfrac{ y}{x} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)  \diff{^2u_{eq}}{y^2}, \\
%
\diff{^2\V}{x^2} &\stackrel{\text{def}}{=}\diff{^2 v}{x^2}= \dfrac{435}{196} \dfrac{\V}{x^2} ,\\
%
\diff{^2\V}{y^2} &\stackrel{\text{def}}{=}\diff{^2 v}{y^2}= 0, \\  
%
\diff{^2\V}{xy} &\stackrel{\text{def}}{=}\diff{^2 v}{xy}= -\dfrac{15}{14} \dfrac{\V}{xy},\\  
%
\diff{^2\T}{x^2} &\stackrel{\text{def}}{=}\diff{^2 T}{x^2}= -\dfrac{1}{196} \dfrac{ r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,  u_{\tau}^2}{u_{\infty}^2 x^2}\left[y^{+} \, \Dueqplusyplus + u_{eq}^{+}\right]^2  \left[\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2-\sin\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2\right]+\\
  &- \dfrac{r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,  \U}{u_{\infty}^2}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \diff{^2u_{eq}}{x^2} , \\
%%
\diff{^2\T}{y^2} &\stackrel{\text{def}}{=}\diff{^2 T}{y^2}= - \dfrac{r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \, u_{\tau}^2(y^{+})^2 \,  }{u_{\infty}^2 y^2}\left(\Dueqplusyplus\right)^2  \left[\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2-\sin\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2\right]+\\
  &-\dfrac{ r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,  \U}{u_{\infty}^2}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \diff{^2u_{eq}}{y^2}.
%
\end{split}
\end{equation}

\subsubsection{2D FANS Mass Conservation}

The 2D steady  Favre-averaged mass conservation equation can be written as one single operator, representing the convective effects:
\begin{equation*}
  \Lo_{\brho_{\text{convection}}}=  \Diff{\brho \tu}{x}+\Diff{\brho \tv}{y}.
\end{equation*}

Analytically differentiating Equation (\ref{eq:manufactured_2d}) for $\brho$, $\tu$ and $\tv$ using operator $\Lo_{\brho_{\text{convection}}}$ defined above gives  the source term~$Q_{\brho}$:
$$Q_{\brho}= Q_{\brho_{\text{convection}}}$$
where,
 \begin{equation}
 \begin{split}
Q_{\brho_{\text{convection}}} &= -\dfrac{1}{14}\dfrac{ r_T \, \, (\gamma-1) \,  M_{\infty}^2 \, \, T_{\infty} \,  \, u_{\tau}\Rho \U^2 }{\, u_{\infty}^2 \, x \T}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+}\right] +\\
%
&+\dfrac{r_T \, \, (\gamma-1) \, M_{\infty}^2 \, \, T_{\infty} \,  \,  y^{+} \, \, u_{\tau} \, \Rho \U \V }{\, u_{\infty}^2 \, y \T} \Dueqplusyplus\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
%
&-\dfrac{1}{14} \dfrac{u_{\tau} \Rho }{x}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+}\right] +\\
&+\dfrac{\Rho \V}{y},
 \end{split}
\end{equation}
with $\Rho,\,\U,\,\V$ and $\T$ given in Equation (\ref{eq:aux_2d}), and $\displaystyle\Dueqplusyplus$ defined in Equation (\ref{dueqplus}). 



\subsubsection{2D FANS Momentum Conservation}

For the generation of the analytical source term $Q_{\tu}$ for the Favre-averaged $x$-momentum equation, the first component of Equation~(\ref{eq:ns02}) is written as an  operator $\Lo_{\tu}$:
\begin{equation*}
 \Lo_{\tu}= \Lo_{\tu_\text{convection}} + \Lo_{\tu_\text{gradp}}+\Lo_{\tu_\text{viscous}}
\end{equation*}
where
\begin{equation}
\begin{split}\label{eq:u_operators}
\Lo_{\tu_\text{convection}}&=  \Diff{\brho \tu^2 }{x}+\Diff{\brho \tu\tv}{y} \\
\Lo_{\tu_\text{gradp}}&= \Diff{\bp}{x}\\
\Lo_{\tu_\text{viscous}}&=-\Diff{2(\bmu+\mu_t)\tS_{xx}}{x}-\Diff{2(\bmu+\mu_t)\tS_{xy}}{y}
\end{split}
\end{equation}

The operators defined in Eq. (\ref{eq:u_operators}) are applied into Equation (\ref{eq:manufactured_2d}), providing respective source terms that will compound source term $Q_{\tu}$:
\begin{equation*}
Q_{\tu}	=Q_{\tu_\text{convection}} + Q_{\tu_\text{gradp}}+Q_{\tu_\text{viscous}}
\end{equation*}

They are:
\begin{equation}
 \begin{split}
Q_{\tu_\text{convection}}&= -\dfrac{1}{14} \dfrac{r_T \, (\gamma-1)  M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \Rho \U^3}{u_{\infty}^2 x \T} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]+\\
%
&+\dfrac{r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,   u_{\tau} \,  y^{+} \,\Rho \U^2 \V}{u_{\infty}^2 y \T} \Dueqplusyplus  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
%
&+\dfrac{ u_{\tau} \,  y^{+} \, \Rho \V }{y} \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)-\dfrac{1}{7} \dfrac{u_{\tau} \Rho \U}{x}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]  +\dfrac{\Rho \U \V}{y} ,\\ 
%%
&\\
%%
Q_{\tu_\text{gradp}} &= 0 , \\
%
&\\
%%
Q_{\tu_\text{viscous}} &=-\dfrac{1}{147} \dfrac{r_T(\gamma-1) \,  \mu_t  \, M_{\infty}^2 \, T_{\infty} \,  u_{\tau}^2 \, \U \, (4 \Nu \Rho-3 \mu_t) \, }{u_{\infty}^2 x^2 \Nu \Rho \T} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2 \left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]^2+\\
%
&-\dfrac{r_T \, (\gamma-1) \,  \mu_t \, M_{\infty}^2 \, T_{\infty} \,  (y^{+})^2 \,  u_{\tau}^2 \, \U \, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^2 y^2 \Nu \Rho \T} \left(\Dueqplusyplus\right)^2  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2+\\
%
&+\dfrac{1}{42} \dfrac{  r_T(\gamma-1) \,  \mu_t  \, M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \U \V \, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^2 x y \Nu \Rho \T} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[43 y^{+} \, \Dueqplusyplus-2 u_{eq}^{+}\right]+\\
%
&-(2 \mu + 2 \mu_t) \left(\dfrac{2}{3} \diff{^2 \U}{x^2}+\dfrac{1}{2}  \diff{^2 \U}{y^2} +\dfrac{1}{6} \diff{^2 \V}{xy}\right)
 \end{split}
\end{equation}
where  $\Nu,\, \Rho,\,\U,\,\V$ and $\T$ are given in Equation (\ref{eq:aux_2d}). The derivatives are given in Equations (\ref{dueqplus}) and (\ref{eq:aux_2d_02}), and
\begin{equation}\label{eq:mu_t}
  \mu_t= f_{v1} \Rho \Nu,\quad f_{v1} = \dfrac{\chi^3}{\chi^3+c_{v1}^3}\quad \mbox{and}\quad \chi =\dfrac{\Nu}{\tilde{\nu}} =\dfrac{\Rho \Nu}{\bmu},
\end{equation}
which is consistent with the definition in Equation (\ref{eq:closure}).



Analogously, for the generation of the analytical source term $Q_{\tv}$ for the Favre-averaged $y$-momentum equation, the second component of Equation  (\ref{eq:ns02})  is written as an  operator $\Lo_{\tv}$:
\begin{equation*}
 \Lo_{\tv}= \Lo_{\tv_\text{convection}} + \Lo_{\tv_\text{gradp}}+\Lo_{\tv_\text{viscous}}
\end{equation*}
where
\begin{equation}
\begin{split}\label{eq:v_operators}
\Lo_{\tv_\text{convection}}&=  \Diff{\brho \tu\tv}{x}+\Diff{\brho \tv^2}{y} \\
\Lo_{\tv_\text{gradp}}&= \Diff{\bp}{y} \\
\Lo_{\tv_\text{viscous}}&=-\Diff{2(\bmu+\mu_t)\tS_{yx}}{x}-\Diff{2(\bmu+\mu_t)\tS_{yy}}{y}\\
\end{split}
\end{equation}
and then applied to Equation  (\ref{eq:manufactured_2d}). Accordingly, the resulting source term $Q_{\tv}$ is given by:
\begin{equation*}
Q_{\tv}	=Q_{\tv_\text{convection}} + Q_{\tv_\text{gradp}}+Q_{\tv_\text{viscous}}
\end{equation*}
with: 
\begin{equation}
 \begin{split}
Q_{\tv_\text{convection}} &= -\dfrac{1}{14} \dfrac{r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \Rho \U^2 \V}{u_{\infty}^2 x \T}  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]+\\
  &+ \dfrac{r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,   u_{\tau} \, y^{+} \, \Rho \U \V^2 }{u_{\infty}^2 y \T}\Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &-\dfrac{1}{14} \dfrac{ u_{\tau} \Rho \V}{x}  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]+\\
  &-\dfrac{15}{14} \dfrac{\Rho \U \V}{x}+ \dfrac{2 \Rho \V^2}{y} ,\\
%
&\\
% 
 Q_{\tv_\text{gradp}} &= 0,\\
%
&\\
%
Q_{\tv_\text{viscous}} &= \dfrac{1}{42}  \dfrac{ r_T  (\gamma-1)\mu_t \, M_{\infty}^2 \, T_{\infty} \, u_{\tau}^2 \, y^{+} \, \U (4 \Nu \Rho-3 \mu_t )}{u_{\infty}^2 \, x y \Nu \Rho  \T} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2 \Dueqplusyplus\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+}\right]+\\
 &-\dfrac{4}{3}  \dfrac{r_T (\gamma-1)\mu_t \, M_{\infty}^2 \, T_{\infty} \, u_{\tau} \, y^{+} \, \U \V (4 \Nu \Rho-3 \mu_t ) }{u_{\infty}^2 \, y^2 \Nu \Rho  \T} \Dueqplusyplus\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) +\\
 &-\dfrac{15}{196}  \dfrac{ r_T (\gamma-1)\mu_t \, M_{\infty}^2 \, T_{\infty} \, u_{\tau} \, \U \V (4 \Nu \Rho-3 \mu_t \, )}{u_{\infty}^2 \, x^2 \Nu \Rho  \T} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+}\right]+\\
 &-(2 \mu + 2 \mu_t) \left(\dfrac{1}{6} \diff{^2 \U}{xy}+\dfrac{1}{2}  \diff{^2 \V}{x^2}+\dfrac{2}{3} \diff{^2 \V}{y^2}\right) ,
 \end{split}	
\end{equation}
%
where $\Nu,\, \Rho,\,\U,\,\V$ and $\T$ are given in Equation (\ref{eq:aux_2d}), the derivatives are given in Equations (\ref{dueqplus}) and (\ref{eq:aux_2d_02}), and $\mu_t$ is given in Equation (\ref{eq:mu_t}).



\subsubsection{2D FANS Total Energy Conservation}

The operator for the 2D  Favre-averaged total energy is:

\begin{equation*}
 \Lo_{\tE}= \Lo_{\tE_\text{convection}} + \Lo_{\tE_\text{heat flux}}+\Lo_{\tE_\text{work}}
\end{equation*}
where
\begin{equation}
\begin{split}\label{eq:E_operators}
\Lo_{\tE_\text{convection}}&= \Diff{\brho \tu \left(\hh+ \frac{\tu^2}{2} +\frac{\tv^2 }{2} \right) }{x}+\Diff{\brho \tv \left(\hh+ \frac{\tu^2}{2} +\frac{\tv^2 }{2}  \right)}{y}\\
\Lo_{\tE_\text{heat flux}}&=- \Diff{\bq_x}{x} -\Diff{\bq_y}{y}\\ %= -\Diff{\left(\frac{\mu}{\Pr}+\frac{\mu_t}{\Pr_t}\right) \diff{\hh}{x} }{x} - \Diff{\left(\frac{\mu}{\Pr}+\frac{\mu_t}{\Pr_t}\right) \diff{\hh}{y} }{y}   \\
\Lo_{\tE_\text{work}}&=-\Diff{2(\bmu+\mu_t)\tu \tS_{xx}}{x}-\Diff{2(\bmu+\mu_t)\tv \tS_{xy}}{x}-\Diff{2(\bmu+\mu_t) \tu \tS_{yx}}{y}-\Diff{2(\bmu+\mu_t)\tv \tS_{yy}}{y}
\end{split}
\end{equation}

Source term $Q_{\tE}=Q_{\tE_\text{convection}} + Q_{\tE_\text{heat flux}}+ Q_{\tE_\text{work}}$ is obtained by operating $ \Lo_{\tE_\text{convection, heat flux, work}}$ on Equation~(\ref{eq:manufactured_2d}) together with the use of the  auxiliary relations for energy given in Equations (\ref{eq:closure}), (\ref{eq:closure01}) and (\ref{eq:closure02}). It yields:

\begin{equation*}
 \begin{split}
Q_{\tE_\text{convection}} &= -\dfrac{1}{28} \dfrac{  r_T \, (\gamma-1)  M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \Rho \U^2 (\U^2+\V^2)}{u_{\infty}^2 x \T}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right] +\\
  &+\dfrac{1}{2} \dfrac{ r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \, y^{+} \,  \Rho \U \V (\U^2+\V^2)}{u_{\infty}^2 y \T}\Dueqplusyplus  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &+ \dfrac{u_{\tau} \, y^{+} \, \Rho \U \V }{y}\Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &-\dfrac{1}{28} \dfrac{u_{\tau} \Rho (3 \U^2+\V^2+2 c_p  \T)}{x}   \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right] +\\
  &-\dfrac{15}{14} \dfrac{\Rho \U \V^2}{x}+\dfrac{1}{2}  \dfrac{ \Rho \V(\U^2+3 \V^2+2 c_p  \T)}{y},\\
%
&\\
%
Q_{\tE_\text{heat flux}} &= \dfrac{ c_p \,  r_T^2 (\gamma-1)^2\mu_t \, M_{\infty}^4 \,  T_{\infty}^2  \,   u_{\tau}^2 \, (y^{+})^2 \,  \U^2 \, (4 \Nu \Rho-3 \mu_t) \, }{u_{\infty}^4 \Pr_t \, y^2 \Nu \Rho \T}\left(\Dueqplusyplus\right)^2 \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2+\\
  &+\dfrac{1}{196} \dfrac{c_p \,  r_T^2  (\gamma-1)^2  \mu_t \, M_{\infty}^4 \,  T_{\infty}^2  \,  u_{\tau}^2 \, \U^2\, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^4 \Pr_t \, x^2 \Nu \Rho \T}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]^2+\\
  &+\dfrac{1}{196}\dfrac{c_p \,  r_T \, (\gamma-1) \, (4 \Nu \Rho-3 \mu_t) \, \,  \mu_t \, \kappa \,  M_{\infty}^2 \, T_{\infty} \,  u_{\tau}^2 \, \, y \U}{u_{\infty}^2 \Pr_t \, x^2 \Nu^2 \Rho} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]  +\\
  &-\dfrac{c_p \,  r_T(\gamma-1) \,  \mu_t  \, M_{\infty}^2 \, T_{\infty} \,   u_{\tau} \, y^{+} \, (- \kappa \,  u_{\tau}+2 \alpha y) \U \, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^2 \Pr_t \, y \Nu^2 \Rho}\Dueqplusyplus  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\\
  &-c_p \left(\dfrac{\mu}{\Pr}+\dfrac{\mu_t}{\Pr_t}\right)\left(\diff{^2 \T}{x^2}+\diff{^2 \T}{y^2}\right),\\ 
%
 \end{split}
\end{equation*}
\begin{equation*}
 \begin{split}
%
Q_{\tE_\text{work}}&=\dfrac{ r_T(\gamma-1) \,  \mu_t \, M_{\infty}^2 \, T_{\infty} \,  u_{\tau}^2 \, (y^{+})^2 \,  \U^2 \, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^2 y^2 \Nu \Rho \T}    \left(\Dueqplusyplus\right)^2  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2+\\
  &-\dfrac{1}{42} \dfrac{ r_T(\gamma-1) \,  \mu_t  \, M_{\infty}^2 \, T_{\infty} \,   y^{+} \, \U \V \, (4 \Nu \Rho-3 \mu_t) \, }{u_{\infty}^2 x y \Nu \Rho \T}  \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2 \left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]+\\&
  +\dfrac{4}{3}\dfrac{ r_T \, (\gamma-1) \,  \mu_t \, M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \, y^{+} \, \U \V^2 \, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^2 y^2 \Nu \Rho \T}  \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &+\dfrac{1}{147} \dfrac{r_T \,  (\gamma-1) \,  \mu_t  \, M_{\infty}^2 \, T_{\infty} \,  u_{\tau}^2 \, \U^2 \, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^2 x^2 \Nu \Rho \T} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]^2+\\
  &-\dfrac{1}{42} \dfrac{ r_T \,  (\gamma-1)\mu_t \, M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \U^2 \V\, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^2 x y \Nu \Rho \T} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[43 y^{+} \, \Dueqplusyplus-2 u_{eq}^{+}\right]  /()+\\
  &+\dfrac{15}{196} \dfrac{r_T \, (\gamma-1)\mu_t \, M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \U \V^2 \, (4 \Nu \Rho-3 \mu_t) \,}{u_{\infty}^2 x^2 \Nu \Rho \T}  \left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right] \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &+\dfrac{\mu_t \, \kappa \,   u_{\tau}^2 \, y^{+} \, \, \U \,\, (4 \Nu \Rho-3 \mu_t) \,}{y \Nu^2 \Rho} \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &-\dfrac{2  \alpha \mu_t \,  u_{\tau} \,  y^{+} \, \U \, (4 \Nu \Rho-3 \mu_t) \,}{\Nu^2 \Rho} \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &-\dfrac{1}{42} \dfrac{\mu_t \, \kappa \,  u_{\tau}^2 \, \V \, (4 \Nu \Rho-3 \mu_t) \,}{x \Nu^2 \Rho} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus-2 u_{eq}^{+}\right] +\\
  &+\dfrac{1}{147} \dfrac{   \mu_t \, \kappa \,  u_{\tau}^2 \, y \U \, (4 \Nu \Rho-3 \mu_t) \,}{x^2 \Nu^2 \Rho}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]+\\
  &-\dfrac{2}{21} \dfrac{ \alpha \mu_t \, u_{\tau} y \V \, (4 \Nu \Rho-3 \mu_t) \,}{x \Nu^2 \Rho} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]+\\
  &-\dfrac{8}{3} \dfrac{ \alpha \mu_t \, \V^2\, (4 \Nu \Rho-3 \mu_t) \,}{\Nu^2 \Rho}+\\
  &+\dfrac{1}{588} \dfrac{  \mu_t \, \kappa \,  u_{\tau}  (784 x^2+45 y^2)\V^2\, (4 \Nu \Rho-3 \mu_t) \,}{x^2 y \Nu^2 \Rho}+\\
  &+\dfrac{1}{42}  \dfrac{ \mu_t(-43 \kappa \,  u_{\tau}+90 \alpha y) \U \V  \, (4 \Nu \Rho-3 \mu_t) \,}{x \Nu^2 \Rho}+\\
 % 
%
&- (2 \mu+2 \mu_t) \left\{\dfrac{1}{2}  \dfrac{u_{\tau}^2 \, (y^{+})^2 \,  }{y^2} \left(\Dueqplusyplus\right)^2 \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2\,\, +\,\,\dfrac{1}{294}\dfrac{u_{\tau}^2 \, }{x^2} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)^2\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]^2  +\right.\\
  &\qquad-\dfrac{1}{42}\dfrac{ u_{\tau} \V}{x y} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \left[43 y^{+} \, \Dueqplusyplus-2 u_{eq}^{+}\right]\,\, +\,\,\dfrac{225}{392} \dfrac{\V^2}{x^2}\,\,+\,\, \dfrac{2}{3} \dfrac{\V^2}{y^2} +\\
  &\qquad\left.+ \U \left(\dfrac{2}{3} \diff{^2 \U}{x^2}+\dfrac{1}{2}  \diff{^2 \U}{y^2}+\dfrac{1}{6} \diff{^2 \V}{xy}\right) \,\, + \,\, \V \left(\dfrac{1}{6} \diff{^2 \U}{xy}+\dfrac{1}{2}  \diff{^2 \V}{x^2}+\dfrac{2}{3} \diff{^2 \V}{y^2}\right) \right\}
 \end{split}
\end{equation*}
%
where  $\Nu,\,\Rho,\,\U,\,\V$ and $\T$ are given in Equation (\ref{eq:aux_2d}), the derivatives are given in Equations (\ref{dueqplus}) and (\ref{eq:aux_2d_02}), and $\mu_t$ and $f_{v1}$ are given in  Equation (\ref{eq:mu_t}).



\subsubsection{2D SA Transport Equation}

The operator for the viscosity-like baseline compressible Spalart--Allmaras equation is:
 $$\Lo_{\sa }=\Lo_{\sa \text{convection}} +  \Lo_{\sa \text{production}} +  \Lo_{\sa \text{dissipation}}+  \Lo_{\sa \text{diffusion}}  +  \Lo_{\sa \text{grad square}}$$
with each one of the sub-operators defined as follows:

\begin{equation}
 \begin{split}
  \Lo_{\sa \text{convection}} &= \Diff{\brho \, \tu \, \sa}{x} +  \Diff{\brho \, \tv \, \sa}{x},\\
  \Lo_{\sa \text{production}} &=- c_{b1} S_\tsa \, \bar{\rho} \, \sa ,\\
  \Lo_{\sa \text{dissipation}}&=c_{w1} \, f_w \, \brho \, \left(\dfrac{\sa}{d}\right)^2 ,\\
  \Lo_{\sa \text{diffusion}}  &=- \dfrac{1}{\sigma_{\tsa}}\left[\diff{}{x}\left((\mu+\brho \sa) \diff{\sa}{x}\right)+ \diff{}{y}\left((\mu+\brho \sa) \diff{\sa}{y}\right)  \right], \\%    - \dfrac{1}{\sigma_{\tsa}}\nabla \cdot \left( (\bmu+\bar{\rho}  \sa) \nabla \sa\right), \\
  \Lo_{\sa \text{grad square}} &= -\dfrac{c_{b2} \bar{\rho} }{\sigma_{\tsa}}\left[ \left(\diff{\sa}{x}\right)^2 +  \left(\diff{\sa}{y}\right)^2\right]. %-\dfrac{c_{b2} \bar{\rho} }{\sigma_{\tsa}} \nabla \sa \cdot \nabla \sa.
 \end{split}
\end{equation}

Note that both $\Lo_{\sa \text{production}}$ and $\Lo_{\sa \text{dissipation}}$ are piecewise defined since they depend on $ S_{\mathrm{sa}} = \Omega + S_m$ and 
\begin{equation*}
S_m = \left\{ \begin{array}{cc}
S_{m, orig}, & S_{m,orig} \geq -c_{v2} \Omega \vspace{5pt}\\ 
\dfrac{\Omega (c_{v2}^2 \Omega + c_{v3} S_{m,orig})}{ (c_{v3}-2.0c_{v2}) \Omega - S_{m,orig}}, & \quad \mathrm{otherwise}.
\end{array}
\right.
\end{equation*}

Source term $Q_{\sa}$ is obtained by operating $\Lo_{\sa }$ on Equation  (\ref{eq:manufactured_2d}) together with the use of the  auxiliary relations given in Equation (\ref{eq:closure}). It yields:
\begin{equation}
 \begin{split}
Q_{\sa \text{convection}} &= \dfrac{r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,   u_{\tau}\, y^{+} \, \Nu \Rho \U \V}{u_{\infty}^2 y \T}\Dueqplusyplus  \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &-\dfrac{1}{14} \dfrac{r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,  u_{\tau} \Nu \Rho \U^2 }{u_{\infty}^2 x \T}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right] +\\
  &-\dfrac{1}{14}\dfrac{ u_{\tau} \Nu \Rho }{x}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right] +\\
  &+\dfrac{\Nu \Rho \V}{y} \,\, - \,\, \dfrac{1}{14} \dfrac{\kappa \, u_{\tau} \, y  \Rho \U}{x}\,\, +\,\, (-2 \alpha y+ \kappa \, u_{\tau}) \Rho \V , \\
%
&\\
%
Q_{\sa \text{production}} &= -c_{b1} (\Omega+S_m) \Rho \Nu , \\
%
&\\
%
Q_{\sa \text{diffusion}} &=\dfrac{ r_T \, (\gamma-1) M_{\infty}^2 \, T_{\infty} \,   u_{\tau} \,  y^{+} \,(2 \alpha y- \kappa   u_{\tau}) \Nu \Rho \U }{u_{\infty}^2 \sigma_{\tsa} y \T} \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+\\
  &-\dfrac{1}{196} \dfrac{ r_T \, (\gamma-1) \, \kappa \,   M_{\infty}^2 \, T_{\infty} \,  u_{\tau}^2 \, y \Nu \Rho \U}{u_{\infty}^2 \sigma_{\tsa} x^2 \T} \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\left[y^{+} \, \Dueqplusyplus+u_{eq}^{+} \right]+\\
  &-\dfrac{1}{196} \dfrac{ \kappa^2 u_{\tau}^2 \,  y^2 \Rho}{\sigma_{\tsa} x^2} \,\,- \,\, \dfrac{15}{196} \dfrac{ \kappa \, u_{\tau} \, y \, (\Nu \Rho+\mu)  }{\sigma_{\tsa} x^2}+\\
  &-\dfrac{(2 \alpha y- \kappa \,  u_{\tau})^2 \Rho}{\sigma_{\tsa}} \,\,+ \,\, \dfrac{2 \alpha (\Nu \Rho+\mu)}{\sigma_{\tsa}} , \\
%
&\\
%
Q_{\sa \text{grad square}} &= -\dfrac{1}{196} \dfrac{c_{b2} \, \kappa^2 \, u_{\tau}^2 \, y^2 \Rho}{\sigma_{\tsa} x^2}\,\,- \,\, \dfrac{c_{b2} (2 \alpha y- \kappa \,  u_{\tau})^2 \Rho}{\sigma_{\tsa}} , \\
%
&\\
%
Q_{\sa \text{dissipation}} &= \dfrac{c_{w1} f_w \Rho \Nu^2}{d^2}
%
\end{split}
\end{equation}
Therefore, 
\begin{equation}
Q_{\sa}= Q_{\sa \text{convection}} +Q_{\sa \text{production}}+Q_{\sa \text{diffusion}}+Q_{\sa \text{grad square}}+Q_{\sa \text{dissipation}}.\\
\end{equation}

\vspace{12pt}
Similarly to the previous cases, $\Nu,\, \Rho,\, \U,\,\V, \T$ and $\Nu$ are defined in (\ref{eq:aux_2d}), $f_{v1}$ is given in  Equation (\ref{eq:mu_t}), and
%
\begin{equation}
 \begin{split}
&\Omega = \dfrac{1}{196} \sqrt{\dfrac{u_{\tau}^2}{x^4 y^2} \left(196 x^2 \, y^{+} \, \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)+15 \eta_v \, y^2\right)^2 } \\
&f_{v2} = 1 - \frac{\chi}{1 + \chi f_{v1}}, \qquad f_w = g \left( \frac{1 + c_{w3}^6}{g^6 + c_{w3}^6} \right)^{1/6}, \quad \\
& g = r + c_{w2} \left( r^6 - r \right), \qquad r = \frac{\Nu}{S_{\mathrm{sa}}\, \kappa^2 \, d^2},\\
&S_{\mathrm{sa}} = \Omega + S_m ,\quad S_{m, orig} = \frac{\Nu \,f_{v2}}{\kappa^2 \, d^2} , \qquad d=y,
\end{split}
\end{equation}

\begin{equation*}
S_m = \left\{ \begin{array}{cc}
S_{m, orig}, & S_{m,orig} \geq -c_{v2} \Omega \vspace{5pt}\\ 
\dfrac{\Omega (c_{v2}^2 \Omega + c_{v3} S_{m,orig})}{ (c_{v3}-2.0c_{v2}) \Omega - S_{m,orig}}, & \quad \mathrm{otherwise}.
\end{array}
\right.
\end{equation*}
which, again, is consistent with Equation (\ref{eq:closure}). 

\section{Comments}
The complexity, and consequently length, of the source terms increase with both dimension and physics handled by the governing equations. 
Applying commands in order to simplify extensive expressions is challenging even with a high performance workstation; thus, a suitable alternative to this issue is to simplify each equation by dividing it into a combination of sub-operators handling different physical phenomena. Then, each one of the operators may be applied to the manufactured solutions individually, and the resulting sub-source terms are combined back to represent the source term for the original equation.


For instance, instead of writing the two-dimensional steady FANS-SA equation using one single operator~$\Lo$:
 \begin{equation} \label{eq:ns2d05}
\Lo=\nabla \cdot (\bar{\rho} \tilde{\bv{u}} \sa) - c_{b1} S_\tsa \bar{\rho} \sa +c_{w1} f_w \brho \left(\dfrac{\sa}{d}\right)^2 - \dfrac{1}{\sigma_{\tsa}}\nabla \cdot \left( (\bmu+\bar{\rho}  \sa) \nabla \sa\right) -\dfrac{c_{b2} \bar{\rho} }{\sigma_{\tsa}} \nabla \sa \cdot \nabla \sa
\end{equation}
to then be used in the MMS, let Equation (\ref{eq:ns2d05}) be written with five operators:
\begin{equation}
 \begin{split}\label{sub01}
  \Lo_{\sa \text{convection}} &=\nabla \cdot (\bar{\rho} \tilde{\bv{u}} \sa) ,\\
  \Lo_{\sa \text{production}} &=- c_{b1} S_\tsa \bar{\rho} \sa ,\\
  \Lo_{\sa \text{dissipation}}&=c_{w1} f_w \brho \left(\dfrac{\sa}{d}\right)^2 ,\\
  \Lo_{\sa \text{diffusion}}  &=- \dfrac{1}{\sigma_{\tsa}}\nabla \cdot \left( (\bmu+\bar{\rho}  \sa) \nabla \sa\right), \\
  \Lo_{\sa \text{grad square}} &= -\dfrac{c_{b2} \bar{\rho} }{\sigma_{\tsa}} \nabla \sa \cdot \nabla \sa.
 \end{split}
\end{equation}

Naturally, $\Lo_{\sa }=\Lo_{\sa \text{convection}} +  \Lo_{\sa \text{production}} +  \Lo_{\sa \text{dissipation}}+  \Lo_{\sa \text{diffusion}}  +  \Lo_{\sa \text{grad square}}$.


 After the application of each sub-operator defined in (\ref{sub01}), the corresponding sub-source terms are also simplified, factorized and sorted. Then, the final factorized version is checked against the original one, in order to assure that no human error has been introduced.

An advantage of this strategy is the possibility of inclusion and/or removal of other physical effects without the need of re-doing previous manipulations. For instance, in order to simplify this model, assuming that the distance $d$ to the nearest wall is infinite, changes should be made in only two operators:  $\Lo_{\sa \text{production}}$ is simplified since $S_\tsa$ is reduced to $S_\tsa=\Omega$, and $ \Lo_{\sa \text{dissipation}}=0$. The equations for conservation  of mass, momentum and total energy remain unchanged.


This strategy, named ``Hierarchic MMS'', results in less time spent in the manipulations, decreases the computational effort and occasional software crashes, and also increases the flexibility in the code verification procedure.



\subsection{Boundary Conditions and C Files}
Additionally to verifying code capability of solving the governing equations accurately in the interior of the domain of interest, one may also verify the software capability of correctly imposing boundary conditions. Therefore, the gradients of the  analytical solutions (\ref{eq:manufactured_2d}) have been calculated:


\begin{equation*}
\nabla  \rho= \left[ \begin{array}{c}
- \dfrac{1}{14}\dfrac{p_0}{R T^2} \dfrac{r_T\, (\gamma-1)\, M_{\infty}^2 \, \,T_{\infty} \, \, u_\tau \, }{u_{\infty}^2 x}\, u \,\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \left[y^{+} \, \displaystyle\Dueqplusyplus+u_{eq}^{+}\right]\vspace{5pt} \\
 \dfrac{p_0}{R T^2}  \dfrac{r_T\, (\gamma-1)\, M_{\infty}^2 \, \,T_{\infty} \, \,  u_\tau\, y^{+}}{u_{\infty}^2 y}\, u \,\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)   \displaystyle\Dueqplusyplus
\end{array} \right],
\end{equation*}
\begin{equation*}
\nabla T = \left[ \begin{array}{c}
 \dfrac{1}{14} \dfrac{r_T\, (\gamma-1)\, M_{\infty}^2 \, \,T_{\infty} \, \, u_\tau \, }{u_{\infty}^2 x}\, u \,\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \left[y^{+} \, \displaystyle\Dueqplusyplus+u_{eq}^{+}\right]\vspace{5pt}\\
- \dfrac{r_T\, (\gamma-1)\, M_{\infty}^2 \, \,T_{\infty} \, \,  u_\tau\,  y^{+} \, }{u_{\infty}^2 y}\, u \,\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)  \displaystyle\Dueqplusyplus
\end{array} \right],
\end{equation*}
\begin{equation*}
\nabla u = \left[ \begin{array}{c}
  -\dfrac{1}{14}\dfrac{u_\tau }{x}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \left[y^{+} \, \displaystyle\Dueqplusyplus+u_{eq}^{+}\right] \vspace{5pt}\\
 \dfrac{ u_\tau \, y^{+} }{y} \displaystyle\Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)
\end{array} \right],
%
\quad\quad
%
\nabla  v= \left[ \begin{array}{c}
 -\dfrac{15}{196}\dfrac{ \eta_v \, u_\tau \, y}{x^2} \vspace{5pt}\\
 \dfrac{1}{14}\dfrac{\eta_v \, u_\tau}{x}
\end{array} \right]
\end{equation*}
\begin{equation*}
\nabla \sa = \left[ \begin{array}{c}
 -\dfrac{1}{14}\dfrac{ \kappa \,  u_\tau \, y}{x} \vspace{5pt}\\
 \kappa \,  u_\tau - 2 \alpha y
\end{array} \right],
%
\quad\mbox{and}\quad
%
\nabla p = \left[ \begin{array}{c}
 0\vspace{5pt}\\
 0
\end{array} \right].
\end{equation*}
Note that $\nabla  \rho$ and $\nabla  T$ are written in terms of the manufactured solutions for $u$ and $T$. 

The translation of the manufactured solutions, their gradients and all the auxiliary relations into C code is presented in the file \texttt{FANS\_SA\_2d\_manuf\_solutions\_grad\_code.C}. Files containing $C$ codes for the source terms have also been automatically generated. They are: \texttt{FANS\_SA\_steady\_2d\_rho\_code.C, FANS\_SA\_steady\_2d\_u\_code.C, FANS\_SA\_steady\_2d\_v\_code.C, FANS\_SA\_steady\_2d\_E\_code.C} and \texttt{FANS\_SA\_steady\_2d\_nu\_code.C}.

%\newpage
An example of the $C$ file from the source term $Q_{\sa}$ for the 2D Spalart--Allmaras equation is:

\begin{footnotesize}
\begin{verbatim}// Source term for the working variable nu_sa, FANS-SA
double SourceQ_nu_sa ( double x, double y, double kappa, double _C, double eta1, double b, double r_T, double Gamma, 
  double M_inf, double C_cf, double eta_v, double T_inf, double p_0, double R, double mu, double alpha, double sigma_sa,
  double c_w2, double c_w3, double c_b1, double c_b2, double c_v1, double c_v2, double c_v3)
{
  double NU_SA; double RHO; double U; double V;  double T;
  double Re_x; double c_f; double u_tau; double y_plus; double u_eq_plus; double u_eq; double d_ueqplus_yplus;
  double chi; double mu_t; double f_v1; double f_v2; double C1; double u_inf; double rho_inf; double T_aw; double rho_w;
  double F_c;  double nu_w; double A; double c_w1; double Sm_orig; double Sm1; double Sm2; double Sm; double S_sa;
  double Omega; double f_w; double g; double r; double d; double Q_nu_sa; 
  double Q_nusa_convection; double Q_nusa_production; double Q_nusa_diffusion; double Q_nusa_gradsquare;
  double Q_nusa_dissipation;

    // "constants computed from parameters -------------"
  C1 = -0.1e1 / kappa * log(kappa) + _C;
  u_inf = M_inf * sqrt(Gamma * R * T_inf);
  rho_inf = p_0 / R / T_inf;
  T_aw = T_inf * (0.1e1 + r_T * (Gamma - 0.1e1) * M_inf * M_inf / 0.2e1);
  rho_w = p_0 / R / T_aw;
  A = sqrt(0.1e1 - T_inf / T_aw);
  F_c = (T_aw / T_inf - 0.1e1) * pow(asin(A), -0.2e1);
  nu_w = mu / rho_w;
  c_w1 = c_b1 * pow(kappa, -0.2e1) + (0.1e1 + c_b2) / sigma_sa;

    // "------------------------------------------------"
  Re_x = rho_inf * u_inf * x / mu;
  c_f = C_cf / F_c * pow(0.1e1 / F_c * Re_x, -0.1e1 / 0.7e1);
  u_tau = u_inf * sqrt(c_f / 0.2e1);
  y_plus = y * u_tau / nu_w;
  u_eq_plus = 0.1e1 / kappa * log(0.1e1 + kappa * y_plus) + C1 * (0.1e1 - exp(-y_plus / eta1) 
    - y_plus / eta1 * exp(-y_plus * b));
  u_eq = u_tau * u_eq_plus;
  d_ueqplus_yplus = 0.1e1 / (0.1e1 + kappa * y_plus) + C1 * (exp(-y_plus / eta1) / eta1 
    - exp(-y_plus * b) / eta1 + y_plus * b * exp(-y_plus * b) / eta1);
   
    // "a suitable approximation for d-----------------"
  d = y;

    // "-----------------------------------------------"
  U = u_inf / A * sin(A / u_inf * u_eq);
  V = eta_v * u_tau * y / x / 0.14e2;
  T = T_inf * (0.1e1 + r_T * (Gamma - 0.1e1) * M_inf * M_inf * (0.1e1 - U * U * pow(u_inf, -0.2e1)) / 0.2e1);
  RHO = p_0 / R / T;
  NU_SA = kappa * u_tau * y - alpha * y * y;
  chi = RHO * NU_SA / mu;
  f_v1 = pow(chi, 0.3e1) / (pow(chi, 0.3e1) + pow(c_v1, 0.3e1));
  mu_t = RHO * NU_SA * f_v1;
  f_v2 = 0.1e1 - chi / (0.1e1 + chi * f_v1);
  Omega = sqrt(pow(0.196e3 * x * x * y_plus * d_ueqplus_yplus * cos(A / u_inf * u_eq) 
    + 0.15e2 * eta_v * y * y, 0.2e1) * u_tau * u_tau * pow(x, -0.4e1) * pow(y, -0.2e1)) / 0.196e3;
  Sm_orig = NU_SA * pow(kappa, -0.2e1) * pow(d, -0.2e1) * f_v2;
  Sm1 = Sm_orig;
  Sm2 = Omega * (c_v2 * c_v2 * Omega + c_v3 * Sm_orig) / ((c_v3 + (-0.1e1) * 0.20e1 * c_v2) * Omega - Sm_orig);
  if (-c_v2 * Omega <= Sm_orig)
    Sm = Sm1;
  else
    Sm = Sm2;
  S_sa = Sm + Omega;
  r = NU_SA / S_sa * pow(kappa, -0.2e1) * pow(d, -0.2e1);
  g = r + c_w2 * (pow(r, 0.6e1) - r);
  f_w = g * pow((0.1e1 + pow(c_w3, 0.6e1)) / (pow(g, 0.6e1) + pow(c_w3, 0.6e1)), 0.1e1 / 0.6e1);

    // "Contribution from the convective terms to the total source term --------------------------------------------"
  Q_nusa_convection = r_T * (Gamma - 0.1e1) * d_ueqplus_yplus * M_inf * M_inf * T_inf * y_plus * u_tau * NU_SA * RHO 
      * U * V * cos(A / u_inf * u_eq) * pow(u_inf, -0.2e1) / y / T 
    - r_T * (Gamma - 0.1e1) * (d_ueqplus_yplus * y_plus + u_eq_plus) * M_inf * M_inf * T_inf * u_tau * NU_SA * RHO 
      * U * U * cos(A / u_inf * u_eq) * pow(u_inf, -0.2e1) / x / T / 0.14e2 
    - kappa * u_tau * y * RHO * U / x / 0.14e2 - (d_ueqplus_yplus * y_plus + u_eq_plus) * u_tau * NU_SA * RHO 
      * cos(A / u_inf * u_eq) / x / 0.14e2 + RHO * NU_SA * V / y + (-0.2e1 * alpha * y + kappa * u_tau) * RHO * V;

    // "Contribution from theproduction  to the total source term --------------------------------------------------"
  Q_nusa_production = -c_b1 * (Sm + Omega) * RHO * NU_SA;

    // "Contribution  from the diffusion to the total source term --------------------------------------------------"
  Q_nusa_diffusion = (0.2e1 * alpha * y - kappa * u_tau) * r_T * (Gamma - 0.1e1) * M_inf * M_inf * T_inf * y_plus 
      * u_tau * d_ueqplus_yplus * NU_SA * RHO * U * cos(A / u_inf * u_eq) * pow(u_inf, -0.2e1) / sigma_sa / y / T 
    - r_T * (Gamma - 0.1e1) * (d_ueqplus_yplus * y_plus + u_eq_plus) * kappa * y * M_inf * M_inf * T_inf * u_tau 
      * u_tau * NU_SA * RHO * U * cos(A / u_inf * u_eq) * pow(u_inf, -0.2e1) / sigma_sa * pow(x, -0.2e1) / T / 0.196e3 
    - kappa * kappa * y * y * u_tau * u_tau * RHO / sigma_sa * pow(x, -0.2e1) / 0.196e3 
    - pow(0.2e1 * alpha * y - kappa * u_tau, 0.2e1) * RHO / sigma_sa 
    - 0.15e2 / 0.196e3 * kappa * (RHO * NU_SA + mu) * y * u_tau / sigma_sa * pow(x, -0.2e1) 
    + 0.2e1 * alpha * (RHO * NU_SA + mu) / sigma_sa;

    // "Contribution  from the grad squared  to the total source term ----------------------------------------------"
  Q_nusa_gradsquare = -c_b2 * kappa * kappa * y * y * u_tau * u_tau * RHO / sigma_sa * pow(x, -0.2e1) / 0.196e3 
    - c_b2 * pow(0.2e1 * alpha * y - kappa * u_tau, 0.2e1) * RHO / sigma_sa;

    // "Contribution  from the dissipation to the total source term ------------------------------------------------"
  Q_nusa_dissipation = c_w1 * f_w * RHO * NU_SA * NU_SA * pow(d, -0.2e1);

    // "Total source term ------------------------------------------------------------------------------------------"
  Q_nu_sa = Q_nusa_convection + Q_nusa_production + Q_nusa_diffusion + Q_nusa_gradsquare + Q_nusa_dissipation;
  return(Q_nu_sa);
}
\end{verbatim}
\end{footnotesize}


%---------------------------------------------------------------------------------------------------------
\bibliographystyle{chicago} 
\bibliography{MMS_bib}

\appendix
\input{Manuf_Solutions_and_Parameters_Oliver}
%\input{list_of_variables}



\end{document}

@Article{ ISI:000285551800008,
	Author = "Kevin Long and Robert Kirby and Bart Van Bloemen Waanders",
	Title = "{UNIFIED EMBEDDED PARALLEL FINITE ELEMENT COMPUTATIONS VIA SOFTWARE-BASED FRECHET DIFFERENTIATION}",
	Journal = "{SIAM JOURNAL ON SCIENTIFIC COMPUTING}",
	Year = "{2010}",
	Volume = "{32}",
	Number = "{6}",
	Pages = "{3323--3351}",
	Abstract = "{Computational analysis of systems governed by partial differential equations (PDEs) requires not only the calculation of a solution but the extraction of additional information such as the sensitivity of that solution with respect to input parameters or the inversion of the system in an optimization or design loop. Moving beyond the automation of discretization of PDEs by finite element methods, we present a mathematical framework that unifies the discretization of PDEs with these additional analysis requirements. In particular, Frechet differentiation on a class of functionals together with a high-performance finite element framework has led to a code, called Sundance, that provides high-level programming abstractions for the automatic, efficient evaluation of finite variational forms together with the derived operators required by engineering analysis.}",
	Publisher = "{SIAM PUBLICATIONS}",
	Address = "{3600 UNIV CITY SCIENCE CENTER, PHILADELPHIA, PA 19104-2688 USA}",
	Type = "{Article}",
	Language = "{English}",
	Affiliation = "{Long, K (Reprint Author), Texas Tech Univ, Dept Math \& Stat, Lubbock, TX 79409 USA. {[}Long, Kevin; Kirby, Robert] Texas Tech Univ, Dept Math \& Stat, Lubbock, TX 79409 USA. {[}Waanders, Bart Van Bloemen] Sandia Natl Labs, Albuquerque, NM 87122 USA.}",
	DOI = "{10.1137/09076920X}",
	ISSN = "{1064-8275}",
	Keywords = "{finite element method, partial differential equations, embedded algorithms}",
	Keywords-Plus = "{VARIATIONAL FORMS; MATRICES; CODE; OPTIMIZATION; VERIFICATION; GENERATION; TRANSFORMS; FLAME}",
	Subject-Category = "{Mathematics, Applied}",
	Author-Email = "{kevin.long@ttu.edu robert.c.kirby@ttu.edu bartv@sandia.gov}",
	Funding-Acknowledgement = "{U.S. Department of Energy {[}DE-AC04-94AL85000]}",
	Funding-Text = "{Applied Mathematics and Applications, Sandia National Laboratories, P.O. Box 5800, Albuquerque, NM 87122 (bartv@sandia.gov). Sandia is a multiprogram laboratory operated by Sandia Corporation, a Lockheed Martin company, for the U.S. Department of Energy under contract DE-AC04-94AL85000.}",
	Number-of-Cited-References = "{43}",
	Times-Cited = "{0}",
	Journal-ISO = "{SIAM J. Sci. Comput.}",
	Doc-Delivery-Number = "{697WZ}",
	Unique-ID = "{ISI:000285551800008}"
}
\begin{equation}
	\begin{split}
\diff{T}{x} &= -\dfrac{1}{14} \dfrac{r_T\, (\gamma-1)\, M_{\infty}^2 \, \,T_{\infty} \, \, u_\tau \, }{u_{\infty}^2 x}\, u \,\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \left[y^{+} \, \Dueqplusyplus+u_{eq}^{+}\right]\\
%
\diff{T}{y} &=  \dfrac{r_T\, (\gamma-1)\, M_{\infty}^2 \, \,T_{\infty} \, \,  u_\tau\,  y^{+} \, }{u_{\infty}^2 y}\, u \,\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)  \Dueqplusyplus\\
%
\diff{ u}{x} &= -\dfrac{1}{14}\dfrac{u_\tau }{x}\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \left[y^{+} \, \Dueqplusyplus+u_{eq}^{+}\right]\\
\diff{ u}{y} &= y^{+} \, \dfrac{ u_\tau }{y} \Dueqplusyplus \cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)\\
\diff{ v}{x} &= -\dfrac{15}{196}\dfrac{ \eta_v u_\tau y}{x^2}\\
\diff{ v}{y} &= \dfrac{1}{14}\dfrac{\eta_v u_\tau}{x}\\
\diff{ \sa}{x} &= -\dfrac{1}{14}\dfrac{ \kappa \,  u_\tau y}{x}\\
\diff{\sa}{y} &= \kappa \,  u_\tau-2 \alpha y\\
\diff{\rho}{x} &= \dfrac{1}{14}\dfrac{p_0}{R T^2} \dfrac{r_T\, (\gamma-1)\, M_{\infty}^2 \, \,T_{\infty} \, \, u_\tau \, }{u_{\infty}^2 x}\, u \,\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right) \left[y^{+} \, \Dueqplusyplus+u_{eq}^{+}\right]\\
\diff{\rho}{y} &=- \dfrac{p_0}{R T^2}  \dfrac{r_T\, (\gamma-1)\, M_{\infty}^2 \, \,T_{\infty} \, \,  u_\tau\, y^{+}}{u_{\infty}^2 y}\, u \,\cos\left(\dfrac{A u_{eq}}{u_{\infty}}\right)   \Dueqplusyplus
%		
\end{split}
\end{equation}