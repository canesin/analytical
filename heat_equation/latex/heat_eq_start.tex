\documentclass[a4paper,10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{geometry}
\geometry{ top=3cm, bottom=2.5cm, left=2.5cm, right=2.5cm}  
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm,  right=2cm}  

\newcommand{\D}{\partial}

%opening
\title{Manufactured Solution for Heat Equation using Maple\footnote{Work based on \cite{Kirk2009}.}}
\author{Kemelli C. Estacio-Hiroms}

\begin{document}

\maketitle

\begin{abstract}
This document describes the usage of the Method of Manufactured Solutions (MMS) in order to verify codes for the numerical solutions of the Heat Equation. The method consists in including a source term into the original equation in such way that the new modified equation with the source term presents a known analytical solution. In this sense, a manufactured solution is presented for the 1D, 2D and 3D transient and steady heat flow with constant and variable material properties. Source terms for each case are obtained by symbolic manipulation using Maple and presented in this document.
\end{abstract}

\section{A short introduction to the Method of Manufactured Solutions}

Verification and Validation (V\&V) are the primary means to assess accuracy and reliability in computational
simulations \cite{Oberkampf2002,Oberkampf2008}. While Validation provides evidence for how accurately the computational
model simulates reality, Verification does not address whether the conceptual model has any relationship to the real
world: it provides evidence that the conceptual model is solved correctly by the discrete mathematics
computer code. 

There are a variety of acceptance criteria for code verification \cite{Roy2004}. In order of increasing
rigor these criteria are: expert judgment, error quantification, consistency and  order of accuracy. The order
of accuracy test is the most rigorous test and is, therefore, the most recommended acceptance criteria \cite{Roy2004}.

The Method of Manufactured Solutions (MMS) provides a general procedure for generating an analytical solution for code accuracy verification \cite{Roache2002,Bond2007}. The basic idea of the procedure is to simply manufacture an exact solution, without being concerned about its physical realism. This approach to constructing test problems includes in the code a general  source term $Q$, and uses it to generate a nontrivial but known solution structure. 

In fact, first a non-trivial but analytic solution is chosen. Then, the solution is passed through the governing PDEâ€™s to give the production term $Q$ that produces this solution. Finally the source term $Q$ is included in the original governing PDE, which can be used to verify the code. Although the form of the manufactured solution is somewhat arbitrary, it should be chosen to be smooth, infinitely differentiable and realizable (solutions should be avoided which have negative densities, pressures, temperatures, etc.)\cite{Roy2004}. Solutions should also be chosen that are sufficiently general so as to exercise all terms in the governing equations.

Depending upon the complexity of the CFD code to be verified, source term $Q$ can be calculated manually; however,
symbolic manipulation is recommended in order to avoid mistakes. In this paper we present a manufactured solution for
the temperature equation and its corresponding source term $Q$, obtained through symbolic manipulation using
Maple \cite{Maple}. Several simplified cases for the temperature equation are presented depending on the characteristics of fluid, such as dimension, modeling of material properties and change over time.


\section{Mathematical Model}
The transient temperature distribution $T({\bf x},t)$ in a conducting medium is given by:
\begin{equation}
 \label{eq:temp}
\rho c_p \frac{\D T}{\D t} - \nabla \cdot (k \nabla T) = 0,
\end{equation}
where $\rho$, $c_p$ and $k$ are the material density, specific heat, and thermal conductivity, respectively,
$t$ denotes time and ${\bf x}=(x,y,z)$.

In this paper, temperature distribution is considered in both steady and unsteady state, with constant and variable material
properties, and in one, two or three-dimensional space, as described in the following sections.

\section{Manufactured Solution}

The general form of the manufactured temperature distribution $T = T ({\bf x}, t)$ is chosen as a
function of cosines \cite{Kirk2009}:
\begin{equation}
 \label{eq:manufactured01}
  T ({\bf x}, t) = \cos(A_x x + A_t t) \cdot \cos(B_y y + B_t t) \cdot \cos(C_z z + C_t t) \cdot \cos(D_t t) .
\end{equation}

This solution satisfies the requirements of a suitable manufactured solution: it is smooth,
infinitely differentiable and realizable. Also, it is non-trivial, i.e., it does not vanish even in case of
some of the unknowns are equal to zero.


In sequence, a hierarchy of solutions which test various features of the governing equation is created. This includes
one, two and three-dimensional temperature distribution, steady and transient state, and constant and variable
material properties. For instance, a steady distribution is recovered when
$A_t = B_t = C_t = D_t = 0$; a one-dimensional distribution results when $B = C = 0$, while a two-dimensional distribution
results for $C = 0$. Moreover, while density $\rho$ is considered constant, thermal capacity $c_p$ and conductivity $k$
can be modeled either as constant or variable. In the later case, they are approximated as a polynomial in $T$.

Although the most general case would be represented by the $3D$ unsteady distribution with both $k$ and $c_p$ variable,
this paper is divided in two main sections: steady and transient distribution. Each one of these sections is subdivided
into other two sections, in case of constant and variable material properties, and source terms obtained for $1D$, $2D$ and $3D$ cases are presented.


\section{Steady Conduction}
For the steady case, Equation (\ref{eq:temp}) is simplified to the form:
\begin{equation}
 \label{eq:temp_steady}
 - \nabla \cdot (k \nabla T) = 0.
\end{equation}

Accordingly, Equation (\ref{eq:manufactured01}) is also simplified by considering $A_t = B_t = C_t = D_t = 0$, it yields:
\begin{equation}
 \label{eq:manufactured02}
  T ({\bf x}) = \cos(A_x x ) \cdot \cos(B_y y ) \cdot \cos(C_z z ).
\end{equation}

In sequence, both approximations for $k$ (constant or variable) are used in order to obtain source term~ $Q$ for the steady temperature
distribution (\ref{eq:temp_steady}) from manufactured solution (\ref{eq:manufactured01}).

\end{document}
