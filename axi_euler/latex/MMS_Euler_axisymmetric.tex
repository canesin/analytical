\documentclass[a4paper,10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{geometry}
\geometry{ top=2.5cm, bottom=2cm, left=2cm, right=2cm}
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm, right=2cm}
\usepackage{pdflscape}

\newcommand{\D}{\partial}
\newcommand{\Diff}[2] {\dfrac{\partial( #1)}{\partial #2}}
\newcommand{\diff}[2] {\dfrac{\partial #1}{\partial #2}}

%opening
\title{Choice of Manufactured Analytical Solution for Code Verification of Axisymmetric Euler Equations}
\author{Kemelli C. Estacio-Hiroms}

\begin{document}
\begin{landscape}
 
\maketitle

\begin{abstract}
The Method of Manufactured Solutions is a valuable approach for code verification, providing means to verify how accurately the numerical method solves the equations of interest. The method generates a related set of governing equations by applying the differential operator for the governing equations to an analytical solution chosen \textit{a priori} to generate source terms, which are added the RHS of the original set of equations. Then, the modified set of equations may be discretized and solved numerically, so its solution may be compared to the exact solution. A choice of analytical solutions for the flow variables of the axisymmetric Euler and their respective source terms are presented in this document.
\end{abstract}

\section{Axisymmetric Euler equations}

Euler equations may be written in cylindrical coordinates for $(r,\theta,z)$, where $r$ is the radial coordinate, $\theta$ is the angular coordinate, and $z$ is the axial coordinate. In axisymmetrical flows, the pressure and the velocity fields are independent of the angular variable $\theta$, and the problem depends exclusively on $r$ and~ $z$. Therefore, Euler equations for axisymmetric flows, in conservation form,  are:
\begin{equation}
 \label{eq:ns_c_01}
%Diff{\rho}{ t} + \frac{1}{r}\Diff{\rho \, r u}{ r} + \Diff{\rho w}{z}=0,\\ non-conservative
\Diff{\rho}{t}+ \dfrac{1}{r} \Diff{ r \rho  u}{r}+ \dfrac{1}{r}\Diff{r \rho  w}{z}=0,
\end{equation}
\begin{equation}
\label{eq:ns_c_02}
%\rho \left( \Diff{u}{t} + u\Diff{u}{r} + w \Diff{u}{z} \right)+\diff{p}{r}=0,
\Diff{\rho u}{t} +\dfrac{1}{r}\Diff{r \rho u^2 }{r}+ \dfrac{1}{r}\Diff{r \rho u w}{z}+\diff{p}{r}=0,
\end{equation}
\begin{equation}
\label{eq:ns_c_03}
%\rho \left( \Diff{w}{t} + u\Diff{w}{r}  + w \Diff{w}{z} \right)+\diff{p}{z}=0.
\Diff{\rho w}{t} + \dfrac{1}{r}\Diff{r \rho w u }{r}+ \dfrac{1}{r}\Diff{r \rho w^2 }{z}+\diff{p}{z}=0,
\end{equation}
\begin{equation}
\label{eq:ns_c_04}
\Diff{\rho e_t}{ t}+\dfrac{1}{r}\Diff{r(\rho e_t+p) u}{ r}+\dfrac{1}{r}\Diff{r(\rho e_t+p)w}{z}=0.
\end{equation}


For a calorically perfect gas, Euler equations are closed with two auxiliary relations for energy:
\begin{equation}
 \label{eq:ns2d_05}
e_t= e+\dfrac{u^2+w^2}{2} \quad \mbox{and}\quad e=\dfrac{1}{\gamma -1}RT ,
\end{equation}
where $\gamma$ is the ratio of specific heats, and with the ideal gas equation of state:
\begin{equation}
 \label{eq:ns2d_07}
p=\rho RT.
\end{equation}

\section{Manufactured Solution}

The choice of cylindrical coordinates, like any system that contains a symmetry axis, introduces singular terms in the governing equation of the type $r^{-n}$, being $r$ the radial coordinate and $n$ a positive exponent, %typically $n=1$ and $n=2$ 
 although the flow is continuous and regular at the axis \cite{Domenichini2004}.

%Therefore, even though it is not a physical boundary,  appropriate boundary conditions at $r=0$ must be defined in order to guarantee the regularity of the flow: %In the case of axisymmetric flows, the singular behavior is simply cancelled by the symmetry condition at the axis.

Accordingly, the representation of fluid flows in cylindrical coordinates requires the definition of appropriate boundary conditions at $r=0$, despite the fact that it is not a physical boundary, that would guarantee the regularity of the flow: %In the case of axisymmetric flows, the singular behavior is simply cancelled by the symmetry condition at the axis.
\begin{equation}
\label{cc}
\begin{split}
u \big| _{r=0} &=0,\\
 \diff{u}{r}\Big| _{r=0} &=0,\\
\diff{w}{r}\Big| _{r=0} &=0.\\
\end{split}
\end{equation}

The strategy to deal with this difficulty in analytical approaches is commonly that of discarding the singular solutions among all the admissible ones. % (e.g. using the Besselâ€™s functions of the first kind, and discarding those of the second kind).
Consequently, a suitable form of each one of the primitive solution variables is a function of sines and cosines:
\begin{equation}
 \label{eq:manufactured01}
\begin{split}
\rho(r,z)&= \rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) ,\\
u(r,z)&=u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) ,\\
w(r,z)&=w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) ,\\
p(r,z)&=p_0 + p_1 \sin\left(\dfrac{a_{pr} \pi r}{L}\right) \cos\left(\dfrac{a_{pz} \pi z}{L}\right), \\
\end{split}
\end{equation}
%
%\begin{equation}
% \label{eq:manufactured01}
%  \phi (r,z) =
%\left\{
%\begin{split}
%& \phi_0+ \phi_1 \cos\left(\frac{a_{\phi r} \pi r}{L}\right)  \sin\left(\frac{a_{\phi z} \pi z}{L}\right), \qquad \phi= %w,\,\rho,\,\mbox{or}\,p \\
%5& \phi_1 \sin\left(\frac{a_{\phi r} \pi r}{L}\right) \left(1- \cos\left(\frac{a_{\phi z} \pi z}{L}\right)\right), \quad\,\, \phi=u
%\end{split}
%\right.
%\end{equation}
%and $\phi_0$ and $\phi_1$ are constants.
where $\rho_0$, $\rho_1$, $p_0$, $p_1$, $u_1$, $w_0$ and $w_1$ are pre-defined constants.

The MMS applied to Euler equations consists in modifying Equations~(\ref{eq:ns_c_01}) -- (\ref{eq:ns_c_04}) by adding a source term to the right-hand side of each equation:
\begin{equation}
 \label{eq:ns2d_mod}
\begin{split}
 \Diff{\rho}{t}+ \dfrac{1}{r} \Diff{\rho r u}{r}+ \dfrac{1}{r}\Diff{\rho r w}{z}&=Q_\rho, \\
\Diff{\rho u}{t} +\dfrac{1}{r}\Diff{r \rho u^2 }{r}+ \dfrac{1}{r}\Diff{r \rho u w}{z}+\diff{p}{r} &=Q_u,\\
\Diff{\rho w}{t} + \dfrac{1}{r}\Diff{r \rho w u }{r}+ \dfrac{1}{r}\Diff{r \rho w^2 }{z}+\diff{p}{z} &=Q_w,\\
\Diff{\rho e_t}{ t}+\dfrac{1}{r}\Diff{r(\rho e_t+p) u}{ r}+\dfrac{1}{r}\Diff{r(\rho e_t+p)w}{z} &=Q_{e},\\
\end{split}
\end{equation}
so the modified set of equations conveniently has the analytical solution given in Equation (\ref{eq:manufactured01}). This is achieved by simply applying Equations~(\ref{eq:ns_c_01}) -- (\ref{eq:ns_c_04}) as operators on Equation (\ref{eq:manufactured01}).

Terms $Q_\rho$, $Q_u$,  $Q_w$ and $Q_{e}$ are obtained by symbolic manipulations of equations above using Maple and are presented in the following sections.


\subsection{Source term for mass conservation equation}
%$\left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] = K$
%$\sin\left(\dfrac{a_{uz} \pi z}{L}\right) = M$
%$\left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]= RHO$
%$\left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]= U$
%$\left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right]= W$
%$\left[p_0 + p_1 \sin\left(\dfrac{a_{pr} \pi r}{L}\right) \cos\left(\dfrac{a_{pz} \pi z}{L}\right) \right]= P$


\begin{equation}
 \begin{split}
 \displaystyle
Q_{\rho} =
&-\dfrac{a_{\rho r} \pi \rho_1}{L} \sin\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]+\\
&+\dfrac{a_{\rho z} \pi \rho_1 }{L} \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right)  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&-\dfrac{a_{ur} \pi u_1 }{L}\sin\left(\dfrac{a_{ur} \pi r}{L}\right)  \sin\left(\dfrac{a_{uz} \pi z}{L}\right)   \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right] +\\
&+\dfrac{a_{wz} \pi w_1 }{L}\cos\left(\dfrac{a_{wr} \pi r}{L}\right) \cos\left(\dfrac{a_{wz} \pi z}{L}\right)  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right] +\\
&+ \dfrac{1}{r}\left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right].
\end{split}
\end{equation}
%
\subsection{Source term for radial velocity}
\begin{equation}
 \begin{split}
 \displaystyle
Q_u =
&-\dfrac{a_{\rho r} \pi \rho_1}{L}\sin\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]^2+\\
&+\dfrac{a_{\rho z} \pi \rho_1}{L}\cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&-\dfrac{2 a_{ur} \pi u_1}{L}\sin\left(\dfrac{a_{ur} \pi r}{L}\right)  \sin\left(\dfrac{a_{uz} \pi z}{L}\right)   \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]+\\
&+\dfrac{a_{uz} \pi u_1}{L}\cos\left(\dfrac{a_{uz} \pi z}{L}\right) \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right]  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]   \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&+\dfrac{a_{wz} \pi w_1}{L} \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \cos\left(\dfrac{a_{wz} \pi z}{L}\right)  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]+\\
&+\dfrac{a_{pr} \pi p_1}{L} \cos\left(\dfrac{a_{pr} \pi r}{L}\right) \cos\left(\dfrac{a_{pz} \pi z}{L}\right)
%\\
%&+
\quad+\quad\dfrac{1}{r}  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]^2.
\end{split}
\end{equation}
%
\subsection{Source term for axial velocity}
\begin{equation}
 \begin{split}
 \displaystyle
Q_w=
&-\dfrac{a_{\rho r} \pi \rho_1}{L} \sin\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&+\dfrac{a_{\rho z} \pi \rho_1 }{L}\cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right)  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] ^2+\\
&-\dfrac{a_{ur} \pi u_1 }{L}\sin\left(\dfrac{a_{ur} \pi r}{L}\right)  \sin\left(\dfrac{a_{uz} \pi z}{L}\right)   \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]   \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&-\dfrac{a_{wr} \pi w_1 }{L}\sin\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right)  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]+\\
&+\dfrac{2 a_{wz} \pi w_1 }{L}\cos\left(\dfrac{a_{wr} \pi r}{L}\right) \cos\left(\dfrac{a_{wz} \pi z}{L}\right)  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]   \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&-\dfrac{a_{pz} \pi p_1 }{L}\sin\left(\dfrac{a_{pr} \pi r}{L}\right) \sin\left(\dfrac{a_{pz} \pi z}{L}\right)
%\\
%&+
\quad+\quad  \dfrac{1}{r}\left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] .
\end{split}
\end{equation}



\subsection{Source term for energy}
\begin{equation}
 \begin{split}
 \displaystyle
Q_{e_t}=&-\dfrac{ a_{\rho r} \pi \rho_1 }{2L}\sin\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right] \left[  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] ^2+\left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]^2 \right]+\\
&+ \dfrac{a_{\rho z} \pi \rho_1 }{2L}\cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right)  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right]  \left[  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] ^2+\left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]^2 \right]+\\
&-\dfrac{ a_{ur} \pi u_1 }{2L}\sin\left(\dfrac{a_{ur} \pi r}{L}\right)  \sin\left(\dfrac{a_{uz} \pi z}{L}\right)   \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[ \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] ^2+3 \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]^2 \right]+\\
&-\dfrac{a_{ur} \pi u_1}{L}\dfrac{\gamma  }{\gamma-1}\sin\left(\dfrac{a_{ur} \pi r}{L}\right)  \sin\left(\dfrac{a_{uz} \pi z}{L}\right)   \left[p_0 + p_1 \sin\left(\dfrac{a_{pr} \pi r}{L}\right) \cos\left(\dfrac{a_{pz} \pi z}{L}\right) \right] +\\
&+ \dfrac{a_{uz} \pi u_1}{L} \cos\left(\dfrac{a_{uz} \pi z}{L}\right) \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right]  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&-\dfrac{a_{wr} \pi w_1 }{L}\sin\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right)  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&+ \dfrac{ a_{wz} \pi w_1 }{2L}\cos\left(\dfrac{a_{wr} \pi r}{L}\right) \cos\left(\dfrac{a_{wz} \pi z}{L}\right)  \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[3  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] ^2+\left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]^2\right] +\\
&+\dfrac{a_{wz} \pi w_1 }{L}\dfrac{\gamma }{\gamma-1}\cos\left(\dfrac{a_{wr} \pi r}{L}\right) \cos\left(\dfrac{a_{wz} \pi z}{L}\right)  \left[p_0 + p_1 \sin\left(\dfrac{a_{pr} \pi r}{L}\right) \cos\left(\dfrac{a_{pz} \pi z}{L}\right) \right] +\\
&+\dfrac{a_{pr} \pi p_1}{L}\dfrac{\gamma }{\gamma-1} \cos\left(\dfrac{a_{pr} \pi r}{L}\right) \cos\left(\dfrac{a_{pz} \pi z}{L}\right) \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]+\\
&-\dfrac{a_{pz} \pi p_1}{L}\dfrac{\gamma }{\gamma-1} \sin\left(\dfrac{a_{pr} \pi r}{L}\right) \sin\left(\dfrac{a_{pz} \pi z}{L}\right)  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] +\\
&+\dfrac{1}{2r} \left[\rho_0 + \rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right] \left[  \left[w_0 + w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right] ^2+\left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]^2 \right] +\\
&+\dfrac{\gamma  }{r(\gamma-1)}   \left[p_0 + p_1 \sin\left(\dfrac{a_{pr} \pi r}{L}\right) \cos\left(\dfrac{a_{pz} \pi z}{L}\right) \right]  \left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right].
\end{split}
\end{equation}


\section{Comments}


Source terms $Q_{\rho}$,  $Q_u$, $Q_w$ and  $Q_e$ have been generated by replacing the analytical expressions (\ref{eq:manufactured01}) into  respective equations (\ref{eq:ns_c_01}) -- (\ref{eq:ns_c_04}), followed by the usage of Maple commands for collecting, sorting and factorizing the terms. Files containing  $C$ codes for the source terms have also been generated. They are: \texttt{ Euler\_axi\_rho\_code.C, Euler\_axi\_u\_code.C, Euler\_axi\_w\_code.C} and \texttt{Euler\_axi\_e\_code.C}.

\newpage
An example of the automatically generated C file from the source term for the radial velocity $u$ equation is:
\begin{verbatim}
#include <math.h>

double SourceQ_u ( double r, double z, double p_0, double p_1, double rho_0, double rho_1, double u_1, double w_0, double w_1,
                   double a_pr, double a_pz, double a_rhor, double a_rhoz, double a_ur, double a_uz, double a_wr, double a_wz,
                   double PI, double L)
{
  double Q_u;
  Q_u = p_1 * cos(a_pr * PI * r / L) * cos(a_pz * PI * z / L) * a_pr * PI / L -
        u_1 * u_1 * pow(sin(a_uz * PI * z / L), 0.2e1) * pow(cos(a_ur * PI * r / L) - 0.1e1, 0.2e1) *
        rho_1 * sin(a_rhor * PI * r / L) * sin(a_rhoz * PI * z / L) * a_rhor * PI / L +
        u_1 * (cos(a_ur * PI * r / L) - 0.1e1) * rho_1 * cos(a_rhor * PI * r / L) * cos(a_rhoz * PI * z / L) *
        sin(a_uz * PI * z / L) * (w_0 + w_1 * cos(a_wr * PI * r / L) * sin(a_wz * PI * z / L)) * a_rhoz * PI / L
        - 0.2e1 * u_1 * u_1 * pow(sin(a_uz * PI * z / L), 0.2e1) * (cos(a_ur * PI * r / L) - 0.1e1) * sin(a_ur * PI * r / L) *
        (rho_0 + rho_1 * cos(a_rhor * PI * r / L) * sin(a_rhoz * PI * z / L)) * a_ur * PI / L +
        u_1 * (cos(a_ur * PI * r / L) - 0.1e1) * cos(a_uz * PI * z / L) *
        (rho_0 + rho_1 * cos(a_rhor * PI * r / L) * sin(a_rhoz * PI * z / L)) *
        (w_0 + w_1 * cos(a_wr * PI * r / L) * sin(a_wz * PI * z / L)) * a_uz * PI / L +
        u_1 * (cos(a_ur * PI * r / L) - 0.1e1) * w_1 * cos(a_wr * PI * r / L) * cos(a_wz * PI * z / L) * sin(a_uz * PI * z / L) *
        (rho_0 + rho_1 * cos(a_rhor * PI * r / L) * sin(a_rhoz * PI * z / L)) * a_wz * PI / L +
        u_1 * u_1 * pow(sin(a_uz * PI * z / L), 0.2e1) * pow(cos(a_ur * PI * r / L) - 0.1e1, 0.2e1) *
        (rho_0 + rho_1 * cos(a_rhor * PI * r / L) * sin(a_rhoz * PI * z / L)) / r;
  return(Q_u);
}
\end{verbatim}
 

Finally the gradients of the analytical solutions (\ref{eq:manufactured01}) have also been computed and their respective C codes are presented in \\ \texttt{Euler\_manuf\_solutions\_grad\_and\_code\_axisymmetric.C}. Therefore,
\begin{equation*}
\nabla  \rho= \left[ \begin{array}{c}
  -\dfrac{ a_{\rho r} \pi \rho_1 }{L}  \sin\left(\dfrac{a_{\rho r}  \pi  r }{L}\right) \sin\left(\dfrac{a_{\rho z}  \pi  z }{L}\right)\vspace{5pt} \\
   \dfrac{ a_{\rho z}  \pi\rho_1 }{L}\cos\left(\dfrac{a_{\rho r}  \pi  r }{L}\right)  \cos\left(\dfrac{a_{\rho z}  \pi  z }{L}\right)
\end{array} \right],
\qquad
\nabla p = \left[ \begin{array}{c}
   \dfrac{ a_{pr}  \pi p_1}{L}\cos\left(\dfrac{a_{pr}  \pi  r }{L}\right)  \cos\left(\dfrac{a_{pz}  \pi  z }{L}\right)\vspace{5pt} \\
  -\dfrac{ a_{pz}  \pi p_1 }{L} \sin\left(\dfrac{a_{pr}  \pi  r }{L}\right)  \sin\left(\dfrac{a_{pz}  \pi  z }{L}\right)
\end{array} \right], \\
\end{equation*}

\begin{equation*}
\nabla u = \left[ \begin{array}{c}
 -\dfrac{ a_{ur}  \pi u_1}{L}   \sin\left(\dfrac{a_{ur}  \pi  r }{L}\right) \sin\left(\dfrac{a_{uz}  \pi  z }{L}\right)\vspace{5pt} \\
  \dfrac{ a_{uz}  \pi u_1}{L}  \left(\cos\left(\dfrac{a_{ur}  \pi  r }{L}\right) - 1\right)  \cos\left(\dfrac{a_{uz}  \pi  z }{L}\right)
\end{array} \right],
\qquad
\nabla w = \left[ \begin{array}{c}
 -\dfrac{ a_{wr}  \pi w_1}{L}  \sin\left(\dfrac{a_{wr}  \pi  r }{L}\right)  \sin\left(\dfrac{a_{wz}  \pi  z }{L}\right)\vspace{5pt} \\
  \dfrac{ a_{wz}  \pi  w_1}{L}  \cos\left(\dfrac{a_{wr}  \pi  r }{L}\right) \cos\left(\dfrac{a_{wz}  \pi  z }{L}\right)
\end{array} \right],
\end{equation*}
are written in C language as:
\begin{verbatim}
grad_rho_an[0] = -rho_1 * sin(a_rhor * pi * r / L) * a_rhor * pi / L * sin(a_rhoz * pi * z / L);
grad_rho_an[1] = 0;
grad_rho_an[2] = rho_1 * cos(a_rhor * pi * r / L) * cos(a_rhoz * pi * z / L) * a_rhoz * pi / L;
grad_p_an[0] = p_1 * cos(a_pr * pi * r / L) * a_pr * pi / L * cos(a_pz * pi * z / L);
grad_p_an[1] = 0;
grad_p_an[2] = -p_1 * sin(a_pr * pi * r / L) * sin(a_pz * pi * z / L) * a_pz * pi / L;
grad_u_an[0] = -u_1 * sin(a_ur * pi * r / L) * a_ur * pi / L * sin(a_uz * pi * z / L);
grad_u_an[1] = 0;
grad_u_an[2] = u_1 * (cos(a_ur * pi * r / L) - 0.1e1) * cos(a_uz * pi * z / L) * a_uz * pi / L;
grad_w_an[0] = -w_1 * sin(a_wr * pi * r / L) * a_wr * pi / L * sin(a_wz * pi * z / L);
grad_w_an[1] = 0;
grad_w_an[2] = w_1 * cos(a_wr * pi * r / L) * cos(a_wz * pi * z / L) * a_wz * pi / L;
\end{verbatim}



%---------------------------------------------------------------------------------------------------------
\bibliographystyle{ieeetr}
\bibliography{../../MMS_bib}


\end{landscape}
\end{document}


\left(\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right) = K

\sin\left(\dfrac{a_{uz} \pi z}{L}\right) = M

\left[\rho_1 \cos\left(\dfrac{a_{\rho r} \pi r}{L}\right) \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)+\rho_0 \right]= RHO

\left[u_1 \left[\cos\left(\dfrac{a_{ur} \pi r}{L}\right)-1\right] \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \right]= U

\left[w_1 \cos\left(\dfrac{a_{wr} \pi r}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right)+w_0 \right]= W

\left[p_1 \sin\left(\dfrac{a_{pr} \pi r}{L}\right) \cos\left(\dfrac{a_{pz} \pi z}{L}\right)+p_0 \right]= P