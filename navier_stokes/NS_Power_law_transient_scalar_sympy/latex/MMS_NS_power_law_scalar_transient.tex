\documentclass[10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{geometry}
%\usepackage[mathcal]{euscript}
\geometry{ top=2.5cm, bottom=2cm, left=2cm, right=2cm}
\usepackage[authoryear]{natbib}
\usepackage{pdflscape}
\usepackage{nicefrac}
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm,  right=2cm}

\newcommand{\D}{\partial}
\newcommand{\Diff}[2] {\dfrac{\partial( #1)}{\partial #2}}
\newcommand{\diff}[2] {\dfrac{\partial #1}{\partial #2}}
\newcommand{\bv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}
\newcommand{\gv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}% for vectors of Greek letters
\newcommand{\grad}[1]{\gv{\nabla} #1}
\newcommand{\Rho}{\,\mathtt{Rho}}
\newcommand{\PP}{\,\mathtt{P}}
\newcommand{\U}{\,\mathtt{U}}
\newcommand{\V}{\,\mathtt{V}}
\newcommand{\W}{\,\mathtt{W}}
\newcommand{\Lo}{\,\mathcal{L}}
\newcommand{\Mu}{\,\mathtt{Mu}}
\newcommand{\T}{\,\mathtt{T}\,}

\newcommand{\DMuDx}{\diff{\Mu}{x}}
\newcommand{\DMuDy}{\diff{\Mu}{y}}
\newcommand{\DMuDz}{\diff{\Mu}{z}}
\newcommand{\Et}{\,\mathtt{E_t}}

\newcommand{\convection}{\text{convection}}
\newcommand{\production}{\text{production}}
\newcommand{\diffusion}{\text{diffusion}}
\newcommand{\gradp}{\text{grad}p}
\newcommand{\viscous}{\text{viscous}}
\newcommand{\heatflux}{\text{heat flux}}
%opening
\title{Manufactured Solution for the Compressible Transient Navier--Stokes Equations  with a Passive Scalar and Power Law Viscosity Model using Sympy\footnote{SymPy is a free open-source Python library for symbolic mathematics.  http://sympy.org/.}}
\author{Kemelli C. Estacio-Hiroms}

\begin{document}

\maketitle

\begin{abstract}
The Method of Manufactured Solutions is a valuable approach for code verification, providing means to verify how accurately the numerical method solves the partial differential equations of interest.
This document presents the source terms generated by the application of the Method of Manufactured Solutions (MMS) on 3D transient Navier--Stokes equations  with transport of a passive scalar and Power Law viscosity model using the analytical manufactured solutions for density, velocity, pressure and a passive scalar presented by \citet{Roy2002}.
\end{abstract}





\section{Mathematical Model}
The conservation of mass, momentum, and total energy for a compressible transient viscous fluid may be written as:
\begin{equation}
 \label{eq:ns_01}
\Diff{\rho}{t} +\nabla \cdot \left(\rho \bv{u}\right) = 0,
\end{equation}

\begin{equation}
 \label{eq:ns_02}
\Diff{\rho \bv{u}}{t} +\nabla\cdot\left(\rho\bv{u}\bv{u}\right) = -\nabla p+  \nabla \cdot (\bv{\tau} ),
\end{equation}

\begin{equation}
 \label{eq:ns_03}
%\nabla \cdot (\rho\bv{u}e_t)+  \nabla\cdot(p  \bv{u})=0
\Diff{\rho e_t}{t} +\nabla\cdot\left(\rho \bv{u} H\right) =-   \nabla\cdot(p  \bv{u}) -\nabla\cdot \bv{q} +  \nabla \cdot (\bv{\tau} \cdot \bv{u}).
\end{equation}

Additionally, the equation for the passive transport of a generic scalar $\phi$ is given by:
\begin{equation}
 \label{eq:ns_pscalar}
  \frac{\D (\rho \phi)}{\D t} + \nabla\cdot\left(\rho\bv{u}\phi\right) = \Gamma \nabla^2 (\phi),
\end{equation}
where $\Gamma$ is the diffusion coefficient and it's taken as constant.

Equations (\ref{eq:ns_01})--(\ref{eq:ns_03}) are known as Navier--Stokes equations and, $\rho$ is the density, $\bv{u}=(u,v,w)$ is the velocity in $x$, $y$ or $z$-direction, respectively,    and $p$ is the pressure. The total enthalpy, $H$, may be expressed in terms of the total energy per unit mass $e_t$, density, and pressure:
$$H = e_t + \dfrac{p}{\rho}.$$ 

For a calorically perfect gas, the Navier--Stokes equations are closed with two auxiliary relations for energy:
\begin{equation}
 \label{eq:ns_04}
e_t= e+\dfrac{\bv{u}\cdot \bv{u}}{2},\quad\mbox{and}\quad e=\dfrac{1}{\gamma -1}RT ,
\end{equation}
and with the ideal gas equation of state:
\begin{equation}
 \label{eq:ns_05}
p=\rho RT.
\end{equation}

The shear stress tensor is:
\begin{equation*}
 \begin{array}{lll}
  \tau_{xx}= \dfrac{2\mu}{3}    \diff{u}{x} + \lambda \left(  \diff{u}{x}+ \diff{v}{y} +\diff{w}{z} \right),
  &\tau_{xy}= \tau_{yx}=\mu \left( \diff{u}{y} + \diff{v}{x}\right),\\
  \tau_{yy}= \dfrac{2\mu }{3}  \diff{v}{y} + \lambda \left(  \diff{u}{x}+ \diff{v}{y} +\diff{w}{z} \right),
  &\tau_{yz}= \tau_{zy}=\mu \left( \diff{v}{z} + \diff{w}{y}\right),\\
  \tau_{zz}= \dfrac{2 \mu}{3}  \diff{w}{z} + \lambda \left(  \diff{u}{x}+ \diff{v}{y} +\diff{w}{z} \right),
  &\tau_{xz}= \tau_{zx}=\mu \left( \diff{u}{z} + \diff{w}{x}\right),
 \end{array}
\end{equation*}
where 
\begin{equation}\label{eq:lambda}
\lambda=\left( \alpha -\dfrac{2}{3} \right)\mu   
\end{equation}
%
is the fluid bulk viscosity\footnote{Setting $\alpha=0$ is equivalent to Stokes' hypothesis that the bulk  viscosity is zero.}
and $\mu$ is the absolute viscosity, which follows a \textbf{power law} in temperature with exponent~$\beta$:
\begin{equation}
 \label{eq:PowerLaw01}
\mu=\mu_{ref}\left(\dfrac{T}{T_{ref}}\right)^\beta,
\end{equation}
where $T_{ref}$ is a reference temperature  and $\mu_{ref}$ is the viscosity at the reference temperature $T_{ref}$.


The heat flux vector $\bv{q}=(q_x,q_y,q_z)$ is given by:
\begin{equation*}
 %\begin{split}
 % q_x &= - \kappa  \diff{T}{x}\\
%q_y &= - \kappa  \diff{T}{y}
% \end{split}
 q_x = - \kappa  \diff{T}{x}, \quad q_y = - \kappa  \diff{T}{y}, \quad \mbox{and} \quad q_z = - \kappa  \diff{T}{z}
 \end{equation*}
where $\kappa $ is the thermal conductivity, which can be determined by choosing the Prandtl number:
\begin{equation}
 \label{eq:k}
\kappa = \dfrac{\gamma R \mu}{ (\gamma-1) \text{Pr}}.
\end{equation}
where $\gamma$ is the ratio of specific heats.


\section{Manufactured Solution}

The Method of Manufactured Solutions (MMS) applied to Navier--Stokes equations with the transport of a scalar consists in modifying Equations~(\ref{eq:ns_01})~--~(\ref{eq:ns_pscalar}) by adding a source term to the right-hand side of each equation, so the modified set of equations conveniently has the analytical solution chosen \textit{a priori}.

\citet{Roy2002} introduce the general form of the primitive manufactured solution variables to be  a function of sines and cosines in $x$, $y$ and $z$ only. In this work, \citet{Roy2002}'s manufactured solutions are modified in order to address temporal accuracy as well:
\begin{equation}
 \label{eq:manufactured01}
  \varphi (x,y,z,t) = \varphi_0+ \varphi_x\, f_s \left(\frac{a_{\varphi x} \pi x}{L} \right) +  \varphi_y \,f_s\left(\frac{a_{\varphi y} \pi y}{L}\right) + \varphi_z \,f_s\left(\frac{a_{\varphi z} \pi z}{L}\right)+ \varphi_t \,f_s\left(\frac{a_{\varphi t} \pi t}{L}\right),
\end{equation}
where $\varphi=\rho,u,v,w, \phi$ or $p$, and $f_s(\cdot)$ functions denote either sine or cosine function. Note that in this case, $\varphi_x$, $\varphi_y$, $\varphi_z$  and $\varphi_t$ are constants  and the subscripts do not denote differentiation.



Although \citet{Roy2002} provide the constants used in the manufactured solutions for the 2D supersonic and subsonic cases for Euler and Navier-Stokes equations, only the source term for the 2D mass conservation equation~(\ref{eq:ns_01}) is presented.


Source terms  for mass conservation ($Q_\rho$), momentum ($Q_u$, $Q_v$ and $Q_w$), total energy ($Q_{e_t}$) and scalar transport ($Q_\phi$) equations are obtained by symbolic manipulations of compressible transient Navier--Stokes+transport equations above using Sympy and are presented in the following sections.



%\section{3D Transient Navier--Stokes equations}

The manufactured analytical solution for for each one of the variables in the 3D transient Navier--Stokes equations are:

\begin{equation}
\begin{split}
\label{eq:manufactured_3d} 
\rho\left( x ,y ,z,t\right) &=  \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho  x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho  y} \pi y}{L}\right) + \rho_{z} \sin\left(\frac{a_{ \rho  z} \pi z}{L}\right) + \rho_t \sin\left(\dfrac{a_{\rho t} \pi t}{L_t}\right),\\
u\left( x ,y ,z,t\right) &= u_{0}+u_{x} \sin\left(\frac{a_{u  x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u  y} \pi y}{L}\right)+u_{z} \cos\left(\frac{a_{u  z} \pi z}{L}\right) + u_t \cos\left(\dfrac{a_{u t} \pi t}{L_t}\right),\\
v\left( x ,y ,z,t\right) &= v_{0}+v_{x} \cos\left(\frac{a_{v  x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v  y} \pi y}{L}\right)+v_{z} \sin\left(\frac{a_{v  z} \pi z}{L}\right)+ v_t \sin\left(\dfrac{a_{v t} \pi t}{L_t}\right), \\
w\left( x ,y ,z,t\right) &= w_{0}+w_{x} \sin\left(\frac{a_{w  x} \pi x}{L}\right)+w_{y} \sin\left(\frac{a_{w  y} \pi y}{L}\right)+ w_{z} \cos\left(\frac{a_{w  z} \pi z}{L}\right)+ w_t \cos\left(\dfrac{a_{w t} \pi t}{L_t}\right) ,\\
p\left( x ,y ,z,t\right) &= p_{0}+p_{x} \cos\left(\frac{a_{p  x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p  y} \pi y}{L}\right)+ p_{z} \cos\left(\frac{a_{p  z} \pi z}{L}\right)+ p_t \cos\left(\dfrac{a_{p t} \pi t}{L_t}\right),\\
\phi\left( x ,y ,z,t\right) &= \phi_{0}+\phi_{x} \cos\left(\frac{a_{\phi  x} \pi x}{L}\right)+\phi_{y} \cos\left(\frac{a_{\phi  y} \pi y}{L}\right)+ \phi_{z} \sin\left(\frac{a_{\phi  z} \pi z}{L}\right)+ \phi_t \cos\left(\dfrac{a_{\phi t} \pi t}{L_t}\right).\\
\end{split}
\end{equation}


The MMS applied to 3D Navier--Stokes equations with transport of a scalar and using Power Law viscosity model consists in modifying Equations~(\ref{eq:ns_01})--(\ref{eq:ns_pscalar}) by adding a source term to the right-hand side of each equation:
\begin{equation}
\begin{split}
\label{eq:ns_3d_mod}
&\Diff{\rho}{t} +\Diff{\rho u}{x}+\Diff{\rho v}{y} + \Diff{\rho w}{z} = Q_\rho\\
%
 &\Diff{\rho u}{t} +\Diff{\rho u^2 }{x}+\Diff{\rho uv}{y} +\Diff{\rho uw}{z} +\Diff{p}{x}-\Diff{\tau_{xx}}{x}-\Diff{\tau_{xy}}{y}-\Diff{\tau_{xz}}{z}= Q_u,\\
%
&\Diff{\rho v}{t} +\Diff{\rho uv }{x}+\Diff{\rho v^2}{y} +\Diff{\rho vw}{z}+\Diff{p}{y}-\Diff{\tau_{yx}}{x}-\Diff{\tau_{yy}}{y}-\Diff{\tau_{yz}}{z}= Q_v,\\
%
&\Diff{\rho w}{t} +\Diff{\rho  uw }{ x}+\Diff{\rho  vw }{ y}+\Diff{\rho w^2 }{ z}+\Diff{p}{z}-\Diff{\tau_{zx}}{x}-\Diff{\tau_{zy}}{y}-\Diff{\tau_{zz}}{z}=Q_w,\\
%
&\Diff{\rho e_t}{t} +\Diff{\rho u e_t}{x}+\Diff{\rho v e_t}{y}+\Diff{\rho we_t}{z}+\Diff{pu}{x}+\Diff{pv}{y}+\Diff{pw}{z} +\Diff{q_x}{x} +\Diff{q_y}{y} +\Diff{q_z}{z}+\\
    &\qquad-\Diff{u\tau_{xx}+v\tau_{xy}+w\tau_{xz}}{x}-\Diff{u\tau_{yx}+v\tau_{yy}+w\tau_{yz}}{y}-\Diff{u\tau_{zx}+v\tau_{zy}+w\tau_{zz}}{y}=Q_{e_t},\\
&\Diff{\rho\phi}{t} + \Diff{\rho u \phi}{x} + \Diff{\rho v \phi}{y} + \Diff{\rho w \phi}{z} - \Gamma \left( \diff{^2 \phi}{x^2} +\diff{^2 \phi}{y^2} + \diff{^2 \phi}{z^2} \right) = Q_{\phi}
\end{split}
\end{equation}
so this modified set of equations has for analytical solution Equation (\ref{eq:manufactured_3d}).

The source terms $Q_\rho$, $Q_u$, $Q_v$, $Q_w$, $Q_{e_t}$ and $Q_\phi$ are  presented with the use of the following auxiliary variables:
\begin{equation}
 \begin{split}
\label{eq:aux_01}
\Rho \, &= \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho  x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho  y} \pi y}{L}\right) + \rho_{z} \sin\left(\frac{a_{ \rho  z} \pi z}{L}\right)+ \rho_t \sin\left(\dfrac{a_{\rho t} \pi t}{L}\right),\\
\U&=u_{0}+u_{x} \sin\left(\frac{a_{u  x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u  y} \pi y}{L}\right)+u_{z} \cos\left(\frac{a_{u  z} \pi z}{L}\right) + u_t \cos\left(\dfrac{a_{u t} \pi t}{L}\right) ,\\
\V \, &= v_{0}+v_{x} \cos\left(\frac{a_{v  x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v  y} \pi y}{L}\right)+v_{z} \sin\left(\frac{a_{v  z} \pi z}{L}\right)+ v_t \sin\left(\dfrac{a_{v t} \pi t}{L}\right), \\
\W \, &= w_{0}+w_{x} \sin\left(\frac{a_{w  x} \pi x}{L}\right)+w_{y} \sin\left(\frac{a_{w  y} \pi y}{L}\right)+ w_{z} \cos\left(\frac{a_{w  z} \pi z}{L}\right) + w_t \cos\left(\dfrac{a_{w t} \pi t}{L}\right),\\
\PP \, &= p_{0}+p_{x} \cos\left(\frac{a_{p  x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p  y} \pi y}{L}\right)+ p_{z} \cos\left(\frac{a_{p  z} \pi z}{L}\right)+ p_t \cos\left(\dfrac{a_{p t} \pi t}{L}\right),\\
\Phi \,  &= \phi_{0}+\phi_{x} \cos\left(\frac{a_{\phi  x} \pi x}{L}\right)+\phi_{y} \cos\left(\frac{a_{\phi  y} \pi y}{L}\right)+ \phi_{z} \sin\left(\frac{a_{\phi  z} \pi z}{L}\right)+ \phi_t \cos\left(\dfrac{a_{\phi t} \pi t}{L_t}\right),\\
\T&= \dfrac{\PP}{R\Rho},\\
\Mu  &=\mu_{ref}\left(\dfrac{\T}{T_{ref}}\right)^\beta,\\
\end{split}
\end{equation}
which simply are the manufactured solutions for $\rho, u, v, w, p$ and $\phi$, the temperature (\ref{eq:ns_05}), and  the fluid viscosity according to Power Law model (\ref{eq:PowerLaw01}), respectively. The following derivatives are also used:
% 
% which simply are the manufactured solutions for $\rho, u, v, w, p$ and $\phi$, and the following auxiliary variables.%, and the the fluid viscosity according to Power Law model (\ref{eq:PowerLaw01}), respectively.
\begin{equation}\label{eq:aux_02}
 \begin{split}
\DMuDx&=  
- \frac{ \beta \mu_{ref} a_{\rho x} \pi \rho_{x} \T^{\beta}}{L \Rho} \left(\frac{1}{T_{ref}}\right)^{\beta} \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) - \frac{\beta \mu_{ref} a_{px} \pi p_{x} \T^{\beta} }{L R \Rho \T}\left(\frac{1}{T_{ref}}\right)^{\beta}
\sin\left(\dfrac{a_{px} \pi x}{L}\right),\\
%
 \DMuDy&=  
\frac{\beta \mu_{ref} a_{\rho y} \pi \rho_{y} \T^{\beta} }{L \Rho} \left(\frac{1}{T_{ref}}\right)^{\beta} \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+ \frac{\beta \mu_{ref} a_{py} \pi p_{y} \T^{\beta} }{L R \Rho \T}\left(\frac{1}{T_{ref}}\right)^{\beta}
\cos\left(\dfrac{a_{py} \pi y}{L}\right),\\
%
\DMuDz&=  
- \frac{\beta \mu_{ref} a_{\rho z} \pi \rho_{z} \T^{\beta} }{L \Rho} \left(\frac{1}{T_{ref}}\right)^{\beta} \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right)- \frac{\beta \mu_{ref} a_{pz} \pi p_{z} \T^{\beta} }{L R \Rho \T}\left(\frac{1}{T_{ref}}\right)^{\beta}
\sin\left(\dfrac{a_{pz} \pi z}{L}\right)
 \end{split}
\end{equation}


\subsection{Mass Conservation Equation}

The mass conservation equation may be written as an operator $\Lo_\rho$:
$$ \Lo_{\rho} = \Lo_{\rho \, \text{time}}+\Lo_{\rho \, \text{convection}}$$
where:
\begin{equation}
\begin{split}\label{eq:rho_operators}
\Lo_{\rho \, \text{time}}&=\Diff{\rho}{t} \\
\Lo_{\rho \, \text{convection}}&=\Diff{\rho u}{x}+\Diff{\rho v}{y} + \Diff{\rho w}{z}.
\end{split}
 \end{equation}

The operators defined in Eq. (\ref{eq:rho_operators}) are applied into Equation  (\ref{eq:manufactured_3d}), providing respective source terms that will compound source term $Q_{\rho}$:
\begin{equation*}
 Q_{\rho} = Q_{\rho \, \text{time}}+Q_{\rho \, \text{convection}}.
\end{equation*}


They are:
\begin{equation*}
 \begin{split}
 Q_{\rho \, \text{time}}&= 
\frac{ \Phi \,  a_{\rho t} \pi\rho_{t} \cos\left(\frac{a_{\rho t} \pi t}{L_t}\right)}{L_t} - \frac{ \Rho \, a_{\phi t} \pi\phi_{t} \sin\left(\frac{a_{\phi t} \pi t}{L_t}\right)}{L_t}, \\\vspace{20pt}
%
 Q_{\rho \, \text{convection}}&= 
\frac{\pi \Rho \, }{L} \left[a_{ux} u_{x} \cos\left(\frac{a_{ux} \pi x}{L}\right) + a_{vy} v_{y} \cos\left(\frac{a_{vy} \pi y}{L}\right) - a_{wz} w_{z} \sin\left(\frac{a_{wz} \pi z}{L}\right)\right] + \\ 
&+ \frac{ \U \, a_{\rho x} \pi\rho_{x} }{L}\cos\left(\frac{a_{\rho x} \pi x}{L}\right)  - \frac{ \V \, a_{\rho y} \pi\rho_{y} }{L}\sin\left(\frac{a_{\rho y} \pi y}{L}\right)+ \frac{ \W \, a_{\rho z} \pi\rho_{z} }{L}\cos\left(\frac{a_{\rho z} \pi z}{L}\right),
 \end{split}
\end{equation*}
where $\Rho,\,\U,\,\V$ and $\W$  are defined in Equation (\ref{eq:aux_01}).


\subsection{Momentum Conservation Equations}

% Velocity u -----------------------------------------------------------------------------
\subsubsection{Velocity $u$}
For the generation of the analytical source term $Q_u$, $x$-momentum equation (\ref{eq:ns_02}) is written as an operator $\Lo_u$:
 $$\Lo_u = \Lo_{u \, \text{time}}+\Lo_{u \, \convection}+\Lo_{u \, \gradp }+\Lo_{u \, \viscous }$$
with each one of the sub-operators defined as follows:
\begin{equation*}
 \begin{split}
\Lo_{u \, \text{time}}&= \Diff{\rho u}{t} \\
\Lo_{u \, \convection}&= \Diff{\rho u^2 }{x}+\Diff{\rho uv}{y} +\Diff{\rho uw}{z}\\
\Lo_{u \, \gradp }&= \Diff{p}{x}\\
\Lo_{u \, \viscous }&= -\Diff{\tau_{xx}}{x}-\Diff{\tau_{xy}}{y}-\Diff{\tau_{xz}}{z}
 \end{split}
\end{equation*}

Source term $Q_u$ is obtained by operating $\Lo_{u}$ on Equations  (\ref{eq:manufactured_3d}) together with the use of the  auxiliary relations given in Equations (\ref{eq:aux_01}) and (\ref{eq:aux_02}). It yields:
\begin{equation*}
 \label{eq:ns1d_12}
Q_u = Q_{u \, \text{time}}+Q_{u \, \convection}+Q_{u \, \gradp }+Q_{u \, \viscous }
\end{equation*}
with
\begin{equation*}
 \begin{split}
 Q_{u \, \text{time}}&= 
\frac{ \U \, a_{\rho t} \pi\rho_{t} }{L_t}\cos\left(\frac{a_{\rho t} \pi t}{L_t}\right) - \frac{\Rho \, a_{ut} \pi u_{t} }{L_t}\sin\left(\frac{a_{ut} \pi t}{L_t}\right),\\
%
 Q_{u \, \text{convection}}&= 
\frac{\pi \Rho \, \U \, }{L} \left[a_{vy} v_{y}\cos\left(\frac{a_{vy} \pi y}{L}\right) - a_{wz} w_{z} \sin\left(\frac{a_{wz} \pi z}{L}\right) + 2 a_{ux} u_{x} \cos\left(\frac{a_{ux} \pi x}{L}\right)\right] + \\ 
&- \frac{ \Rho \, \V \, a_{uy} \pi u_{y} }{L}\sin\left(\frac{a_{uy} \pi y}{L}\right) - \frac{\Rho \, \W \, a_{uz} \pi u_{z} }{L} \sin\left(\frac{a_{uz} \pi z}{L}\right)+\\
&+ \frac{\U^{2} a_{\rho x} \pi \rho_{x} }{L}\cos\left(\frac{a_{\rho x} \pi x}{L}\right) - \frac{ \U \, \V \, a_{\rho y} \pi\rho_{y} }{L}\sin\left(\frac{a_{\rho y} \pi y}{L}\right)+ \frac{ \U \, \W \, a_{\rho z} \pi\rho_{z} }{L}\cos\left(\frac{a_{\rho z} \pi z}{L}\right) ,\\
%
Q_{u \, \text{gradp}}&= - \frac{a_{px} \pi p_{x} \sin\left(\frac{a_{px} \pi x}{L}\right)}{L}, \\
%----------------------------------------------------------------------------
 Q_{u \viscous}&=
%
- \DMuDx \frac{\pi }{L} \left(\frac{2}{3} - \alpha\right) \left(a_{wz} w_{z} \sin\left(\dfrac{a_{wz} \pi z}{L}\right) - a_{ux} u_{x} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) -a_{vy} v_{y} \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right) +\\
%
&- 2 \DMuDx \frac{\pi  a_{ux} u_{x}}{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right)+\\
%
&+\DMuDy \frac{\pi  }{L} \left(a_{uy} u_{y} \sin\left(\dfrac{a_{uy} \pi y}{L}\right) + a_{vx} v_{x}
\sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right)+\\
%
&+ \DMuDz \frac{\pi  }{L}\left(a_{uz} u_{z}
\sin\left(\dfrac{a_{uz} \pi z}{L}\right) - a_{wx} w_{x} \cos\left(\dfrac{\pi a_{wx}
x}{L}\right)\right) +\\
%
&+ \frac{\Mu \pi^{2} }{L^{2}}\left(a_{uy}^{2} u_{y} \cos\left(\dfrac{a_{uy} \pi y}{L}\right) + a_{uz}^{2} u_{z} \cos\left(\dfrac{a_{uz} \pi z}{L}\right) + 2 a_{ux}^{2} u_{x} \sin\left(\dfrac{a_{ux} \pi x}{L}\right)\right) +\\
%
&+ \frac{\lambda a_{ux}^{2}\pi^{2} u_{x} }{L^{2}} \sin\left(\dfrac{a_{ux} \pi x}{L}\right)\\,
 \end{split}
\end{equation*}
with $\Mu,\, \Rho,\,\U,\,\V$ and $\W$  defined in Equation (\ref{eq:aux_01}), the derivatives $\DMuDx,\DMuDy$ and $\DMuDz$ defined in Equation~(\ref{eq:aux_02}), and:
\begin{equation}\label{eq:lambda02}
 \lambda=\left( \alpha -\dfrac{2}{3} \right)\Mu   
\end{equation}
is given according to Equation (\ref{eq:lambda}).


% Velocity v -----------------------------------------------------------------------------
\subsubsection{Velocity $v$}
Analogously to the velocity-$u$ case, for the generation of the analytical source term $Q_v$, $y$-momentum equation (\ref{eq:ns_02}) is written as an operator $\Lo_v$:
 $$\Lo_v = \Lo_{v \, \text{time}}+\Lo_{v \, \convection}+\Lo_{v \, \gradp }+\Lo_{v \, \viscous }$$
with each one of the sub-operators defined as follows:
\begin{equation*}
 \begin{split}
\Lo_{v \, \text{time}}&= \Diff{\rho v}{t} \\
\Lo_{v \, \convection}&= \Diff{\rho uv }{x}+\Diff{\rho v^2}{y} +\Diff{\rho vw}{z}\\
\Lo_{v \, \gradp }&= \Diff{p}{y}\\
\Lo_{v \, \viscous }&= -\Diff{\tau_{yx}}{x}-\Diff{\tau_{yy}}{y}-\Diff{\tau_{yz}}{z}
 \end{split}
\end{equation*}

Source term $Q_v$ is obtained by operating $\Lo_{v}$ on Equations  (\ref{eq:manufactured_3d}) together with the use of the  auxiliary relations given in Equations (\ref{eq:aux_01}) and (\ref{eq:aux_02}). It yields:
\begin{equation*}
 \label{eq:ns1d_12}
Q_v = Q_{v \, \text{time}}+Q_{v \, \convection}+Q_{v \, \gradp }+Q_{v \, \viscous }
\end{equation*}
with
%
\begin{equation*}
 \begin{split}
 Q_{v \, \text{time}}&= \frac{\V \, a_{\rho t} \pi \rho_{t} \cos\left(\frac{a_{\rho t} \pi t}{L_t}\right)}{L_t} + \frac{ \Rho \, a_{vt}\pi v_{t} \cos\left(\frac{a_{vt} \pi t}{L_t}\right)}{L_t} ,\\
%
 Q_{v \, \text{convection}}&= 
\frac{\pi \Rho \, \V \, }{L} \left[a_{ux} u_{x} \cos\left(\frac{a_{ux} \pi x}{L}\right) - a_{wz} w_{z} \sin\left(\frac{a_{wz} \pi z}{L}\right) + 2 a_{vy} v_{y} \cos\left(\frac{a_{vy} \pi y}{L}\right)\right]+ \\ 
&- \frac{\Rho \, \U \, a_{vx} \pi v_{x} }{L}\sin\left(\frac{a_{vx} \pi x}{L}\right) + \frac{\Rho \, \W \, a_{vz} \pi v_{z} }{L} \cos\left(\frac{a_{vz} \pi z}{L}\right)+ \\ 
&+ \frac{\U \, \V \, a_{\rho x} \pi \rho_{x} }{L}\cos\left(\frac{a_{\rho x} \pi x}{L}\right) - \frac{a_{\rho y} \pi \rho_{y} \V^{2} }{L} \sin\left(\frac{a_{\rho y} \pi y}{L}\right)+ \frac{\V \, \W \, a_{\rho z} \pi \rho_{z} }{L}\cos\left(\frac{a_{\rho z} \pi z}{L}\right) ,\\
%
 Q_{v \, \text{gradp}}&= \frac{a_{py} \pi p_{y} \cos\left(\frac{a_{py} \pi y}{L}\right)}{L},\\
%
  Q_{v \viscous}&=  
\DMuDx \frac{\pi  }{L} \left(a_{uy} u_{y} \sin\left(\dfrac{a_{uy} \pi y}{L}\right) + a_{vx} v_{x}
\sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right)+\\
%
&- \DMuDy \frac{\pi  }{L}\left(\frac{2}{3} - \alpha\right) \left(a_{wz} w_{z}
\sin\left(\dfrac{a_{wz} \pi z}{L}\right) - a_{ux} u_{x} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) -
a_{vy} v_{y} \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right) +\\
%
%
&- 2 \DMuDy \frac{\pi  a_{vy} v_{y} }{L}\cos\left(\dfrac{a_{vy} \pi y}{L}\right)+\\
%
&+ \DMuDz \frac{\pi  }{L}\left(- a_{vz} v_{z}
\cos\left(\dfrac{a_{vz} \pi z}{L}\right) - a_{wy} w_{y} \cos\left(\dfrac{\pi a_{wy}
y}{L}\right)\right)+\\
%
& + \frac{\Mu \pi^{2} }{L^{2}}\left(a_{vx}^{2} v_{x} \cos\left(\dfrac{a_{vx} \pi x}{L}\right) + 
a_{vz}^{2} v_{z}\sin\left(\dfrac{a_{vz} \pi z}{L}\right) + 2a_{vy}^{2}  v_{y} \sin\left(\dfrac{\pi a_{vy}
y}{L}\right)\right) +\\
%
&+ \frac{\lambda a_{vy}^{2} \pi^{2} v_{y} }{L^{2}}\sin\left(\dfrac{a_{vy} \pi y}{L}\right) \\
%
 \end{split}
\end{equation*}
where $\Mu,\, \Rho,\,\U,\,\V$ and $\W$  are defined in Equation (\ref{eq:aux_01}), the derivatives $\DMuDx,\DMuDy$ and $\DMuDz$ are given in Equation~(\ref{eq:aux_02}), and $\lambda$ is given in Equation (\ref{eq:lambda}).



% Velocity w  -----------------------------------------------------------------------------
\subsubsection{Velocity $w $}
Finally, for the generation of the analytical source term $Q_w $, $z$-momentum equation (\ref{eq:ns_02}) is written as an operator~$\Lo_w $:
 $$\Lo_w  = \Lo_{w  \, \text{time}}+\Lo_{w  \, \convection}+\Lo_{w  \, \gradp }+\Lo_{w  \, \viscous }$$
with each one of the sub-operators defined as follows:
\begin{equation*}
 \begin{split}
\Lo_{w  \, \text{time}}&= \Diff{\rho w }{t} \\
\Lo_{w  \, \convection}&= \Diff{\rho  uw }{ x}+\Diff{\rho  vw }{ y}+\Diff{\rho w^2 }{ z}\\
\Lo_{w  \, \gradp }&= \Diff{p}{z}\\
\Lo_{w  \, \viscous }&= -\Diff{\tau_{zx}}{x}-\Diff{\tau_{zy}}{y}-\Diff{\tau_{zz}}{z}
 \end{split}
\end{equation*}

Source term $Q_w $ is obtained by operating $\Lo_{w }$ on Equations  (\ref{eq:manufactured_3d}) together with the use of the  auxiliary relations given in Equations (\ref{eq:aux_01}) and (\ref{eq:aux_02}). It yields:
\begin{equation*}
Q_w  = Q_{w  \, \text{time}}+Q_{w  \, \convection}+Q_{w  \, \gradp }+Q_{w  \, \viscous }
\end{equation*}
where
\begin{equation*}
 \begin{split}
 Q_{w \, \text{time}}&= 
\frac{\W \, a_{\rho t} \pi  \rho_{t} }{L_t}\cos\left(\frac{a_{\rho t} \pi t}{L_t}\right) - \frac{\Rho \, a_{wt} \pi w_{t} }{L_t}\sin\left(\frac{a_{wt} \pi t}{L_t}\right),\\
%
 Q_{w \, \text{convection}}&= 
\frac{\pi \Rho \, \W \, }{L}\left[a_{ux} u_{x} \cos\left(\frac{a_{ux} \pi x}{L}\right) + a_{vy} v_{y} \cos\left(\frac{a_{vy} \pi y}{L}\right) - 2 a_{wz} w_{z} \sin\left(\frac{a_{wz} \pi z}{L}\right)\right] + \\ 
&+ \frac{\Rho \, \U \, a_{wx} \pi w_{x} }{L} \cos\left(\frac{a_{wx} \pi x}{L}\right)+ \frac{\Rho \, \V \, a_{wy} \pi w_{y} }{L}\cos\left(\frac{a_{wy} \pi y}{L}\right) + \\ 
&+ \frac{\U \, \W \, a_{\rho x} \pi \rho_{x} }{L}\cos\left(\frac{a_{\rho x} \pi x}{L}\right) - \frac{\V \, \W \, a_{\rho y} \pi \rho_{y} }{L}\sin\left(\frac{a_{\rho y} \pi y}{L}\right)+ \frac{\W^{2} a_{\rho z} \pi \rho_{z} }{L}\cos\left(\frac{a_{\rho z} \pi z}{L}\right) ,\\
%
 Q_{w \, \text{gradp}}&= - \frac{a_{pz} \pi p_{z} \sin\left(\frac{a_{pz} \pi z}{L}\right)}{L},\\
%
 Q_{ w \viscous}&=  
\DMuDx \frac{\pi  }{L}\left(a_{uz} u_{z} \sin\left(\dfrac{a_{uz} \pi z}{L}\right) - a_{wx} w_{x}
\cos\left(\dfrac{a_{wx} \pi x}{L}\right)\right) +\\
%
&+ \DMuDy \frac{\pi  }{L} \left(- a_{vz} v_{z}
\cos\left(\dfrac{a_{vz} \pi z}{L}\right) - a_{wy} w_{y} \cos\left(\dfrac{\pi a_{wy}
y}{L}\right)\right)+\\
%
&+ 2 \DMuDz \frac{ a_{wz} \pi w_{z}}{L}\sin\left(\dfrac{a_{wz} \pi z}{L}\right)+\\
%
&- \DMuDz \frac{\pi }{L} \left(\frac{2}{3} - \alpha\right) \left(a_{wz} w_{z}
\sin\left(\dfrac{a_{wz} \pi z}{L}\right) - a_{ux} u_{x} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) -
a_{vy} v_{y} \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right) +\\
%
&+ \frac{\Mu \pi^{2} }{L^{2}}\left(a_{wx}^{2} w_{x} \sin\left(\dfrac{a_{wx} \pi x}{L}\right) + 
a_{wy}^{2} w_{y}\sin\left(\dfrac{a_{wy} \pi y}{L}\right) + 2 a_{wz}^{2} w_{z} \cos\left(\dfrac{\pi a_{wz}
z}{L}\right)\right) +\\
%
&+ \frac{\lambda a_{wz}^{2}\pi^{2}  w_{z}  }{L^{2}}\cos\left(\dfrac{a_{wz} \pi z}{L}\right) +\\
%
 \end{split}
\end{equation*}
where $\Mu,\, \Rho,\,\U,\,\V$ and $\W$ are defined in Equation (\ref{eq:aux_01}) and the derivatives $\DMuDx,\DMuDy$ and $\DMuDz$ are given in Equation~(\ref{eq:aux_02}).  $\lambda$ is given in Equation (\ref{eq:lambda}).


\subsection{Total Energy Conservation Equation}
The total energy equation is written as an operator:
\begin{equation*}
 \label{eq:ns1d_14}
\Lo_{e_t} = \Lo_{e_t \text{time}} + \Lo_{e_t \convection} + \Lo_{e_t \gradp}+ \Lo_{e_t \viscous} + \Lo_{e_t \heatflux} 
\end{equation*}
with
\begin{equation*}
\begin{split}
\Lo_{e_t \text{time}}&= \Diff{\rho e_t}{t} ,\\
\Lo_{e_t \convection} &= \Diff{\rho u e_t}{x}+\Diff{\rho v e_t}{y}+\Diff{\rho we_t}{z},\\
\Lo_{e_t \gradp} &=+\Diff{pu}{x}+\Diff{pv}{y}+\Diff{pw}{z} ,\\
\Lo_{e_t \heatflux} &=+\Diff{q_x}{x} +\Diff{q_y}{y} +\Diff{q_z}{z},\\ 
\Lo_{e_t \viscous} &= -\Diff{u\tau_{xx}+v\tau_{xy}+w\tau_{xz}}{x}-\Diff{u\tau_{yx}+v\tau_{yy}+w\tau_{yz}}{y}-\Diff{u\tau_{zx}+v\tau_{zy}+w\tau_{zz}}{y},\\
 \end{split}
\end{equation*}

Therefore, source term $Q_{e_t}$ is given by
$$Q_{e_t} = Q_{e_t \text{time}} + Q_{e_t \convection} + Q_{e_t \gradp}+ Q_{e_t \viscous} + Q_{e_t \heatflux}, $$
where:

\begin{equation*}
 \begin{split}
 Q_{e_t \, \text{time}}&= 
\frac{\pi \Rho \, }{L_t} \left[\V \, a_{vt} v_{t} \cos\left(\frac{a_{vt} \pi t}{L_t}\right) - \U \, a_{ut} u_{t} \sin\left(\frac{a_{ut} \pi t}{L_t}\right) - \W \, a_{wt} w_{t} \sin\left(\frac{a_{wt} \pi t}{L_t}\right)\right] + \\ 
&+ \frac{\Et a_{\rho t} \pi \rho_{t} }{L_t}\cos\left(\frac{a_{\rho t} \pi t}{L_t}\right) + \frac{\PP \, a_{\rho t} \pi \rho_{t} }{L_t \Rho \, \left(1 - \gamma\right)}\cos\left(\frac{a_{\rho t} \pi t}{L_t}\right)+ \frac{a_{pt} \pi p_{t} }{L_t \left(1 - \gamma\right)}\sin\left(\frac{a_{pt} \pi t}{L_t}\right) 
,\\
 \end{split}
\end{equation*}

%
%
\begin{equation*}
 \begin{split}
 Q_{e_t \, \text{convection}}&= 
\frac{\pi \Rho \, }{L} \left[a_{ux} u_{x} \U^{2} \cos\left(\frac{a_{ux} \pi x}{L}\right) + a_{vy} v_{y} \V^{2} \cos\left(\frac{a_{vy} \pi y}{L}\right) - a_{wz} w_{z} \W^{2} \sin\left(\frac{a_{wz} \pi z}{L}\right)+\right.\\
 &\qquad\left. + \U \, \W \, a_{wx} w_{x} \cos\left(\frac{a_{wx} \pi x}{L}\right) + \V \, \W \, a_{vz} v_{z} \cos\left(\frac{a_{vz} \pi z}{L}\right) + \V \, \W \, a_{wy} w_{y} \cos\left(\frac{a_{wy} \pi y}{L}\right) +\right.\\
 &\qquad\left.- \U \, \V \, a_{uy} u_{y} \sin\left(\frac{a_{uy} \pi y}{L}\right) - \U \, \V \, a_{vx} v_{x} \sin\left(\frac{a_{vx} \pi x}{L}\right) - \U \, \W \, a_{uz} u_{z} \sin\left(\frac{a_{uz} \pi z}{L}\right)\right] + \\ 
&+ \frac{\pi }{L \left(1 - \gamma\right)}\left[\U \, a_{px} p_{x} \sin\left(\frac{a_{px} \pi x}{L}\right) + \W \, a_{pz} p_{z} \sin\left(\frac{a_{pz} \pi z}{L}\right) - \V \, a_{py} p_{y} \cos\left(\frac{a_{py} \pi y}{L}\right)\right] +\\ 
&+ \frac{\pi \Et \Rho \, }{L} \left[a_{ux} u_{x} \cos\left(\frac{a_{ux} \pi x}{L}\right) + a_{vy} v_{y} \cos\left(\frac{a_{vy} \pi y}{L}\right) - a_{wz} w_{z} \sin\left(\frac{a_{wz} \pi z}{L}\right)\right] + \\ 
&+ \frac{a_{\rho x} \pi \rho_{x} }{L} \left(\Et \U \, + \frac{\PP \, \U}{\Rho \, \left(1 - \gamma\right)}\right) \cos\left(\frac{a_{\rho x} \pi x}{L}\right) + \\ 
&- \frac{a_{\rho y} \pi \rho_{y} }{L} \left(\Et \V \, + \frac{\PP \, \V}{\Rho \, \left(1 - \gamma\right)}\right) \sin\left(\frac{a_{\rho y} \pi y}{L}\right) + \\ 
&+ \frac{a_{\rho z} \pi \rho_{z} }{L} \left(\Et \W \, + \frac{\PP \, \W}{\Rho \, \left(1 - \gamma\right)}\right) \cos\left(\frac{a_{\rho z} \pi z}{L}\right)
,\\
%
&\\
%
 Q_{e_t \, \text{gradp}}&= 
\frac{\pi \PP \, }{L} \left[a_{ux} u_{x} \cos\left(\frac{a_{ux} \pi x}{L}\right) + a_{vy} v_{y} \cos\left(\frac{a_{vy} \pi y}{L}\right) - a_{wz} w_{z} \sin\left(\frac{a_{wz} \pi z}{L}\right)\right]+ \\ 
&- \frac{\U \, a_{px} \pi p_{x} }{L}\sin\left(\frac{a_{px} \pi x}{L}\right)+ \frac{\V \, a_{py} \pi p_{y} }{L}\cos\left(\frac{a_{py} \pi y}{L}\right) - \frac{\W \, a_{pz}\pi p_{z} }{L}\sin\left(\frac{a_{pz} \pi z}{L}\right)
,\\
%
&\\
%
 Q_{e_t \, \text{heatflux}}&= 
\frac{\texttt{k} \pi^{2} }{R L^{2} \Rho \, }\left[a_{px}^{2} p_{x} \cos\left(\frac{a_{px} \pi x}{L}\right) + a_{py}^{2} p_{y} \sin\left(\frac{a_{py} \pi y}{L}\right) + a_{pz}^{2} p_{z} \cos\left(\frac{a_{pz} \pi z}{L}\right)\right] +\\
&+ \frac{\texttt{k} \pi^{2} }{R L^{2} \Rho^{2}}\left[- 2 a_{px} a_{\rho x} p_{x} \rho_{x} \cos\left(\frac{a_{\rho x} \pi x}{L}\right) \sin\left(\frac{a_{px} \pi x}{L}\right) - 2 a_{py} a_{\rho y} p_{y} \rho_{y} \cos\left(\frac{a_{py} \pi y}{L}\right) \sin\left(\frac{a_{\rho y} \pi y}{L}\right) +\right.\\
 &\qquad\left.- 2 a_{pz} a_{\rho z} p_{z} \rho_{z} \cos\left(\frac{a_{\rho z} \pi z}{L}\right) \sin\left(\frac{a_{pz} \pi z}{L}\right)\right] +\\
&+ \frac{\PP \, \texttt{k} \pi^{2} }{R L^{2} \Rho^{3}}\left[- 2 a_{\rho x}^{2} \rho_{x}^{2} \cos^{2}\left(\frac{a_{\rho x} \pi x}{L}\right) - 2 a_{\rho y}^{2} \rho_{y}^{2} \sin^{2}\left(\frac{a_{\rho y} \pi y}{L}\right) - 2 a_{\rho z}^{2} \rho_{z}^{2} \cos^{2}\left(\frac{a_{\rho z} \pi z}{L}\right)\right] +\\
&+ \frac{\PP \, \texttt{k} \pi^{2} }{R L^{2} \Rho^{2}}\left[- \rho_{x} a_{\rho x}^{2} \sin\left(\frac{a_{\rho x} \pi x}{L}\right) - \rho_{y} a_{\rho y}^{2} \cos\left(\frac{a_{\rho y} \pi y}{L}\right) - \rho_{z} a_{\rho z}^{2} \sin\left(\frac{a_{\rho z} \pi z}{L}\right)\right]+\\
%
&- \DMuDx \frac{\gamma a_{px} \pi p_{x} }{L\, \text{Pr} \, \Rho \left(1 - \gamma\right)} \sin\left(\frac{ a_{px} \pi x}{L}\right)
- \DMuDx \frac{\PP \gamma  a_{\rho x} \pi \rho_{x} }{L\, \text{Pr} \, \Rho^{2} \left(1 - \gamma\right)} \cos\left(\frac{ a_{\rho x} \pi x}{L}\right)+\\
&+\DMuDy \frac{\gamma a_{py} \pi p_{y} }{L\, \text{Pr} \, \Rho \left(1 - \gamma\right)} \cos\left(\frac{ a_{py} \pi y}{L}\right)
+ \DMuDy \frac{\PP \gamma  a_{\rho y} \pi \rho_{y} }{L\, \text{Pr} \, \Rho^{2} \left(1 - \gamma\right)} \sin\left(\frac{ a_{\rho y} \pi y}{L}\right)+\\
&- \DMuDz \frac{\gamma a_{pz} \pi p_{z} }{L\, \text{Pr} \, \Rho \left(1 - \gamma\right)}\sin\left(\frac{ a_{pz} \pi z}{L}\right) - \DMuDz \frac{\PP \gamma  a_{\rho z} \pi \rho_{z} }{L\, \text{Pr} \, \Rho^{2} \left(1 - \gamma\right)}\cos\left(\frac{ a_{\rho z} \pi z}{L}\right),\\
%
&\\
%
Q_{e_t \viscous} &= \frac{\lambda \pi^{2} }{L^{2}}\left(\U u_{x} a_{ux}^{2} \sin\left(\dfrac{a_{ux} \pi x}{L}\right) + \V
v_{y} a_{vy}^{2} \sin\left(\dfrac{a_{vy} \pi y}{L}\right) + \W w_{z} a_{wz}^{2} \cos\left(\dfrac{\pi
a_{wz} z}{L}\right) \right.+\\
  &\quad\left.- 2 a_{ux} a_{vy} u_{x} v_{y} \cos\left(\dfrac{a_{ux} \pi x}{L}\right)
\cos\left(\dfrac{a_{vy} \pi y}{L}\right) + 2 a_{ux} a_{wz} u_{x} w_{z} \cos\left(\dfrac{\pi a_{ux}
x}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \right.+\\
  &\quad\left.+ 2 a_{vy} a_{wz} v_{y} w_{z} \cos\left(\dfrac{\pi
a_{vy} y}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) - a_{ux}^{2} u_{x}^{2}
\cos^2\left(\dfrac{a_{ux} \pi x}{L}\right) - a_{vy}^{2} v_{y}^{2} \cos^2\left(\dfrac{\pi a_{vy}
y}{L}\right) \right.+\\
  &\quad\left.- a_{wz}^{2} w_{z}^{2} \sin^2\left(\dfrac{a_{wz} \pi z}{L}\right)\right) +\\
%
&+\cdots
 \end{split}
\end{equation*}
\begin{equation*}
\begin{split}
&+ \frac{\Mu \pi^{2}}{L^{2}} 
\left(\U \left(u_{y} a_{uy}^{2} \cos\left(\dfrac{a_{uy} \pi y}{L}\right) + u_{z} a_{uz}^{2}
\cos\left(\dfrac{a_{uz} \pi z}{L}\right) + 2 u_{x} a_{ux}^{2} \sin\left(\dfrac{\pi a_{ux}
x}{L}\right)\right) \right.+\\
  &\quad\left.+ \V \left(v_{x} a_{vx}^{2} \cos\left(\dfrac{a_{vx} \pi x}{L}\right) + v_{z} a_{vz}^{2}
\sin\left(\dfrac{a_{vz} \pi z}{L}\right) + 2 v_{y} a_{vy}^{2} \sin\left(\dfrac{\pi a_{vy}
y}{L}\right)\right) \right.+\\
  &\quad\left.+ \W \left(w_{x} a_{wx}^{2} \sin\left(\dfrac{a_{wx} \pi x}{L}\right) + w_{y} a_{wy}^{2}
\sin\left(\dfrac{a_{wy} \pi y}{L}\right) + 2 w_{z} a_{wz}^{2} \cos\left(\dfrac{\pi a_{wz}
z}{L}\right)\right) \right.+\\
  &\quad\left.- 2 a_{uy} a_{vx} u_{y} v_{x} \sin\left(\dfrac{a_{uy} \pi y}{L}\right)
\sin\left(\dfrac{a_{vx} \pi x}{L}\right) - 2 a_{vz} a_{wy} v_{z} w_{y} \cos\left(\dfrac{\pi a_{vz}
z}{L}\right) \cos\left(\dfrac{a_{wy} \pi y}{L}\right) \right.+\\
  &\quad\left.+ 2 a_{uz} a_{wx} u_{z} w_{x} \cos\left(\dfrac{\pi
a_{wx} x}{L}\right) \sin\left(\dfrac{a_{uz} \pi z}{L}\right) - a_{uy}^{2} u_{y}^{2}
\sin^2\left(\dfrac{a_{uy} \pi y}{L}\right) - a_{uz}^{2} u_{z}^{2} \sin^2\left(\dfrac{\pi a_{uz}
z}{L}\right) \right.+\\
  &\quad\left.- a_{vx}^{2} v_{x}^{2} \sin^2\left(\dfrac{a_{vx} \pi x}{L}\right) - a_{vz}^{2} v_{z}^{2}
\cos^2\left(\dfrac{a_{vz} \pi z}{L}\right) - a_{wx}^{2} w_{x}^{2} \cos^2\left(\dfrac{\pi a_{wx}
x}{L}\right) - a_{wy}^{2} w_{y}^{2} \cos^2\left(\dfrac{a_{wy} \pi y}{L}\right) \right.+\\
  &\quad\left.- 2 a_{ux}^{2} u_{x}^{2}
\cos^2\left(\dfrac{a_{ux} \pi x}{L}\right) - 2 a_{vy}^{2} v_{y}^{2} \cos^2\left(\dfrac{\pi a_{vy}
y}{L}\right) - 2 a_{wz}^{2} w_{z}^{2} \sin^2\left(\dfrac{a_{wz} \pi z}{L}\right)\right)+\\
%
&+ \DMuDx \frac{\pi  \U }{L}\left\{- \left(\frac{2}{3} - \alpha\right) \left(a_{wz} w_{z} \sin\left(\dfrac{a_{wz} \pi z}{L}\right) -
a_{ux} u_{x} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) - a_{vy} v_{y} \cos\left(\dfrac{\pi a_{vy}
y}{L}\right)\right) \right.+\\
  &\quad\left.- 2 a_{ux} u_{x} \cos\left(\dfrac{a_{ux} \pi x}{L}\right)\right\} +\\
%
&+ \DMuDx \frac{\pi  \V }{L}\left(a_{uy} u_{y} \sin\left(\dfrac{a_{uy} \pi y}{L}\right) + a_{vx} v_{x} \sin\left(\dfrac{\pi a_{vx}
x}{L}\right)\right) +\\
%
&+ \DMuDx \frac{\pi  \W }{L}\left(a_{uz} u_{z} \sin\left(\dfrac{a_{uz} \pi z}{L}\right) - a_{wx}
w_{x} \cos\left(\dfrac{a_{wx} \pi x}{L}\right)\right) +\\
%
&+ \DMuDy \frac{\pi  \U }{L}\left(a_{uy} u_{y}
\sin\left(\dfrac{a_{uy} \pi y}{L}\right) + a_{vx} v_{x} \sin\left(\dfrac{\pi a_{vx}
x}{L}\right)\right) +\\
%
&+ \DMuDy \frac{\pi  \V }{L} \left\{- \left(\frac{2}{3} - \alpha\right) \left(a_{wz} w_{z}
\sin\left(\dfrac{a_{wz} \pi z}{L}\right) - a_{ux} u_{x} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) -
a_{vy} v_{y} \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right) \right.+\\
  &\quad\left.- 2 a_{vy} v_{y} \cos\left(\dfrac{\pi
a_{vy} y}{L}\right)\right\} +\\
%
&+ \DMuDy \frac{\pi  \W }{L}\left(- a_{vz} v_{z} \cos\left(\dfrac{a_{vz} \pi z}{L}\right)
- a_{wy} w_{y} \cos\left(\dfrac{a_{wy} \pi y}{L}\right)\right) +\\
%
&+ \DMuDz \frac{\pi  \U }{L} \left(a_{uz} u_{z}
\sin\left(\dfrac{a_{uz} \pi z}{L}\right) - a_{wx} w_{x} \cos\left(\dfrac{\pi a_{wx}
x}{L}\right)\right)+\\
%
&+ \DMuDz \frac{\pi  \V }{L} \left(- a_{vz} v_{z} \cos\left(\dfrac{a_{vz} \pi z}{L}\right) -
a_{wy} w_{y} \cos\left(\dfrac{a_{wy} \pi y}{L}\right)\right)+\\
%
&+ \DMuDz \frac{\pi  \W }{L}\left\{- \left(\frac{2}{3} -\alpha\right) \left(a_{wz} w_{z} \sin\left(\dfrac{a_{wz} \pi z}{L}\right) - a_{ux} u_{x}
\cos\left(\dfrac{a_{ux} \pi x}{L}\right) - a_{vy} v_{y} \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right)\right.+\\
  &\quad\left.
+ 2 a_{wz} w_{z} \sin\left(\dfrac{a_{wz} \pi z}{L}\right)\right\}
 \end{split}
\end{equation*}

Again, $\Mu,\, \Rho,\,\U,\,\V,\,\W$ and $\PP$ are defined in Equation (\ref{eq:aux_01}) and the derivatives $\DMuDx,\DMuDy$ and $\DMuDz$ are given in Equation~(\ref{eq:aux_02}). The variable $\Et$ is defined according to the definition of total energy (\ref{eq:ns_04}) and it's given by:
$$\Et= \frac{\PP}{\Rho \, \left(\gamma-1\right)} + \frac{1}{2} \U^{2} + \frac{1}{2} \V^{2} + \frac{1}{2} \W^{2}.$$


Accordingly,
$$\texttt{k}=\dfrac{\gamma R \Mu}{(\gamma-1)\text{Pr}} \quad \mbox{and} \quad \lambda=\left( \alpha -\dfrac{2}{3} \right)\Mu   .$$

\subsection{Passive Transport}
Similarly to the Navier-Stokes equations, source term $Q_\phi$ for the passive transport of a generic scalar $\phi$ is obtained by writing Equation (\ref{eq:ns_pscalar}) as an operator $\Lo_\phi$:
 $$\Lo_\phi = \Lo_{\phi \, \text{time}}+\Lo_{\phi \, \convection}+\Lo_{\phi \, \text{diffusion}}$$
with each one of the sub-operators defined as follows:
\begin{equation*}
 \begin{split}
\Lo_{\phi \, \text{time}}&= \Diff{\rho\phi}{t} \\
\Lo_{\phi \, \convection}&= \Diff{\rho u \phi}{x} + \Diff{\rho v \phi}{y} + \Diff{\rho w \phi}{z}\\
\Lo_{\phi \,\text{diffusion}}&= - \Gamma \left( \diff{^2 \phi}{x^2} +\diff{^2 \phi}{y^2} + \diff{^2 \phi}{z^2} \right)
 \end{split}
\end{equation*}
%
Therefore, $$Q_\phi = Q_{\phi \, \text{time}}+Q_{\phi \, \convection}+Q_{\phi \, \text{diffusion}},$$
where:
\begin{equation}
 \begin{split}
 Q_{\phi \, \text{time}}&= 
\frac{\Phi \,  a_{\rho t} \pi \rho_{t} }{L_t}\cos\left(\frac{a_{\rho t} \pi t}{L_t}\right) - \frac{\Rho \, a_{\phi t} \pi \phi_{t} }{L_t}\sin\left(\frac{a_{\phi t} \pi t}{L_t}\right), \\
%
%
 Q_{\phi \, \text{convection}}&= 
\frac{\pi \Phi \,  \Rho \, }{L} \left[a_{ux} u_{x} \cos\left(\frac{a_{ux} \pi x}{L}\right) + a_{vy} v_{y} \cos\left(\frac{a_{vy} \pi y}{L}\right) - a_{wz} w_{z} \sin\left(\frac{a_{wz} \pi z}{L}\right)\right]+ \\ 
&+ \frac{\Phi \,  \U \, a_{\rho x} \pi \rho_{x} }{L}\cos\left(\frac{a_{\rho x} \pi x}{L}\right) - \frac{\Phi \,  \V \, a_{\rho y} \pi \rho_{y} }{L}\sin\left(\frac{a_{\rho y} \pi y}{L}\right) + \frac{\Phi \,  \W \, a_{\rho z} \pi \rho_{z} }{L}\cos\left(\frac{a_{\rho z} \pi z}{L}\right) + \\ 
&- \frac{ \Rho \, \U \, a_{\phi x} \pi\phi_{x} }{L}\sin\left(\frac{a_{\phi x} \pi x}{L}\right) - \frac{\Rho \, \V \, a_{\phi y} \pi \phi_{y} }{L}\sin\left(\frac{a_{\phi y} \pi y}{L}\right)+ \frac{\Rho \, \W \, a_{\phi z} \pi \phi_{z} }{L}\cos\left(\frac{a_{\phi z} \pi z}{L}\right) , \\
%
%
 Q_{\phi \, \text{diffusion}}&= 
\frac{\Gamma \pi^{2} }{L^2} \left[a_{\phi x}^{2} \phi_{x} \cos\left(\frac{a_{\phi x} \pi x}{L}\right) + a_{\phi y}^{2} \phi_{y} \cos\left(\frac{a_{\phi y} \pi y}{L}\right) + a_{\phi z}^{2} \phi_{z} \sin\left(\frac{a_{\phi z} \pi z}{L}\right)\right],
 \end{split}
\end{equation}
with $\Rho,\,\U,\,\V,\,\W$ and $\Phi \, $ defined in Equation (\ref{eq:aux_01}).

\section{Hierarchic MMS}

The complexity, and consequently length, of the source terms increase with both dimension and physics handled by the governing equations. In some cases, such as the 3D energy equation, the final expression for $Q_{e_t}$ may reach 40,800 characters, including parenthesis and mathematical operators, prior to factorization.

Applying commands in order to simplify such extensive expression is challenging even with a very good machine; thus, a suitable alternative to this issue is to simplify the equation by dividing it into a combination of sub-operators handling different physical phenomena. Then, each one of the operators may be applied to the manufactured solutions individually, and the resulting sub-source terms are combined back to represent the source term for the original equation.



For instance, instead of writing the three-dimensional Navier-Stokes energy equation using one single operator~$\Lo$:
\begin{equation}
 \label{eq:ns2d_04}
\begin{split}
\Lo= \Diff{\rho e_t}{t}&+\nabla \cdot (\rho\bv{u}e_t) +\nabla\cdot \bv{q} +  \nabla\cdot(p  \bv{u})  - \nabla \cdot (\bv{\tau} \cdot \bv{u}),
%\Diff{\rho e_t}{t}& + \nabla \cdot (\rho \bv{u} H)+\nabla\cdot \bv{q} - \nabla \cdot (\bv{\tau u})
\end{split}
\end{equation}
to then be used in the MMS, let Equation (\ref{eq:ns2d_04}) be written with five operators, according to their physical meaning:
\begin{equation}
 \begin{split}\label{sub01}
  \Lo_{\text{time}}&=\Diff{\rho e_t}{t} ,\\
  \Lo_{\convection}&=\nabla \cdot (\rho\bv{u}e_t),\\
  \Lo_{\heatflux}&=\nabla\cdot \bv{q},\\
  \Lo_{\gradp}&= \nabla\cdot(p  \bv{u}),\\
  \Lo_{\viscous}&=- \nabla \cdot (\bv{\tau} \cdot \bv{u}),
 \end{split}
\end{equation}
where $\Lo_{\text{time}}$ denotes the rate of accumulation of inertial and kinetic energy, $\Lo_{\convection}$ is the net rate of internal and kinetic energy increase by convection, $\Lo_{\heatflux}$ is the net rate of heat addition due to heat conduction, $\Lo_{\gradp}$ is the rate of work done on the fluid by external body forces, and $\Lo_{\viscous}$ is the rate of work done on the fluid by viscous forces. Naturally:
$$\Lo=\Lo_{\text{time}}+\Lo_{\convection}+\Lo_{\heatflux}+\Lo_{\gradp}+\Lo_{\viscous}.$$

After the application of each sub-operator defined in (\ref{sub01}), the corresponding sub-source terms are also simplified, factorized and sorted. Then, the final factorized version is checked against the original one, in order to assure that no human error has been introduced.

An advantage of this strategy is the possibility of inclusion and/or removal of other physical effects without the need of re-doing previous manipulations. For instance, in order to simplify this model by considering constant viscosity, changes should be made only in operator  $\Lo_{\viscous}$, in the total energy and momentum equations; the other terms on such equations, the continuity equation and the equation for the transport of the scalar all remain the same. 

This strategy, named ``Hierarchic MMS'', results in less time spent in the manipulations, decreases the computational effort and occasional software crashes, and also increases the flexibility in the code verification procedure.




\subsection{Boundary Conditions}
Additionally to verifying code capability of solving the governing equations accurately in the interior of the domain of interest, one may also verify the software capability of correctly imposing boundary conditions. Therefore, the gradients of the  analytical solutions (\ref{eq:manufactured01}) have been calculated and translated into $C$ codes. For the 3D case, they are:
\begin{equation*}
\nabla  \rho= \left[ \begin{array}{c}
 \dfrac{  a_{\rho x}  \pi \rho_x}{L} \cos\left( \dfrac{ a_{\rho x}  \pi  x}{L}\right)\vspace{5pt} \\
-\dfrac{  a_{\rho y}  \pi \rho_y}{L} \sin\left( \dfrac{ a_{\rho y}  \pi  y}{L}\right)\vspace{5pt}\\
 \dfrac{  a_{\rho z}  \pi \rho_z}{L}  \cos\left( \dfrac{ a_{\rho z}  \pi  z}{L}\right)
\end{array} \right],
\qquad
\nabla p = \left[ \begin{array}{c}
- \dfrac{  a_{px}  \pi p_x}{L} \sin\left( \dfrac{ a_{px}  \pi  x}{L}\right)\vspace{5pt}\\
  \dfrac{  a_{py}  \pi p_y}{L} \cos\left( \dfrac{ a_{py}  \pi  y}{L}\right) \vspace{5pt}\\
- \dfrac{  a_{pz}  \pi p_z}{L} \sin\left( \dfrac{ a_{pz}  \pi  z}{L}\right)
\end{array} \right],
\quad
\nabla \phi = \left[ \begin{array}{c} 
- \dfrac{a_{\phi x} \pi  \phi_{x} }{L}\sin\left(\dfrac{a_{\phi x} \pi  x}{L}\right)\vspace{5pt}\\
- \dfrac{a_{\phi y} \pi  \phi_{y} }{L}\sin\left(\dfrac{a_{\phi y} \pi  y}{L}\right)\vspace{5pt}\\ 
  \dfrac{a_{\phi z} \pi  \phi_{z} }{L}\cos\left(\dfrac{a_{\phi z} \pi  z}{L}\right)
\end{array} \right],
\end{equation*}
%
\begin{equation*}
\nabla u = \left[ \begin{array}{c}
  \dfrac{  a_{ux}  \pi u_x}{L} \cos\left( \dfrac{ a_{ux}  \pi  x}{L}\right)\vspace{5pt}\\
 -   \dfrac{  a_{uy}  \pi u_y}{L} \sin\left( \dfrac{ a_{uy}  \pi  y}{L}\right)\vspace{5pt}\\
 -   \dfrac{  a_{uz}  \pi u_z}{L} \sin\left( \dfrac{ a_{uz}  \pi  z}{L}\right)
\end{array} \right],
\quad
\nabla  v= \left[ \begin{array}{c}
-  \dfrac{  a_{vx}  \pi v_x}{L}  \sin\left( \dfrac{ a_{vx}  \pi  x}{L}\right)\vspace{5pt}\\
    \dfrac{  a_{vy}  \pi v_y}{L} \cos\left( \dfrac{ a_{vy}  \pi  y}{L}\right)\vspace{5pt}\\
   \dfrac{  a_{vz}  \pi v_z }{L} \cos\left( \dfrac{ a_{vz}  \pi  z}{L}\right)
\end{array} \right]
\quad\mbox{and}\quad
\nabla w = \left[ \begin{array}{c}
\dfrac{  a_{wx}  \pi  w_x}{L} \cos\left( \dfrac{ a_{wx}  \pi  x}{L}\right)\vspace{5pt}\\
  \dfrac{  a_{wy}  \pi w_y}{L}  \cos\left( \dfrac{ a_{wy}  \pi  y}{L}\right)\vspace{5pt} \\
 - \dfrac{  a_{wz}  \pi w_z}{L}  \sin\left( \dfrac{ a_{wz}  \pi  z}{L}\right)
\end{array} \right].
\end{equation*}

$$$$

\subsection{C Files}

The translation of the manufactured solutions, their gradients and all the auxiliary relations into C code is presented in the file \texttt{NS\_Power Law\_scalar\_transient\_manuf\_solutions\_gradients.c}. Files containing $C$ codes for the source terms have also been automatically generated. They are: \texttt{NS\_Power Law\_transient\_scalar\_3d\_e.c, NS\_Power Law\_scalar\_transient\_3d\_u.c, NS\_Power Law\_scalar\_transient\_3d\_v.c,\\ NS\_Power Law\_scalar\_transient\_3d\_w.c, NS\_Power Law\_scalar\_transient\_3d\_rho.c } and\\ \texttt{NS\_Power Law\_scalar\_transient\_3d\_phi.c.}

An example of the automatically generated $C$ file from the source term for the 3D total energy source term $Q_{e_t}$~is:

\begin{footnotesize}
\begin{verbatim}
/****************************************************************************** 
 *                      Code generated with sympy 0.6.7                       * 
 *                                                                            * 
 *              See http://www.sympy.org/ for more information.               * 
 *                                                                            * 
 *                       This file is part of 'project'                       * 
 ******************************************************************************/

#include "NS_Power Law_scalar_transient_3d_e.h"
#include <math.h>

double Rho(double L, double Lt, double a_rhot, double a_rhox, double a_rhoy, double a_rhoz, double rho_0, double rho_t, 
  double rho_x, double rho_y, double rho_z, double t, double x, double y, double z) {
  return rho_0 + rho_t*sin(M_PI*a_rhot*t/Lt) + rho_x*sin(M_PI*a_rhox*x/L) + rho_y*cos(M_PI*a_rhoy*y/L) 
	+ rho_z*sin(M_PI*a_rhoz*z/L);
}

double U(double L, double Lt, double a_ut, double a_ux, double a_uy, double a_uz, double t, double u_0, double u_t, 
  double u_x, double u_y, double u_z, double x, double y, double z) {
  return u_0 + u_t*cos(M_PI*a_ut*t/Lt) + u_x*sin(M_PI*a_ux*x/L) + u_y*cos(M_PI*a_uy*y/L) + u_z*cos(M_PI*a_uz*z/L);
}

double V(double L, double Lt, double a_vt, double a_vx, double a_vy, double a_vz, double t, double v_0, double v_t, 
  double v_x, double v_y, double v_z, double x, double y, double z) {
  return v_0 + v_t*sin(M_PI*a_vt*t/Lt) + v_x*cos(M_PI*a_vx*x/L) + v_y*sin(M_PI*a_vy*y/L) + v_z*sin(M_PI*a_vz*z/L);
}

double W(double L, double Lt, double a_wt, double a_wx, double a_wy, double a_wz, double t, double w_0, 
  double w_t, double w_x, double w_y, double w_z, double x, double y, double z) {
  return w_0 + w_t*cos(M_PI*a_wt*t/Lt) + w_x*sin(M_PI*a_wx*x/L) + w_y*sin(M_PI*a_wy*y/L) + w_z*cos(M_PI*a_wz*z/L);
}

double P(double L, double Lt, double a_pt, double a_px, double a_py, double a_pz, double p_0, double p_t, 
  double p_x, double p_y, double p_z, double t, double x, double y, double z) {
  return p_0 + p_t*cos(M_PI*a_pt*t/Lt) + p_x*cos(M_PI*a_px*x/L) + p_y*sin(M_PI*a_py*y/L) + p_z*cos(M_PI*a_pz*z/L);
}

double T(double P, double R, double Rho) {
  return P/(R*Rho);
}

double E_t(double P, double Rho, double U, double V, double W, double gamma) {
  return -P/(Rho*(1 - gamma)) + pow(U,2)/2 + pow(V,2)/2 + pow(W,2)/2;
}

double A_mu(double B_mu, double T_ref, double mu_ref) {
  return mu_ref*pow(T_ref,-1.5)*(B_mu + T_ref);
}

double Mu(double A_mu, double B_mu, double T) {
  return A_mu*pow(T,1.5)/(B_mu + T);
}

double DMu_Dx(double A_mu, double B_mu, double L, double R, double Rho, double T, double a_px, double a_rhox, 
  double p_x, double rho_x, double x) {
  return A_mu*pow(T,0.5)*(-1.5*M_PI*T*a_rhox*rho_x*cos(M_PI*a_rhox*x/L)/(L*Rho) 
	- 1.5*M_PI*a_px*p_x*sin(M_PI*a_px*x/L)/(L*R*Rho))/(B_mu + T) 
	+ A_mu*pow(T,1.5)*(M_PI*T*a_rhox*rho_x*cos(M_PI*a_rhox*x/L)/(L*Rho) 
	+ M_PI*a_px*p_x*sin(M_PI*a_px*x/L)/(L*R*Rho))/pow((B_mu + T),2);
}

double DMu_Dy(double A_mu, double B_mu, double L, double R, double Rho, double T, double a_py, double a_rhoy, 
  double p_y, double rho_y, double y) {
  return A_mu*pow(T,0.5)*(1.5*M_PI*T*a_rhoy*rho_y*sin(M_PI*a_rhoy*y/L)/(L*Rho) 
	+ 1.5*M_PI*a_py*p_y*cos(M_PI*a_py*y/L)/(L*R*Rho))/(B_mu + T) 
	+ A_mu*pow(T,1.5)*(-M_PI*T*a_rhoy*rho_y*sin(M_PI*a_rhoy*y/L)/(L*Rho) 
	- M_PI*a_py*p_y*cos(M_PI*a_py*y/L)/(L*R*Rho))/pow((B_mu + T),2);
}

double DMu_Dz(double A_mu, double B_mu, double L, double R, double Rho, double T, double a_pz, double a_rhoz, 
double p_z, double rho_z, double z) {
  return A_mu*pow(T,0.5)*(-1.5*M_PI*T*a_rhoz*rho_z*cos(M_PI*a_rhoz*z/L)/(L*Rho) 
	- 1.5*M_PI*a_pz*p_z*sin(M_PI*a_pz*z/L)/(L*R*Rho))/(B_mu + T) 
	+ A_mu*pow(T,1.5)*(M_PI*T*a_rhoz*rho_z*cos(M_PI*a_rhoz*z/L)/(L*Rho) 
	+ M_PI*a_pz*p_z*sin(M_PI*a_pz*z/L)/(L*R*Rho))/pow((B_mu + T),2);
}

double kappa(double Mu, double Pr, double R, double gamma) {
  return -Mu*R*gamma/(Pr*(1 - gamma));
}

double Q_et_convection(double E_t, double L, double P, double Rho, double U, double V, double W, double a_px, 
  double a_py, double a_pz, double a_rhox, double a_rhoy, double a_rhoz, double a_ux, double a_uy, double a_uz, 
  double a_vx, double a_vy, double a_vz, double a_wx, double a_wy, double a_wz, double gamma, double p_x, double p_y, 
  double p_z, double rho_x, double rho_y, double rho_z, double u_x, double u_y, double u_z, double v_x, double v_y, 
  double v_z, double w_x, double w_y, double w_z, double x, double y, double z) {
  return M_PI*Rho*(a_ux*u_x*pow(U,2)*cos(M_PI*a_ux*x/L) + a_vy*v_y*pow(V,2)*cos(M_PI*a_vy*y/L) 
	- a_wz*w_z*pow(W,2)*sin(M_PI*a_wz*z/L) + U*W*a_wx*w_x*cos(M_PI*a_wx*x/L) + V*W*a_vz*v_z*cos(M_PI*a_vz*z/L) 
	+ V*W*a_wy*w_y*cos(M_PI*a_wy*y/L) - U*V*a_uy*u_y*sin(M_PI*a_uy*y/L) - U*V*a_vx*v_x*sin(M_PI*a_vx*x/L) 
	- U*W*a_uz*u_z*sin(M_PI*a_uz*z/L))/L + M_PI*(U*a_px*p_x*sin(M_PI*a_px*x/L) + W*a_pz*p_z*sin(M_PI*a_pz*z/L) 
	- V*a_py*p_y*cos(M_PI*a_py*y/L))/(L*(1 - gamma)) + M_PI*E_t*Rho*(a_ux*u_x*cos(M_PI*a_ux*x/L) 
	+ a_vy*v_y*cos(M_PI*a_vy*y/L) - a_wz*w_z*sin(M_PI*a_wz*z/L))/L 
	+ M_PI*a_rhox*rho_x*(E_t*U + P*U/(Rho*(1 - gamma)))*cos(M_PI*a_rhox*x/L)/L 
	+ M_PI*a_rhoy*rho_y*(-E_t*V - P*V/(Rho*(1 - gamma)))*sin(M_PI*a_rhoy*y/L)/L 
	+ M_PI*a_rhoz*rho_z*(E_t*W + P*W/(Rho*(1 - gamma)))*cos(M_PI*a_rhoz*z/L)/L;
}

double Q_et_gradp(double L, double P, double U, double V, double W, double a_px, double a_py, double a_pz, 
  double a_ux, double a_vy, double a_wz, double p_x, double p_y, double p_z, double u_x, double v_y, double w_z, 
  double x, double y, double z) {
  return M_PI*P*(a_ux*u_x*cos(M_PI*a_ux*x/L) + a_vy*v_y*cos(M_PI*a_vy*y/L) - a_wz*w_z*sin(M_PI*a_wz*z/L))/L 
	+ M_PI*V*a_py*p_y*cos(M_PI*a_py*y/L)/L - M_PI*U*a_px*p_x*sin(M_PI*a_px*x/L)/L - M_PI*W*a_pz*p_z*sin(M_PI*a_pz*z/L)/L;
}

double Q_et_viscous(double DMu_Dx, double DMu_Dy, double DMu_Dz, double L, double Mu, double U, double V, double W, 
  double a_ux, double a_uy, double a_uz, double a_vx, double a_vy, double a_vz, double a_wx, double a_wy, double a_wz, 
  double u_x, double u_y, double u_z, double v_x, double v_y, double v_z, double w_x, double w_y, double w_z, double x, 
  double y, double z) {
  return Mu*pow(M_PI,2)*(U*(u_y*pow(a_uy,2)*cos(M_PI*a_uy*y/L) + u_z*pow(a_uz,2)*cos(M_PI*a_uz*z/L) 
	+ 4*u_x*pow(a_ux,2)*sin(M_PI*a_ux*x/L)/3) + V*(v_x*pow(a_vx,2)*cos(M_PI*a_vx*x/L) + v_z*pow(a_vz,2)*sin(M_PI*a_vz*z/L) 
	+ 4*v_y*pow(a_vy,2)*sin(M_PI*a_vy*y/L)/3) + W*(w_x*pow(a_wx,2)*sin(M_PI*a_wx*x/L) + w_y*pow(a_wy,2)*sin(M_PI*a_wy*y/L) 
	+ 4*w_z*pow(a_wz,2)*cos(M_PI*a_wz*z/L)/3) - 2*a_uy*a_vx*u_y*v_x*sin(M_PI*a_uy*y/L)*sin(M_PI*a_vx*x/L) 
	- 2*a_vz*a_wy*v_z*w_y*cos(M_PI*a_vz*z/L)*cos(M_PI*a_wy*y/L) + 2*a_uz*a_wx*u_z*w_x*cos(M_PI*a_wx*x/L)*sin(M_PI*a_uz*z/L) 
	- 4*a_ux*a_wz*u_x*w_z*cos(M_PI*a_ux*x/L)*sin(M_PI*a_wz*z/L)/3 - 4*a_vy*a_wz*v_y*w_z*cos(M_PI*a_vy*y/L)*sin(M_PI*a_wz*z/L)/3 
	+ 4*a_ux*a_vy*u_x*v_y*cos(M_PI*a_ux*x/L)*cos(M_PI*a_vy*y/L)/3 - pow(a_uy,2)*pow(u_y,2)*pow(sin(M_PI*a_uy*y/L),2) 
	- pow(a_uz,2)*pow(u_z,2)*pow(sin(M_PI*a_uz*z/L),2) - pow(a_vx,2)*pow(v_x,2)*pow(sin(M_PI*a_vx*x/L),2) 
	- pow(a_vz,2)*pow(v_z,2)*pow(cos(M_PI*a_vz*z/L),2) - pow(a_wx,2)*pow(w_x,2)*pow(cos(M_PI*a_wx*x/L),2) 
	- pow(a_wy,2)*pow(w_y,2)*pow(cos(M_PI*a_wy*y/L),2) - 4*pow(a_ux,2)*pow(u_x,2)*pow(cos(M_PI*a_ux*x/L),2)/3 
	- 4*pow(a_vy,2)*pow(v_y,2)*pow(cos(M_PI*a_vy*y/L),2)/3 - 4*pow(a_wz,2)*pow(w_z,2)*pow(sin(M_PI*a_wz*z/L),2)/3)/pow(L,2) 
	+ M_PI*DMu_Dx*U*(-4*a_ux*u_x*cos(M_PI*a_ux*x/L)/3 - 2*a_wz*w_z*sin(M_PI*a_wz*z/L)/3 + 2*a_vy*v_y*cos(M_PI*a_vy*y/L)/3)/L 
	+ M_PI*DMu_Dx*V*(a_uy*u_y*sin(M_PI*a_uy*y/L) + a_vx*v_x*sin(M_PI*a_vx*x/L))/L + M_PI*DMu_Dx*W*(a_uz*u_z*sin(M_PI*a_uz*z/L) 
	- a_wx*w_x*cos(M_PI*a_wx*x/L))/L + M_PI*DMu_Dy*U*(a_uy*u_y*sin(M_PI*a_uy*y/L) + a_vx*v_x*sin(M_PI*a_vx*x/L))/L 
	+ M_PI*DMu_Dy*V*(-4*a_vy*v_y*cos(M_PI*a_vy*y/L)/3 - 2*a_wz*w_z*sin(M_PI*a_wz*z/L)/3 + 2*a_ux*u_x*cos(M_PI*a_ux*x/L)/3)/L 
	+ M_PI*DMu_Dy*W*(-a_vz*v_z*cos(M_PI*a_vz*z/L) - a_wy*w_y*cos(M_PI*a_wy*y/L))/L + M_PI*DMu_Dz*U*(a_uz*u_z*sin(M_PI*a_uz*z/L) 
	- a_wx*w_x*cos(M_PI*a_wx*x/L))/L + M_PI*DMu_Dz*V*(-a_vz*v_z*cos(M_PI*a_vz*z/L) - a_wy*w_y*cos(M_PI*a_wy*y/L))/L 
	+ M_PI*DMu_Dz*W*(2*a_ux*u_x*cos(M_PI*a_ux*x/L)/3 + 2*a_vy*v_y*cos(M_PI*a_vy*y/L)/3 + 4*a_wz*w_z*sin(M_PI*a_wz*z/L)/3)/L;
}

double Q_et_heatflux(double DMu_Dx, double DMu_Dy, double DMu_Dz, double L, double P, double Pr, double R, double Rho, 
  double a_px, double a_py, double a_pz, double a_rhox, double a_rhoy, double a_rhoz, double gamma, double kappa, 
  double p_x, double p_y, double p_z, double rho_x, double rho_y, double rho_z, double x, double y, double z) {
  return kappa*pow(M_PI,2)*(p_x*pow(a_px,2)*cos(M_PI*a_px*x/L) + p_y*pow(a_py,2)*sin(M_PI*a_py*y/L) 
	+ p_z*pow(a_pz,2)*cos(M_PI*a_pz*z/L))/(pow(L,2)*R*Rho) 
	+ kappa*pow(M_PI,2)*(-2*a_px*a_rhox*p_x*rho_x*cos(M_PI*a_rhox*x/L)*sin(M_PI*a_px*x/L) 
	- 2*a_py*a_rhoy*p_y*rho_y*cos(M_PI*a_py*y/L)*sin(M_PI*a_rhoy*y/L) 
	- 2*a_pz*a_rhoz*p_z*rho_z*cos(M_PI*a_rhoz*z/L)*sin(M_PI*a_pz*z/L))/(pow(L,2)*R*pow(Rho,2)) 
	+ P*kappa*pow(M_PI,2)*(-2*pow(a_rhox,2)*pow(rho_x,2)*pow(cos(M_PI*a_rhox*x/L),2) 
	- 2*pow(a_rhoy,2)*pow(rho_y,2)*pow(sin(M_PI*a_rhoy*y/L),2) 
	- 2*pow(a_rhoz,2)*pow(rho_z,2)*pow(cos(M_PI*a_rhoz*z/L),2))/(pow(L,2)*R*pow(Rho,3)) 
	+ P*kappa*pow(M_PI,2)*(-rho_x*pow(a_rhox,2)*sin(M_PI*a_rhox*x/L) 
	- rho_y*pow(a_rhoy,2)*cos(M_PI*a_rhoy*y/L) - rho_z*pow(a_rhoz,2)*sin(M_PI*a_rhoz*z/L))/(pow(L,2)*R*pow(Rho,2)) 
	+ M_PI*DMu_Dy*a_py*gamma*p_y*cos(M_PI*a_py*y/L)/(L*Pr*Rho*(1 - gamma)) 
	- M_PI*DMu_Dx*a_px*gamma*p_x*sin(M_PI*a_px*x/L)/(L*Pr*Rho*(1 - gamma)) 
	- M_PI*DMu_Dz*a_pz*gamma*p_z*sin(M_PI*a_pz*z/L)/(L*Pr*Rho*(1 - gamma)) 
	+ M_PI*DMu_Dy*P*a_rhoy*gamma*rho_y*sin(M_PI*a_rhoy*y/L)/(L*Pr*pow(Rho,2)*(1 - gamma)) 
	- M_PI*DMu_Dx*P*a_rhox*gamma*rho_x*cos(M_PI*a_rhox*x/L)/(L*Pr*pow(Rho,2)*(1 - gamma)) 
	- M_PI*DMu_Dz*P*a_rhoz*gamma*rho_z*cos(M_PI*a_rhoz*z/L)/(L*Pr*pow(Rho,2)*(1 - gamma));
}


double Q_et_time(double E_t, double Lt, double P, double Rho, double U, double V, double W, double a_pt, double a_rhot, 
  double a_ut, double a_vt, double a_wt, double gamma, double p_t, double rho_t, double t, double u_t, double v_t, 
  double w_t) {
  return M_PI*Rho*(V*a_vt*v_t*cos(M_PI*a_vt*t/Lt) - U*a_ut*u_t*sin(M_PI*a_ut*t/Lt) 
	- W*a_wt*w_t*sin(M_PI*a_wt*t/Lt))/Lt + M_PI*E_t*a_rhot*rho_t*cos(M_PI*a_rhot*t/Lt)/Lt 
	+ M_PI*a_pt*p_t*sin(M_PI*a_pt*t/Lt)/(Lt*(1 - gamma)) 
	+ M_PI*P*a_rhot*rho_t*cos(M_PI*a_rhot*t/Lt)/(Lt*Rho*(1 - gamma));
}

double Q_et(double Q_et_convection, double Q_et_gradp, double Q_et_heatflux, double Q_et_time, double Q_et_viscous) {
  return Q_et_convection + Q_et_gradp + Q_et_heatflux + Q_et_time + Q_et_viscous;
}


\end{verbatim}
\end{footnotesize}
%---------------------------------------------------------------------------------------------------------
\bibliographystyle{chicago} 
\bibliography{/home/kemelli/MMS_maple_workplace/MMS_bib}


\appendix

\input{list_of_variables}

\end{document}

