\documentclass[10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath,amsfonts}
\usepackage{geometry}
\geometry{ top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm}
\usepackage[authoryear]{natbib}
\usepackage{pdflscape}
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm, right=2cm}

\newcommand{\D}{\partial}
\newcommand{\Diff}[2] {\dfrac{\partial( #1)}{\partial #2}}
\newcommand{\diff}[2] {\dfrac{\partial #1 }{\partial #2}}
\newcommand{\gv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}% for vectors of Greek letters
\newcommand{\grad}[1]{\gv{\nabla} #1}
\newcommand{\bv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}
\newcommand{\bt}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}

%opening
\title{Manufactured Solution for 1D compressible Euler equations for hypersonic flows with Nitrogen dissociation using Maple\footnote{Work based on \citet*{Roy2002,Kirk2009}.}}
\author{Kemelli C. Estacio-Hiroms}

\begin{document}

\maketitle

\begin{abstract}
The Method of Manufactured Solutions is a valuable approach for code verification, providing means to verify how accurately the numerical method solves the equations of interest. The method generates a related set of governing equations by applying the differential operator for the governing equations to an analytical solution chosen \textit{a priori} to generate source terms, which are added the RHS of the original set of equations. Then, the modified set of equations may be discretized and solved numerically, so its solution may be compared to the exact solution. A choice of analytical solutions for the flow variables of the 1D Compressible Euler equations for chemically reacting hypersonic flows and their respective source terms are presented in this document.
\end{abstract}




\section{1D Euler Equations}
The conservation of mass, momentum, and total energy for a compressible fluid composed of a chemically reacting mixture of gases N and N$_2$ in thermal nonequilibrium may be written as:
\begin{align}
 \label{eq:pde_comp_mass_N}
 \diff{\rho_{\text{N}}}{t} &+ \Diff{\rho_{\text{N}} u }{x} = \dot{\omega}_{\text{N}}, \\
\label{eq:pde_comp_mass_N2}
 \diff{\rho_{\text{N}_2}}{t} &+ \Diff{\rho_{\text{N}_2} u }{x} = \dot{\omega}_{\text{N}_2} ,\\
 \label{eq:pde_comp_mom}
 \diff{\rho u }{t} &+ \Diff{\rho u^2}{x} = -\grad{p} ,\\
 \label{eq:pde_comp_energy}
 \diff{\rho E}{t} &+ \Diff{\rho  u  H}{x}= 0,
\end{align}
where $\rho_s$ is the density of species $s$ (N or N$_2$), $\rho=\sum_s \rho_s$ is the mixture density, $ u $ is the mixture velocity, $E$ is the total energy per unit mass, and $p$ is the pressure.

Although Park's model \citep{Park1990}, a well established approach, involves an extra temperature equation due to vibrational/electronic energy, in the present work such effects are neglected; thus only one temperature equation (\ref{eq:pde_comp_energy}) is considered.

The total enthalpy, $H$, may be expressed in terms of the total energy, density, and pressure:
$$H = E + \dfrac{p}{\rho},$$
and the total energy, $E$, is composed of internal and kinetic components: $$E = e^{\text{int}} + \dfrac{ u^2 }{2},$$
where, the total internal energy, $e^{\text{int}}$, has contribution from each of the distinct energy \emph{modes}:% - translational, rotational, vibrational and electronic. Specifically
\begin{align}
 e^{\text{int}} &= e^{\text{trans}} + e^{\text{rot}} + e^{\text{vib}} + e^{\text{elec}} + h^0 \\
 &= \sum_{s=1}^{ns} c_s e^{\text{trans}}_s + \sum_{s=mol} c_s e^{\text{rot}}_s + \sum_{s=mol} c_s e^{\text{vib}}_s + \sum_{s=1}^{ns} c_s e^{\text{elec}}_s + \sum_{s=1}^{ns} c_s h^0_s ,
\label{eq:energy_partition}
\end{align}
where $c_s=\left(\rho_s/\rho\right)$ is the mass fraction of species $s$. 
The first four terms on the right of Equation~\eqref{eq:energy_partition} represent the energy due to molecular/atomic translation, molecular rotation, molecular vibration, and electronic excitation. The final term is the heat of formation of the mixture and accounts for the energy stored in chemical bonds \citep{Ait1996,Kirk2009}.

Under the approximation that the translational and rotational states of the may be assumed fully populated, translational/rotational energy for each species may be expressed as:
\begin{equation}
 \label{eq:e_tr_combined}
 e^{\text{trans}}_s + e^{\text{rot}}_s = e^{\text{tr}}_s = C^{\text{tr}}_{v,s}\, T ,
\end{equation}
where the translational/rotational specific heat, $C^{\text{tr}}_{v,s}$ is given by
\begin{equation}
 C^{\text{tr}}_{v,s} =
 \begin{cases}
 \frac{5}{2} R_s & \text{for molecules}, \\
 \frac{3}{2} R_s & \text{for atoms.}
 \end{cases}
\end{equation}
where $R_s$ is the species gas constant, and $R_s = R/M_s$ where $R$ is the universal gas constant and $M_s$ is the species molar mass. The combined term $e^{\text{tr}}_s$ in Equation~\eqref{eq:e_tr_combined} represents the energy due to random thermal translational/rotational motion of a given species.

Moreover, recalling that the vibrational and electronic energy terms have been neglected, the internal energy is given by:
\begin{equation}
 \label{eq:rE-T-Tv-relationship}
 e^{\text{int}} = \sum_{s=1}^{ns} \rho_s C^{\text{tr}}_{v,s} T + \sum_{s=1}^{ns} \rho_s h^0_s .
\end{equation}


Regardless of the thermal state of the mixture, once the translational/rotational temperature $T$ is determined the thermodynamic pressure of the mixture is readily obtained from Dalton's law of partial pressures:
\begin{equation}
 p = \sum_{s=1}^{ns} p_s = \sum_{s=1}^{ns} \rho_s R_s T .
 \label{eq:p_eq_state}
\end{equation}


\subsection{Chemical Kinetics}
The rate of production/destruction of the individual species, $\dot{\omega}_s$, is required to close the species continuity equations. For the dissociating Nitrogen flow ($  \text{N}_2 \rightleftharpoons 2 \text{N}$) case, let us consider the chemical reactions which occur among the five principal components of dissociating air -- $\text{N}_2,\text{O}_2,\text{NO},\text{N},\text{O}$ -- but neglecting three species in order to perform this 2--species problem. For this mixture, the chemical reaction that occur is:
\begin{align*}
 \text{N}_2 + \mathcal{M} &\rightleftharpoons 2\text{N} + \mathcal{M} 
\end{align*}

This reaction can occur in either the forward or backward direction, as denoted by the bidirectional arrow. The reaction is presented such that they are endothermic in the forward direction, and $\mathcal{M}$ denotes a generic collision partner, which may be any of the species present in the flow, and  is unaltered by the reaction~\citep{Kirk2009}.
The rate of each reaction is therefore a sum of the forward and backward rates,  $k_{f}$ and $k_{b}$:
\begin{align*}
 \mathcal{R}_1 &= \sum_{m\in\mathcal{M}}\left(k_{b_1 m} \frac{\rho_{\text{N}}}{M_{\text{N}}}\frac{\rho_{\text{N}}}{M_{\text{N}}}\frac{\rho_{\text{m}}}{M_{\text{m}}} - k_{f_1 m}\frac{\rho_{\text{N}_2}}{M_{\text{N}_2}}\frac{\rho_{\text{m}}}{M_{\text{m}}} \right) \\
%
&= k_{b_1 \text{N}} \dfrac{\rho_{\text{N}}^3}{M_\text{N}^3} -
k_{f_1 \text{N}}   \dfrac{\rho_{\text{N}_2} \rho_{\text{N}}}{2  M_\text{N}^2}+
k_{b_1 \text{N}_2} \dfrac{\rho_\text{N}^2 \rho_{\text{N}_2}}{2M_\text{N}^3 }-
k_{f_1 \text{N}_2} \dfrac{\rho_{\text{N}_2}^2}{4 M_\text{N}^2}.
\end{align*}
recalling that $M_{\text{N}_2}=2 M_\text{N}.$


The species source terms \begin{equation}
  \dot{\omega}_s = M_s \sum_{r=1}^{nr}\left(\alpha_{sr}-\beta_{sr}\right)\left(\mathcal{R}_{br} - \mathcal{R}_{fr}\right)
\end{equation}
where $\alpha_{sr}$ and $\beta_{sr}$ are the stoichiometric coefficients for reactants and products of species $s$ and where $nr$ is the number of reactions can now be expressed in terms of the individual reaction rates as follows:
\begin{align*}
 \dot{\omega}_{\text{N}_2} &= M_{\text{N}_2}\left(\mathcal{R}_1\right)= 2 M_\text{N} \mathcal{R}_1 ,\\
 \dot{\omega}_{\text{N}} &= M_{\text{N}}\left(-2\mathcal{R}_1 \right)=-2 M_\text{N} \mathcal{R}_1. 
\end{align*}

Note that these source terms sum identically to zero, as required by conservation of mass.

\section{Manufactured Solution}

\citet{Roy2002} propose the general form of the primitive solution variables to be a function of sines and cosines:
\begin{equation}
 \label{eq:manufactured01}
 \phi (x,y) = \phi_0+ \phi_x f_s\left(\frac{a_{\phi x} \pi x}{L}\right) ,
\end{equation}
where $\phi=\rho_{\text{N}},\rho_{\text{N}_2}, u$ or $p$, and $f_s(\cdot)$ functions denote either sine or cosine function. Note that in this case, $\phi_x$ is constant and the subscript does not denote differentiation.

Therefore, the manufactured analytical solution for for each one of the variables in Euler equations are:
\begin{equation}
\begin{split}
\label{eq:manufactured02}
\rho_{\text{N}}(x) &= \rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right),\\
\rho_{\text{N}_2}(x) &= \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right),\\
u(x) &= u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right),\\
p(x) &= p_{0}+p_{x} \cos\left(\frac{a_{p x} \pi x}{L}\right).\\
\end{split}
\end{equation}

Recalling that $\rho=\sum_s \rho_s$, the manufactured analytical solution for the density of the mixture  is:
\begin{equation}
\label{eq:manufactured03}
\begin{split}
\rho(x) &= \rho_{\text{N}}+\rho_{\text{N}_2}\\
                     &= \rho_{\text{N}0} + \rho_{\text{N}_2 0} +
\rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right) + \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right) .
\end{split}
\end{equation}




\citet{Roy2002} present the constants used in the manufactured solutions for the 2D supersonic and subsonic cases, together with the source term for the 2D mass conservation equation. The resulting source terms for the 1D Euler flow with Nitrogen dissociation described by Equations (\ref{eq:pde_comp_mass_N}) -- (\ref{eq:pde_comp_energy}) are obtained through symbolic manipulation using the software Maple and are presented in the following sections.

%The governing equations (\ref{eq:euler2d_01}) -- (\ref{eq:euler2d_07}) are applied to the solutions in {\ref{eq:manufactured02}} using Maple and the resulting analytical source term are presented in the following sections.

\section{Euler mass conservation equation for Nitrogen atom}

The mass conservation equation for Nitrogen atom (N), written as an operator, is:
\begin{equation}
 \label{eq:euler1d_11}
L= \diff{\rho_\text{N}}{t} + \diff{\rho_\text{N} u}{x} - \dot{\omega}_{\text{N}}
\end{equation}

Analytically differentiating Equation (\ref{eq:manufactured02}) for $\rho_{\text{N}}$,  and $u$ using operator $L$ defined above together with suitable substitution for source term~$\dot{\omega}_\text{N}$ gives the source term $Q_{\rho_{\text{N}}}$:

\begin{equation}
\begin{split}
Q_{\rho_\text{N}} &= \dfrac{a_{ \rho \text{N} x } \pi \rho_{\text{N}x} }{L} \cos\left( \dfrac{a_{ \rho \text{N} x } \pi x}{L}\right) \left[u_0+u_x \sin\left( \dfrac{a_{ux} \pi x}{L}\right)\right] + \\
&+ \dfrac{ a_{ux} \pi u_x}{L}\cos\left( \dfrac{a_{ux} \pi x}{L}\right) \left[\rho_{\text{N}0}+\rho_{\text{N}x} \sin\left( \dfrac{a_{ \rho \text{N} x } \pi x}{L}\right)\right] + \\
&+ \dfrac{ 2 k_{b_1 \text{N}}}{M_{\text{N}}^2} \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x} \pi x}{L}\right)\right]^3 +\\
& + \dfrac{ k_{b_1 \text{N}_2}}{M_{\text{N}}^2} \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x} \pi x}{L}\right)\right] \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x} \pi x}{L}\right)\right]^2 +\\
&- \dfrac{ k_{f_1 \text{N}} }{M_{\text{N}}} \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x} \pi x}{L}\right)\right] \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x} \pi x}{L}\right)\right]+\\
&- \dfrac{k_{f_1 \text{N}_2} }{2 M_{\text{N}}} \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x} \pi x}{L}\right)\right]^2.
\end{split}
\end{equation}


\section{Euler mass conservation equation for Nitrogen molecule}

The mass conservation equation for Nitrogen molecule ( $\text{N}_2$), written as an operator, is:
\begin{equation}
 \label{eq:euler1d_11a}
L= \diff{\rho_{\text{N}_2}}{t} + \diff{\rho_{\text{N}_2} u }{x} - \dot{\omega}_{\text{N}_2}
\end{equation}

Analytically differentiating Equation (\ref{eq:manufactured02}) for $\rho_{\text{N}_2}$, $u$ and $v$ using operator $L$ defined above together with suitable substitution for source term~$\dot{\omega}_{\text{N}_2}$ gives the source term $Q_{\rho_{\text{N}_2}}$:

\begin{equation}
\begin{split}
Q_{\rho_{\text{N}_2}} = &- \dfrac{a_{ \rho \text{N}_2 x } \pi \rho_{\text{N}_2 x}}{L}\sin\left( \dfrac{a_{ \rho \text{N}_2 x } \pi x}{L}\right) \left[u_0+u_x \sin\left( \dfrac{a_{ux} \pi x}{L}\right)\right] + \\
&+\dfrac{a_{ux} \pi u_x }{L}\cos\left( \dfrac{a_{ux} \pi x}{L}\right) \left[\rho_{\text{N}_2 0}+\rho_{\text{N}_2 x} \cos\left( \dfrac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right] + \\
&- \dfrac{ 2 k_{b_1 \text{N}}}{M_{\text{N}}^2} \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x} \pi x}{L}\right)\right]^3 +\\
& - \dfrac{ k_{b_1 \text{N}_2}}{M_{\text{N}}^2} \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x} \pi x}{L}\right)\right] \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x} \pi x}{L}\right)\right]^2 +\\
&+ \dfrac{ k_{f_1 \text{N}} }{M_{\text{N}}} \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x} \pi x}{L}\right)\right] \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x} \pi x}{L}\right)\right]+\\
&+ \dfrac{k_{f_1 \text{N}_2} }{2 M_{\text{N}}} \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x} \pi x}{L}\right)\right]^2.
\end{split}
\end{equation}




\section{Euler momentum equation}

For the generation of the analytical source term $Q_u$ for the $x$ momentum equation, Equation (\ref{eq:pde_comp_mom}) is written as an operator $L$:
\begin{equation}
 \label{eq:euler1d_12}
L=\Diff{\rho u}{t} + \Diff{\rho u^2}{x}.
\end{equation}
which, when operated in to Equations (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}), provides source term $Q_{u}$:

\begin{equation}
\begin{split}
 Q_u = &- \dfrac{ a_{px} \pi p_x }{L}\sin\left( \dfrac{ a_{px} \pi x }{L} \right)+ \\
&+ \dfrac{ a_{ \rho \text{N} x} \pi \rho_{\text{N}x}}{L} \cos\left( \dfrac{ a_{ \rho \text{N} x} \pi x }{L} \right)\left[ u_0+u_x\sin\left( \dfrac{ a_{ux} \pi x }{L} \right)\right]^{2}+ \\
&- \dfrac{a_{ \rho \text{N}_2 x} \pi \rho_{\text{N}_2 x} }{L}\sin\left( \dfrac{ a_{ \rho \text{N}_2 x} \pi x }{L} \right)\left[ u_0+u_x \sin\left( \dfrac{ a_{ux} \pi x }{L} \right)\right]^{2} + \\
&+\dfrac{2 a_{ux} \pi u_x }{L}\cos\left( \dfrac{ a_{ux} \pi x }{L} \right)\left[\rho_{\text{N}0} +\rho_{\text{N}_2 0}+\rho_{\text{N}x} \sin\left( \dfrac{ a_{ \rho \text{N} x} \pi x }{L} \right)+\rho_{\text{N}_2 x} \cos\left( \dfrac{ a_{ \rho \text{N}_2 x} \pi x }{L} \right)\right]\cdot \\
 &\quad\cdot\left[ u_0+u_x \sin\left( \dfrac{a_{ux} \pi x }{L} \right)\right]+ \\
\end{split}
\end{equation}


\section{Euler energy equation}
The total energy equation is written as an operator:
\begin{equation}
 \label{eq:euler1d_14}
L=\diff{\rho E}{t} + \diff{\rho u H}{x} ,
\end{equation}
where $E=e^{\text{int}} + \dfrac{u^2 }{2} \quad \mbox{and}\quad H= E+ \dfrac{p}{\rho},$ with $e^{\text{int}}$ and $p$ as defined in Equations (\ref{eq:rE-T-Tv-relationship}) and (\ref{eq:p_eq_state}), respectively.

Source term $Q_E$ is obtained by operating $L$ on Equations (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}):

\begin{equation}
\begin{split}
Q_E &=  \dfrac{a_{ \rho \text{N} x } \pi \rho_{\text{N} x}}{2L}\cos\left(\dfrac{ a_{ \rho \text{N} x } \pi x}{L}\right)\left[ \left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right]^2 + 2 h^{0}_{\text{N}}\right] \left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right]  +\\
&- \dfrac{2a_{ \rho \text{N} x } \pi \rho_{\text{N} x}}{L \; \text{div}^2} \cos\left(\dfrac{ a_{ \rho \text{N} x } \pi x}{L}\right) \left[ \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right] \left[ p_{0}+p_{x} \cos\left(\dfrac{a_{p x} \pi x}{L}\right)\right]\left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right]+\\
%
&- \dfrac{ a_{ \rho \text{N}_2 x } \pi \rho_{\text{N}_2 x} }{2L}\sin\left(\dfrac{ a_{ \rho \text{N}_2 x } \pi x}{L}\right) \left[ \left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right]^2 + 2 h^{0}_{\text{N}_2}\right] \left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right] +\\
&-\dfrac{a_{ \rho \text{N}_2 x } \pi \rho_{\text{N}_2 x}}{L \; \text{div}}\sin\left(\dfrac{ a_{ \rho \text{N}_2 x } \pi x}{L}\right) \left[ p_{0}+p_{x} \cos\left(\dfrac{a_{p x} \pi x}{L}\right)\right]  \left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right] +\\
&+ \dfrac{a_{ \rho \text{N}_2 x } \pi \rho_{\text{N}_2 x}}{L \; \text{div}^2} \sin\left(\dfrac{ a_{ \rho \text{N}_2 x } \pi x}{L}\right) \left[ \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right] \left[ p_{0}+p_{x} \cos\left(\dfrac{a_{p x} \pi x}{L}\right)\right]\left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right] +\\
%
&- \dfrac{a_{px} \pi p_x }{2L \; \text{div}}\sin\left(\dfrac{ a_{px} \pi x}{L}\right) \left[10 \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x }\pi x}{L}\right)\right] + 7 \left[ \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right]\right] \left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right] +\\
%
&+ \dfrac{a_{ux} \pi u_x}{2L}\cos\left(\dfrac{ a_{ux} \pi x}{L}\right)\left\{3 \left[\rho_{\text{N}0} + \rho_{\text{N}_2 0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x }\pi x}{L}\right) + \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)  \right]   \left[ u_{0}+u_{x} \sin\left(\dfrac{a_{u x} \pi x}{L}\right)\right]^2 \right.+\\
    &\qquad -\left. h^{0}_{\text{N}} \left[ \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right]+2 h^{0}_{\text{N}_2} \left[ \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right]+5 \left[ p_{0}+p_{x} \cos\left(\dfrac{a_{p x} \pi x}{L}\right)\right] \right\} +\\
&+ \dfrac{a_{ux} \pi u_x}{L \; \text{div}} \cos\left(\dfrac{ a_{ux} \pi x}{L}\right) \left[ \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right] \left[ p_{0}+p_{x} \cos\left(\dfrac{a_{p x} \pi x}{L}\right)\right] +\\
&+ \dfrac{a_{ux} \pi u_x h^{0}_{\text{N}}}{2L} \cos\left(\dfrac{ a_{ux} \pi x}{L}\right) \left[ 2 \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x }\pi x}{L}\right)\right] + \left[ \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right] \right].
\end{split}
\end{equation}
with $$\text{div}= 2 \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{ \rho \text{N} x }\pi x}{L}\right)\right] + \left[ \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right].$$

\section{Comments}


Source terms $Q_{\rho_\text{N} }$, $Q_{\rho \text{N}_{2}}$, $Q_u$ and $Q_E$ have been generated by replacing the analytical Expressions (\ref{eq:manufactured02}) and  (\ref{eq:manufactured03}) into respective Equations (\ref{eq:pde_comp_mass_N}) -- (\ref{eq:pde_comp_energy}), followed by the usage of Maple commands for collecting, sorting and factorizing the terms. Files containing $C$ codes for the source terms have also been generated. They are: \texttt{ Euler\_1d\_chemistry\_rho\_N\_code.C, Euler\_1d\_chemistry\_rho\_N2\_code.C, Euler\_1d\_chemistry\_u\_code.C,} and \texttt{Euler\_1d\_chemistry\_E\_code.C,}.

%\newpage
An example of the automatically generated C file from the source term for the mass conservation equation of N is:
\begin{small}
\begin{verbatim}
#include <math.h>

double SourceQ_rho_N ( double x, double p_0, double p_x, double rho_N_0, double rho_N_x,
  double rho_N2_0, double rho_N2_x, double u_0, double_x, double a_px, double a_rho_N_x,
  double a_rho_N2_x, double a_ux, double L, double M_N, double k_b1N, double k_f1N,
  double k_b1N2, double k_f1N2)
{
  double Q_rho_N;
  Q_rho_N = rho_N_x * cos(a_rho_N_x * PI * x / L) *
    (u_0 + u_x * sin(a_ux * PI * x / L)) * a_rho_N_x * PI / L +
    u_x * cos(a_ux * PI * x / L) * (rho_N_0 + rho_N_x * sin(a_rho_N_x * PI * x / L)) * a_ux * PI / L +
    0.2e1 * k_b1N * pow(rho_N_0 + rho_N_x * sin(a_rho_N_x * PI * x / L), 0.3e1) *
    pow(M_N, -0.2e1) + k_b1N2 * (rho_N2_0 + rho_N2_x * cos(a_rho_N2_x * PI * x / L)) *
    pow(rho_N_0 + rho_N_x * sin(a_rho_N_x * PI * x / L), 0.2e1) * pow(M_N, -0.2e1) -
    k_f1N * (rho_N2_0 + rho_N2_x * cos(a_rho_N2_x * PI * x / L)) *
    (rho_N_0 + rho_N_x * sin(a_rho_N_x * PI * x / L)) / M_N -
    k_f1N2 * pow(rho_N2_0 + rho_N2_x * cos(a_rho_N2_x * PI * x / L), 0.2e1) / M_N / 0.2e1;
  return(Q_rho_N);
}
\end{verbatim}
 \end{small}

Finally, the gradients of the analytical solutions (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}) have also been computed and their respective C codes are presented in  \texttt{Euler\_1d\_chemistry\_manuf\_solutions\_grad\_and\_code.C}. Therefore,
\begin{equation}
\begin{array}{rrlrl}
\nabla \rho_{\text{N}} &=&  \dfrac{ a_{ \rho \text{N} x} \pi \rho_{\text{N}x} }{L} \cos\left( \dfrac{ a_{\rho \text{N} x} \pi x }{L}\right),
\quad
\nabla \rho_{\text{N}_2} &=&  \dfrac{ a_{ \rho \text{N}_2 x} \pi \rho_{\text{N}_2 x} }{L} \sin\left( \dfrac{ a_{ \rho \text{N}_2 x} \pi x }{L}\right),\vspace{10pt}\\
\quad
%
\nabla p &=& - \dfrac{ a_{px} \pi p_x }{L} \sin\left( \dfrac{ a_{px} \pi x }{L}\right),
\quad\quad\quad
%
\nabla u &=& \dfrac{ a_{ux} \pi u_x}{L} \cos\left( \dfrac{ a_{ux} \pi x }{L}\right),
\end{array}
\end{equation}
and $\nabla \rho =\nabla \left( \rho_\text{N}\right) + \nabla \left(\rho_{\text{N}_2} \right),$ are written in C language as:





\begin{verbatim}
grad_rho_an_N[0] = rho_N_x * cos(a_rho_N_x * pi * x / L) * a_rho_N_x * pi / L;
grad_rho_an_N2[0] = -rho_N2_x * sin(a_rho_N2_x * pi * x / L) * a_rho_N2_x * pi / L;
grad_rho_an[0] = rho_N_x * cos(a_rho_N_x * pi * x / L) * a_rho_N_x * pi / L -
                 rho_N2_x * sin(a_rho_N2_x * pi * x / L) * a_rho_N2_x * pi / L;
grad_p_an[0] = -p_x * sin(a_px * pi * x / L) * a_px * pi / L;
grad_u_an[0] = u_x * cos(a_ux * pi * x / L) * a_ux * pi / L;
\end{verbatim}



%---------------------------------------------------------------------------------------------------------
%\bibliographystyle{ieeetr}
\bibliographystyle{chicago} 
\bibliography{../../../MMS_bib}



\end{document}
