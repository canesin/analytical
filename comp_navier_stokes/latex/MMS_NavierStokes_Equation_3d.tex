\documentclass[10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{geometry}
\geometry{ top=2.5cm, bottom=2cm, left=2cm, right=2cm}
\usepackage[authoryear]{natbib}
\usepackage{pdflscape}
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm,  right=2cm}

\newcommand{\D}{\partial}
\newcommand{\Diff}[2] {\dfrac{\partial( #1)}{\partial #2}}
\newcommand{\diff}[2] {\dfrac{\partial #1}{\partial #2}}
%opening
\title{Manufactured Solution for 3D Navier-Stokes equation using Maple\footnote{The manufactured solution has been presented by \citet*{Roy2002}.}}
\author{Kemelli C. Estacio-Hiroms}

\begin{document}

\begin{landscape}
 
\maketitle

\begin{abstract}
This document presents the source terms generated by the application of the Method of Manufactured Solutions (MMS) on the the 3D Navier-Stokes equations using the analytical manufactured solutions for $\rho, u, v, w$ and $p$ presented by \citet{Roy2002}.
\end{abstract}





\section{3D Navier-Stokes Equations}
The 3D Navier-Stokes equations in conservation form are:
\begin{equation}
 \label{eq:ns2d_01}
\Diff{\rho}{t} + \Diff{\rho u}{x}+\Diff{\rho v}{y} + \Diff{\rho w}{z} = 0
\end{equation}


\begin{equation}
 \label{eq:ns2d_02}
\Diff{\rho u}{t} + \Diff{\rho u^2 + p - \tau_{xx}}{x}+\Diff{\rho uv-\tau_{xy}}{y} +\Diff{\rho uw-\tau_{xz}}{z}= 0
\end{equation}


\begin{equation}
 \label{eq:ns2d_03}
\Diff{\rho v}{t} + \Diff{\rho vu - \tau_{yx}}{x}+\Diff{\rho v^2+p-\tau_{yy}}{y} +\Diff{\rho vw-\tau_{yz}}{z}= 0
\end{equation}


\begin{equation}
 \label{eq:ns2d_03a}
\Diff{\rho w}{t}+\Diff{\rho w u -  \tau_{zx}}{ x}+\Diff{\rho w v-  \tau_{zy}}{ y}+\Diff{\rho w^2+p-  \tau_{zz} }{ z}=0
\end{equation}




\begin{equation}
 \label{eq:ns2d_04}
\Diff{\rho e_t}{t}+\Diff{\rho u e_t+p u-u  \tau_{xx} -v   \tau_{xy} -w   \tau_{xz} +q_x}{x}+\Diff{\rho v e_t+p v-u   \tau_{yx} -v   \tau_{yy} - w   \tau_{yz} +q_y}{y}+\Diff{\rho w e_t+p w-u   \tau_{zx} -v   \tau_{zy} -w   \tau_{zz} +q_z}{z} =0
\end{equation}
%
where the Equation (\ref{eq:ns2d_01}) is mass conservation, Equations (\ref{eq:ns2d_02}) -- (\ref{eq:ns2d_03a}) are momentum, and Equation (\ref{eq:ns2d_04}) is the energy. Notice that Equations~(\ref{eq:ns2d_02})--(\ref{eq:ns2d_03a}) include viscous effects.

For a calorically perfect gas, the Navier-Stokes equations are closed with two auxiliary relations for energy:
\begin{equation}
 \label{eq:ns2d_05}
e_t= e+\dfrac{u^2+v^2+w^2}{2} \quad \mbox{and}\quad e=\dfrac{1}{\gamma -1}RT ,
\end{equation}
where $\gamma$ is the ratio of specific heats, and with the ideal gas equation of state:
\begin{equation}
 \label{eq:ns2d_07}
p=\rho RT.
\end{equation}

The shear stress tensor is:
\begin{equation}
 \begin{array}{lll}
  \tau_{xx}= \frac{2}{3}  \mu \left( 2 \diff{u}{x} - \diff{v}{y} -\diff{w}{z} \right),
  &\tau_{xy}= \tau_{yx}=\mu \left( \diff{u}{y} + \diff{v}{x}\right),\\
  \tau_{yy}= \frac{2}{3}  \mu \left( 2 \diff{v}{y} - \diff{u}{x} -\diff{w}{z} \right),
  &\tau_{yz}= \tau_{zy}=\mu \left( \diff{v}{z} + \diff{w}{y}\right),\\
  \tau_{zz}= \frac{2}{3}  \mu \left( 2 \diff{w}{z} - \diff{u}{x} -\diff{v}{y} \right),
  &\tau_{xz}= \tau_{zx}=\mu \left( \diff{u}{z} + \diff{w}{x}\right),
 \end{array}
\end{equation}
where $\mu$ is the absolute viscosity. The heat flux vector is given by:
\begin{equation}
 %\begin{split}
 % q_x &= - k \diff{T}{x}\\
%q_y &= - k \diff{T}{y}
% \end{split}
 q_x = - k \diff{T}{x}, \quad q_y = - k \diff{T}{y}, \quad \mbox{and} \quad q_z = - k \diff{T}{z}
 \end{equation}
where $k$ is the thermal conductivity, which can be determined by choosing the Prandtl number:
$$k= \dfrac{\gamma R \mu}{ (\gamma-1) Pr}.$$



 

\section{Manufactured Solution}

\citet{Roy2002} introduce the general form of the primitive solution variables to be  a function of sines and cosines:
\begin{equation}
 \label{eq:manufactured01}
  \phi (x,y) = \phi_0+ \phi_x\, f_s \left(\frac{a_{\phi x} \pi x}{L} \right) +  \phi_y \,f_s\left(\frac{a_{\phi y} \pi y}{L}\right) + \phi_z \,f_s\left(\frac{a_{\phi z} \pi z}{L}\right),
\end{equation}
where $\phi=\rho,u,v,w$ or $p$, and $f_s(\cdot)$ functions denote either sine or cosine function. Note that in this case, $\phi_x$, $\phi_y$ and $\phi_z$ are constants  and the subscripts do not denote differentiation.

Therefore, the manufactured analytical solution for each one of the variables in Navier-Stokes equations are:
\begin{equation}
\begin{split}
\label{eq:manufactured02}
\rho\left( x ,y ,z\right) &=  \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho  x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho  y} \pi y}{L}\right) + \rho_{z} \sin\left(\frac{a_{ \rho  z} \pi z}{L}\right) ,\\
u\left( x ,y ,z\right) &= u_{0}+u_{x} \sin\left(\frac{a_{u  x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u  y} \pi y}{L}\right)+u_{z} \cos\left(\frac{a_{u  z} \pi z}{L}\right) ,\\
v\left( x ,y ,z\right) &= v_{0}+v_{x} \cos\left(\frac{a_{v  x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v  y} \pi y}{L}\right)+v_{z} \sin\left(\frac{a_{v  z} \pi z}{L}\right), \\
w\left( x ,y ,z\right) &= w_{0}+w_{x} \sin\left(\frac{a_{w  x} \pi x}{L}\right)+w_{y} \sin\left(\frac{a_{w  y} \pi y}{L}\right)+ w_{z} \cos\left(\frac{a_{w  z} \pi z}{L}\right) ,\\
p\left( x ,y ,z\right) &= p_{0}+p_{x} \cos\left(\frac{a_{p  x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p  y} \pi y}{L}\right)+ p_{z} \cos\left(\frac{a_{p  z} \pi z}{L}\right).\\
\end{split}
\end{equation}



The MMS applied to Navier-Stokes equations consists in modifying Equations~(\ref{eq:ns2d_01}) -- (\ref{eq:ns2d_04}) by adding a source term to the right-hand side of each equation:
\begin{equation}
\begin{split}
\label{eq:ns2d_mod}
&\Diff{\rho}{t} + \Diff{\rho u}{x}+\Diff{\rho v}{y} + \Diff{\rho w}{z} = Q_\rho\\
%
&\Diff{\rho u}{t} + \Diff{\rho u^2 + p - \tau_{xx}}{x}+\Diff{\rho uv-\tau_{xy}}{y} +\Diff{\rho uw-\tau_{xz}}{z}= Q_u,\\
%
&\Diff{\rho v}{t} + \Diff{\rho vu - \tau_{yx}}{x}+\Diff{\rho v^2+p-\tau_{yy}}{y} +\Diff{\rho vw-\tau_{yz}}{z}= Q_v,\\
%
&\Diff{\rho w}{t}+\Diff{\rho w u -  \tau_{zx}}{ x}+\Diff{\rho w v-  \tau_{zy}}{ y}+\Diff{\rho w^2+p-  \tau_{zz} }{ z}=Q_w,\\
%
&\Diff{\rho e_t}{t}+\Diff{\rho u e_t+p u-u  \tau_{xx} -v   \tau_{xy} -w   \tau_{xz} +q_x}{x}+\Diff{\rho v e_t+p v-u   \tau_{yx} -v   \tau_{yy} - w   \tau_{yz} +q_y}{y}+\Diff{\rho w e_t+p w-u   \tau_{zx} -v   \tau_{zy} -w   \tau_{zz} +q_z}{z} =Q_{e_t},
\end{split}
\end{equation}
so the modified set of equations has known, analytical solution.

In the case of $Q_\rho$, $Q_u$, $Q_v$, $Q_w$ and $Q_{e_t}$ are conveniently obtained by analytical differentiation of Equation ({\ref{eq:manufactured02}}) using Equations~ (\ref{eq:ns2d_01}) -- (\ref{eq:ns2d_04}) as differential operators, the solution of Equation (\ref{eq:ns2d_mod}) is  Equation (\ref{eq:manufactured02}).

Such terms are obtained by symbolic manipulations of equations above using Maple and are presented in the following sections.

\section{Source term for  Navier-Stokes mass conservation equation}

\begin{equation}
\begin{split}
Q_\rho &= \dfrac{ a_{\rho x} \pi \rho_x}{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]  +\\
&-\dfrac{a_{\rho y} \pi\rho_y }{L} \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] +\\
& +\dfrac{a_{\rho z} \pi\rho_z}{L} \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]  +\\
& + \dfrac{a_{ux} \pi u_x }{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]  +\\
& +\dfrac{a_{vy} \pi v_y }{L} \cos\left(\dfrac{a_{vy} \pi y}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] +\\
& -\dfrac{a_{wz} \pi w_z}{L}  \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \\
\end{split}
\end{equation}



\section{Source term for Navier-Stokes momentum equation}


\begin{equation}
 \begin{split}
Q_u =
&-\dfrac{a_{px} \pi p_x }{L} \sin\left(\dfrac{a_{px} \pi x}{L}\right) +\\
&+ \dfrac{a_{\rho x} \pi\rho_x}{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]^2  +\\
&-\dfrac{a_{\rho y} \pi\rho_y }{L} \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]  +\\
&+ \dfrac{a_{\rho z} \pi\rho_z }{L} \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]+\\
&+\dfrac{2 a_{ux} \pi u_x}{L}  \cos\left(\dfrac{a_{ux} \pi x}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] +\\
&-\dfrac{a_{uy} \pi u_y}{L}  \sin\left(\dfrac{a_{uy} \pi y}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] +\\
&-\dfrac{a_{uz} \pi u_z}{L}  \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]  +\\
&+\dfrac{a_{vy} \pi v_y}{L}  \cos\left(\dfrac{a_{vy} \pi y}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] +\\
&-\dfrac{a_{wz} \pi w_z}{L} \sin\left(\dfrac{a_{wz} \pi z}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]+\\
&+  \dfrac{4 a_{ux}^2 \pi^2\mu u_x }{3 L^2} \sin\left(\dfrac{a_{ux} \pi x}{L}\right) \quad+\quad \dfrac{a_{uy}^2 \pi^2\mu u_y }{L^2} \cos\left(\dfrac{a_{uy} \pi y}{L}\right)\quad + \quad\dfrac{a_{uz}^2 \pi^2\mu u_z}{L^2}  \cos\left(\dfrac{a_{uz} \pi z}{L}\right)  
 \end{split}
\end{equation}
%
%
%
\begin{equation}
\begin{split} 
Q_v = 
&+\dfrac{a_{py} \pi p_y }{L}\cos\left(\dfrac{a_{py} \pi y}{L}\right)  +\\
&+\dfrac{a_{\rho x} \pi\rho_x  }{L} \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] +\\
&-\dfrac{a_{\rho y} \pi \rho_y}{L}  \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]^2 +\\
&+\dfrac{a_{\rho z} \pi \rho_z}{L} \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]  +\\
&+ \dfrac{a_{ux} \pi u_x}{L} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] +\\
&-\dfrac{a_{vx} \pi v_x}{L} \sin\left(\dfrac{a_{vx} \pi x}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]  +\\
&+ \dfrac{2 a_{vy} \pi v_y}{L}\cos\left(\dfrac{a_{vy} \pi y}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]  +\\
&+\dfrac{a_{vz} \pi v_z}{L} \cos\left(\dfrac{a_{vz} \pi z}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]  +\\
&- \dfrac{a_{wz} \pi w_z }{L}\sin\left(\dfrac{a_{wz} \pi z}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] + \\
&+\dfrac{ a_{vx}^2 \pi^2 \mu v_x}{L^2} \cos\left(\dfrac{a_{vx} \pi x}{L}\right) \quad+ \quad  \dfrac{4a_{vy}^2 \pi^2  \mu v_y}{3 L^2}\sin\left(\dfrac{a_{vy} \pi y}{L}\right)  \quad+ \quad\dfrac{ a_{vz}^2 \pi^2 \mu v_z}{L^2}\sin\left(\dfrac{a_{vz} \pi z}{L}\right) 
 \end{split}
\end{equation}


\begin{equation}
\begin{split} 
 Q_w = 
& - \dfrac{a_{pz} \pi p_z }{L} \sin\left(\dfrac{a_{pz} \pi z}{L}\right)+\\
&+\dfrac{a_{\rho x} \pi \rho_x }{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]  +\\
&-\dfrac{ a_{\rho y} \pi\rho_y }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]  +\\
&+\dfrac{a_{\rho z} \pi\rho_z  }{L} \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]^2 +\\
%
&+ \dfrac{a_{ux} \pi u_x }{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] +\\
%
&+ \dfrac{a_{vy} \pi v_y }{L}\cos\left(\dfrac{a_{vy} \pi y}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]  +\\
&+\dfrac{ a_{wx} \pi w_x }{L} \cos\left(\dfrac{a_{wx} \pi x}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]+\\
&+\dfrac{a_{wy} \pi w_y }{L}  \cos\left(\dfrac{a_{wy} \pi y}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[v_0+v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] +\\
&-\dfrac{2  a_{wz} \pi w_z  }{L}\sin\left(\dfrac{a_{wz} \pi z}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]+\\
&+\dfrac{ a_{wx}^2 \pi^2\mu w_x }{L^2} \sin\left(\dfrac{a_{wx} \pi x}{L}\right)\quad+\quad\dfrac{ a_{wy}^2 \pi^2 \mu w_y}{L^2}\sin\left(\dfrac{a_{wy} \pi y}{L}\right)  \quad+\quad\dfrac{4  a_{wz}^2 \pi^2 \mu w_z }{3 L^2}\cos\left(\dfrac{a_{wz} \pi z}{L}\right)\\
\end{split} 
\end{equation}








\section{Source term for Navier-Stokes energy equation}


 
\begin{equation}
\label{eq:source_e}
 \begin{split}
Qe =&- \dfrac{a_{px} \pi p_x }{L} \dfrac{\gamma}{\gamma-1} \sin\left(\dfrac{a_{px} \pi x}{L}\right)\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] +\\
%
&+\dfrac{a_{py} \pi p_y }{L} \dfrac{\gamma}{\gamma-1} \cos\left(\dfrac{a_{py} \pi y}{L}\right) \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]  +\\
%
&- \dfrac{a_{pz} \pi p_z}{L} \dfrac{\gamma}{\gamma-1}   \sin\left(\dfrac{a_{pz} \pi z}{L}\right)\left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]+ \\
%
&+\dfrac{ a_{\rho x} \pi \rho_x}{2L} \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] \left(\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]^2+ \right. \\
  &\qquad\left. + \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]^2+\left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]^2\right)  +\\
%
&-\dfrac{a_{\rho y} \pi\rho_y }{2L} \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] \left(\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]^2 \right.+\\
  &\qquad\left. +\left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]^2+\left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]^2\right)  +\\
%
&+\dfrac{a_{\rho z} \pi\rho_z }{2L}\cos\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] \left(\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]^2 +\right.\\
  &\quad+\left.\left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]^2+\left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]^2\right)  +\\
%
&+ \dfrac{ a_{ux} \pi u_x}{2L}  \cos\left(\dfrac{a_{ux} \pi x}{L}\right)\left\{\left(\left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]^2+\left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]^2 +\right.\right. \\
  &\qquad \left. + 3 \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]^2\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] + \\
  &\qquad \left. + \left[p_0+p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)+p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)+p_z \cos\left(\dfrac{a_{pz} \pi z}{L}\right)\right] \dfrac{2\gamma}{(\gamma-1)}\right\} +\\
%
&-\dfrac{a_{uy} \pi u_y }{L}\sin\left(\dfrac{a_{uy} \pi y}{L}\right) \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]\cdot \\
  &\qquad \cdot \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] +\\
%
&-\dfrac{a_{uz} \pi u_z }{L} \sin\left(\dfrac{a_{uz} \pi z}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \cdot \\
  &\qquad \cdot \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] +
 \end{split}
\end{equation}

\begin{equation*}
 \begin{split}
%
&-\dfrac{a_{vx} \pi v_x }{L}\sin\left(\dfrac{a_{vx} \pi x}{L}\right)\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \cdot \\
  &\qquad\cdot \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]   +\\
%
&+ \dfrac{a_{vy} \pi v_y }{2L}\cos\left(\dfrac{a_{vy} \pi y}{L}\right)\left\{ \left(\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]^2+\left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]^2 \right. \right.+\\
  &\qquad\left.+3 \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]^2\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] +\\
  &\qquad + \left. \left[p_0+p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)+p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)+p_z \cos\left(\dfrac{a_{pz} \pi z}{L}\right)\right]\dfrac{2\gamma}{\gamma -1} \right\}  +\\
%
&+\dfrac{ a_{vz} \pi v_z}{L} \cos\left(\dfrac{a_{vz} \pi z}{L}\right)\left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \cdot \\
  &\qquad \cdot \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]   +\\
%
&+ \dfrac{ a_{wx} \pi w_x}{L} \cos\left(\dfrac{a_{wx} \pi x}{L}\right)\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right] \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \cdot \\
  &\qquad\cdot \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right] +\\
%
&+\dfrac{ a_{wy} \pi w_y }{L} \cos\left(\dfrac{a_{wy} \pi y}{L}\right)\left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right] \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] \cdot \\
  &\qquad \cdot \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]+ \\
%
&-\dfrac{a_{wz} \pi w_z }{2L}\sin\left(\dfrac{a_{wz} \pi z}{L}\right) \left\{\left( 3 \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]^2+\left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]^2+ \right.\right. \\
  &\qquad \left. +\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]^2\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right] +\\
  &\qquad \left.+ \left[p_0+p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)+p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)+p_z \cos\left(\dfrac{a_{pz} \pi z}{L}\right)\right]\dfrac{2\gamma}{(\gamma-1)} \right\}+\\
%
&+  \dfrac{a_{px}^2 \pi^2 k p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)}{L^2 R \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]}+\\
%
&+\dfrac{a_{py}^2 \pi^2 k p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)}{L^2 R \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]}+ \\
%
&+\dfrac{a_{pz}^2 \pi^2 k p_z \cos\left(\dfrac{a_{pz} \pi z}{L}\right)}{L^2 R \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]}+ \\
\end{split}
\end{equation*}

\begin{equation*}
\begin{split}
%
&-\dfrac{a_{\rho x}^2 \pi^2k \rho_x \left[2 \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)^2 \rho_x+\sin\left(\dfrac{a_{\rho x} \pi x}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]\right] \left[p_0+p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)+p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)+p_z \cos\left(\dfrac{a_{pz} \pi z}{L}\right)\right] }{R L^2 \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]^3} +\\
%
%
&-\dfrac{a_{\rho y}^2 \pi^2  k \rho_y \left[2 \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)^2 \rho_y+\cos\left(\dfrac{a_{\rho y} \pi y}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]\right] \left[p_0+p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)+p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)+p_z \cos\left(\dfrac{a_{pz} \pi z}{L}\right)\right]}{R L^2 \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]^3}+\\
%
&-\dfrac{ a_{\rho z}^2 \pi^2 k \rho_z\left[2 \cos\left(\dfrac{a_{\rho z} \pi z}{L}\right)^2 \rho_z+\sin\left(\dfrac{a_{\rho z} \pi z}{L}\right) \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]\right] \left[p_0+p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)+p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)+p_z \cos\left(\dfrac{a_{pz} \pi z}{L}\right)\right]}{R L^2 \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]^3}+\\
%
&-\dfrac{4}{3} \dfrac{a_{ux}^2 \pi^2  \mu u_x }{L^2}\left[\cos\left(\dfrac{a_{ux} \pi x}{L}\right)^2 u_x-\sin\left(\dfrac{a_{ux} \pi x}{L}\right) \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]\right] +\\
%
&- \dfrac{a_{uy}^2 \pi^2\mu u_y }{L^2}\left[\sin\left(\dfrac{a_{uy} \pi y}{L}\right)^2 u_y-\cos\left(\dfrac{a_{uy} \pi y}{L}\right) \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]\right]  + \\
%
&-\dfrac{a_{uz}^2 \pi^2\mu u_z}{L^2}\left[\sin\left(\dfrac{a_{uz} \pi z}{L}\right)^2 u_z-\cos\left(\dfrac{a_{uz} \pi z}{L}\right) \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)+u_z \cos\left(\dfrac{a_{uz} \pi z}{L}\right)\right]\right]    + \\
%
%
&-\dfrac{ a_{vx}^2 \pi^2\mu v_x}{L^2}\left[\sin\left(\dfrac{a_{vx} \pi x}{L}\right)^2 v_x-\cos\left(\dfrac{a_{vx} \pi x}{L}\right) \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]\right]   + \\
%
&-\dfrac{4}{3} \dfrac{a_{vy}^2 \pi^2 \mu v_y }{L^2}\left[\cos\left(\dfrac{a_{vy} \pi y}{L}\right)^2 v_y-\sin\left(\dfrac{a_{vy} \pi y}{L}\right) \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]\right]  + \\
%
&-\dfrac{ a_{vz}^2 \pi^2 \mu v_z }{L^2}\left[\cos\left(\dfrac{a_{vz} \pi z}{L}\right)^2 v_z-\sin\left(\dfrac{a_{vz} \pi z}{L}\right) \left[v_0+ v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)+v_z \sin\left(\dfrac{a_{vz} \pi z}{L}\right)\right]\right] + \\
%
&-\dfrac{a_{wx}^2 \pi^2\mu w_x }{L^2}\left[\cos\left(\dfrac{a_{wx} \pi x}{L}\right)^2 w_x-\sin\left(\dfrac{a_{wx} \pi x}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]\right]   + \\
%
&- \dfrac{a_{wy}^2 \pi^2\mu w_y }{L^2} \left[\cos\left(\dfrac{a_{wy} \pi y}{L}\right)^2 w_y-\sin\left(\dfrac{a_{wy} \pi y}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]\right] + \\
%
&-\dfrac{4}{3} \dfrac{a_{wz}^2 \pi^2 \mu w_z}{L^2}\left[\sin\left(\dfrac{a_{wz} \pi z}{L}\right)^2 w_z -\cos\left(\dfrac{a_{wz} \pi z}{L}\right) \left[w_0+w_x \sin\left(\dfrac{a_{wx} \pi x}{L}\right)+w_y \sin\left(\dfrac{a_{wy} \pi y}{L}\right)+w_z \cos\left(\dfrac{a_{wz} \pi z}{L}\right)\right]\right]   + \\
%
\end{split}
\end{equation*}

\begin{equation*}
\begin{split}
&-  \dfrac{2 a_{px} a_{\rho x} \pi^2 k p_x \rho_x \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \sin\left(\dfrac{a_{px} \pi x}{L}\right)}{L^2 R \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]^2} + \\
%
&- \dfrac{2 a_{py} a_{\rho y} \pi^2 k p_y  \rho_y\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \cos\left(\dfrac{a_{py} \pi y}{L}\right)  }{L^2 R \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]^2} +\\
%
&-  \dfrac{2 a_{pz} a_{\rho z} \pi^2 k p_z \rho_z\cos\left(\dfrac{a_{\rho z} \pi z}{L}\right) \sin\left(\dfrac{a_{pz} \pi z}{L}\right) }{L^2 R \left[\rho_0+\rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\rho_z \sin\left(\dfrac{a_{\rho z} \pi z}{L}\right)\right]^2}+\\
%
&+\dfrac{4}{3}   \dfrac{ a_{ux} a_{vy} \pi^2\mu u_x v_y}{L^2} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) \cos\left(\dfrac{a_{vy} \pi y}{L}\right)+ \\
%
&-\dfrac{4}{3}   \dfrac{a_{ux} a_{wz} \pi^2 \mu u_x w_z}{L^2}\cos\left(\dfrac{a_{ux} \pi x}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right) + \\
%
&-\dfrac{2 a_{uy} a_{vx} \pi^2  \mu u_y v_x }{L^2} \sin\left(\dfrac{a_{uy} \pi y}{L}\right) \sin\left(\dfrac{a_{vx} \pi x}{L}\right)+ \\
%
&+\dfrac{2 a_{uz} a_{wx} \pi^2 \mu u_z w_x }{L^2}\cos\left(\dfrac{a_{wx} \pi x}{L}\right) \sin\left(\dfrac{a_{uz} \pi z}{L}\right)+\\
%
&-\dfrac{4}{3}  \dfrac{a_{vy} a_{wz} \pi^2\mu v_y w_z }{L^2}\cos\left(\dfrac{a_{vy} \pi y}{L}\right) \sin\left(\dfrac{a_{wz} \pi z}{L}\right)  + \\
%
&- \dfrac{2  a_{vz} a_{wy} \pi^2\mu v_z w_y}{L^2} \cos\left(\dfrac{a_{vz} \pi z}{L}\right) \cos\left(\dfrac{a_{wy} \pi y}{L}\right) .
\end{split}
\end{equation*}

\section{Comments}
%Although source terms $Q_{\rho}$, $Q_u$, $Q_v$ and $Q_w$ have been generated automatically by replacing the analytical expressions (\ref{eq:manufactured02}) into  respective operators, followed by the usage of Maple commands for collecting, sorting and factorizing the terms, source term $Q_{e_t}$  has been obtained through the replacement of the analytical expressions (\ref{eq:manufactured02}) into operator (\ref{eq:ns2d_14}), followed by a Maple command for collecting terms and the manual split of source term $Q_{e_t}$ into sub-terms, followed by the verification of its correctness. This additional step was required because the expression for $Q_{e_t}$ is more complex and longer than the expression for the other source terms.

Source terms $Q_{\rho}$, $Q_u$, $Q_v$ and $Q_w$ have been generated automatically by replacing the analytical expressions (\ref{eq:manufactured02}) into  respective operators, followed by the usage of Maple commands for collecting, sorting and factorizing the terms. Yet,  to achieve the final form of source term $Q_{e_t}$, due to its higher complexity, a slightly different procedure has been applied.  First, $Q_{e_t}$ has manually been split into several subterms, to facilitate and improve the symbolic manipulation; then Maple commands for collecting, sorting and factorizing have been employed. Finally, the resulting source term has been compared to its original form to ensure correctness. As  result, the initially 41--page long expression for $Q_{e_t}$ has been  reduced to Equation~(\ref{eq:source_e}). Please see file {\tt NavierStokes\_equation\_3d\_e\_Maple.pdf} for the original expression of $Q_{e_t}$.

Files containing  $C$ codes for the source terms have also been generated. They are: \texttt{NavierStokes\_3d\_e\_code.C, NavierStokes\_3d\_rho\_code.C, NavierStokes\_3d\_u\_code.C, NavierStokes\_3d\_v\_code.C} and \texttt{NavierStokes\_3d\_w\_code.C}.

\newpage
An example of the automatically generated C file from the source term for mass conservation equation is:
\begin{verbatim}
double SourceQ_rho (  double x,  double y,  double z,  double u_0,  double u_x,  double u_y,  double u_z,  double v_0,
                      double v_x,  double v_y,  double v_z,  double rho_0,  double rho_x,  double rho_y,  double rho_z,
                      double p_0,  double p_x,  double p_y,  double p_z,  double a_px,  double a_py,  double a_pz,
                      double a_rhox,  double a_rhoy,  double a_rhoz,  double a_ux, double a_uy,  double a_uz,  double a_vx,
                      double a_vy,  double a_vz,  double a_wx,  double a_wy,  double a_wz,  double mu,  double L)
{
  double Q_rho;
  Q_rho = rho_x * cos(a_rhox * PI * x / L) * (u_0 + u_x * sin(a_ux * PI * x / L) + u_y * cos(a_uy * PI * y / L) +
          u_z * cos(a_uz * PI * z / L)) * a_rhox * PI / L - rho_y * sin(a_rhoy * PI * y / L) * (v_0 +
          v_x * cos(a_vx * PI * x / L) + v_y * sin(a_vy * PI * y / L) + v_z * sin(a_vz * PI * z / L)) * a_rhoy * PI / L +
          rho_z * cos(a_rhoz * PI * z / L) * (w_0 + w_x * sin(a_wx * PI * x / L) + w_y * sin(a_wy * PI * y / L) +
          w_z * cos(a_wz * PI * z / L)) * a_rhoz * PI / L + u_x * cos(a_ux * PI * x / L) * (rho_0 +
          rho_x * sin(a_rhox * PI * x / L) + rho_y * cos(a_rhoy * PI * y / L) + rho_z * sin(a_rhoz * PI * z / L)) * a_ux * PI / L +
          v_y * cos(a_vy * PI * y / L) * (rho_0 + rho_x * sin(a_rhox * PI * x / L) + rho_y * cos(a_rhoy * PI * y / L) +
          rho_z * sin(a_rhoz * PI * z / L)) * a_vy * PI / L - w_z * sin(a_wz * PI * z / L) * (rho_0 +
          rho_x * sin(a_rhox * PI * x / L) + rho_y * cos(a_rhoy * PI * y / L) + rho_z * sin(a_rhoz * PI * z / L)) * a_wz * PI / L;
  return(Q_rho);
}
\end{verbatim}
 


Finally the gradients of the analytical solutions (\ref{eq:manufactured02}) have also been computed and their respective C codes are presented in \\ \texttt{NavierStokes\_manuf\_solutions\_grad\_and\_code\_3d.C}. Therefore,
\begin{equation}
\nabla  \rho= \left[ \begin{array}{c}
 \dfrac{  a_{\rho x}  \pi \rho_x}{L} \cos\left( \dfrac{ a_{\rho x}  \pi  x}{L}\right)\vspace{5pt} \\
-\dfrac{  a_{\rho y}  \pi \rho_y}{L} \sin\left( \dfrac{ a_{\rho y}  \pi  y}{L}\right)\vspace{5pt}\\
 \dfrac{  a_{\rho z}  \pi \rho_z}{L}  \cos\left( \dfrac{ a_{\rho z}  \pi  z}{L}\right)
\end{array} \right],
\qquad
\nabla p = \left[ \begin{array}{c}
- \dfrac{  a_{px}  \pi p_x}{L} \sin\left( \dfrac{ a_{px}  \pi  x}{L}\right)\vspace{5pt}\\
  \dfrac{  a_{py}  \pi p_y}{L} \cos\left( \dfrac{ a_{py}  \pi  y}{L}\right) \vspace{5pt}\\
- \dfrac{  a_{pz}  \pi p_z}{L} \sin\left( \dfrac{ a_{pz}  \pi  z}{L}\right)
\end{array} \right],
\quad
\nabla u = \left[ \begin{array}{c}
  \dfrac{  a_{ux}  \pi u_x}{L} \cos\left( \dfrac{ a_{ux}  \pi  x}{L}\right)\vspace{5pt}\\
 -   \dfrac{  a_{uy}  \pi u_y}{L} \sin\left( \dfrac{ a_{uy}  \pi  y}{L}\right)\vspace{5pt}\\
 -   \dfrac{  a_{uz}  \pi u_z}{L} \sin\left( \dfrac{ a_{uz}  \pi  z}{L}\right)
\end{array} \right],
\end{equation}

\begin{equation}
\nabla  v= \left[ \begin{array}{c}
-  \dfrac{  a_{vx}  \pi v_x}{L}  \sin\left( \dfrac{ a_{vx}  \pi  x}{L}\right)\vspace{5pt}\\
    \dfrac{  a_{vy}  \pi v_y}{L} \cos\left( \dfrac{ a_{vy}  \pi  y}{L}\right)\vspace{5pt}\\
   \dfrac{  a_{vz}  \pi v_z }{L} \cos\left( \dfrac{ a_{vz}  \pi  z}{L}\right)
\end{array} \right]
\quad\mbox{and}\quad
\nabla w = \left[ \begin{array}{c}
\dfrac{  a_{wx}  \pi  w_x}{L} \cos\left( \dfrac{ a_{wx}  \pi  x}{L}\right)\vspace{5pt}\\
  \dfrac{  a_{wy}  \pi w_y}{L}  \cos\left( \dfrac{ a_{wy}  \pi  y}{L}\right)\vspace{5pt} \\
 - \dfrac{  a_{wz}  \pi w_z}{L}  \sin\left( \dfrac{ a_{wz}  \pi  z}{L}\right)
\end{array} \right]
\end{equation}
are written in C language as:
\begin{verbatim}
grad_rho_an[0] = rho_x * cos(a_rhox * pi * x / L) * a_rhox * pi / L;
grad_rho_an[1] = -rho_y * sin(a_rhoy * pi * y / L) * a_rhoy * pi / L;
grad_rho_an[2] = rho_z * cos(a_rhoz * pi * z / L) * a_rhoz * pi / L;
grad_p_an[0] = -p_x * sin(a_px * pi * x / L) * a_px * pi / L;
grad_p_an[1] = p_y * cos(a_py * pi * y / L) * a_py * pi / L;
grad_p_an[2] = -p_z * sin(a_pz * pi * z / L) * a_pz * pi / L;
grad_u_an[0] = u_x * cos(a_ux * pi * x / L) * a_ux * pi / L;
grad_u_an[1] = -u_y * sin(a_uy * pi * y / L) * a_uy * pi / L;
grad_u_an[2] = -u_z * sin(a_uz * pi * z / L) * a_uz * pi / L;
grad_v_an[0] = -v_x * sin(a_vx * pi * x / L) * a_vx * pi / L;
grad_v_an[1] = v_y * cos(a_vy * pi * y / L) * a_vy * pi / L;
grad_v_an[2] = v_z * cos(a_vz * pi * z / L) * a_vz * pi / L;
grad_w_an[0] = w_x * cos(a_wx * pi * x / L) * a_wx * pi / L;
grad_w_an[1] = w_y * cos(a_wy * pi * y / L) * a_wy * pi / L;
grad_w_an[2] = -w_z * sin(a_wz * pi * z / L) * a_wz * pi / L;
\end{verbatim}

%---------------------------------------------------------------------------------------------------------
\bibliographystyle{chicago} 
\bibliography{/home/kemelli/MMS_maple_workplace/heat_equation/MMS_bib}

\end{landscape}


\end{document}