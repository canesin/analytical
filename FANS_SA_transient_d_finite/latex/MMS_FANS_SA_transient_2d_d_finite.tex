\documentclass[10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amssymb, amsmath, amsfonts, amsthm, wasysym} % math
\usepackage{nicefrac}
\usepackage{geometry}
%\usepackage[mathcal]{euscript}
\geometry{ top=2.5cm, bottom=2cm, left=2cm, right=2cm}
\usepackage[authoryear]{natbib}
\usepackage{pdflscape}
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm,  right=2cm}

\newcommand{\D}{\partial}
\newcommand{\Diff}[2] {\dfrac{\partial( #1)}{\partial #2}}
\newcommand{\diff}[2] {\dfrac{\partial #1}{\partial #2}}
\newcommand{\bv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}
\newcommand{\gv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}% for vectors of Greek letters
\newcommand{\grad}[1]{\gv{\nabla} #1}
\newcommand{\Rho}{\,\mathtt{Rho}}
\newcommand{\PP}{\,\mathtt{P}}
\newcommand{\U}{\,\mathtt{U}}
\newcommand{\V}{\,\mathtt{V}}
\newcommand{\Nu}{\,\mathtt{Nu_{sa}}}
\newcommand{\Mu}{\,\mathtt{Mu}}
\newcommand{\Lo}{\,\mathcal{L}}
%\newcommand{\Pr}{\mbox{Pr}}

% commands I like
\newcommand{\mbb}[1]{\mathbb{#1}}
\newcommand{\mbf}[1]{\mathbf{#1}}
\newcommand{\sbf}[1]{\boldsymbol{#1}}
\newcommand{\mcal}[1]{\mathcal{#1}}
\newcommand{\mfk}[1]{\mathfrak{#1}}
\newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\dd}[2]{\frac{d #1}{d #2}}
\newcommand{\rarrow}{\rightarrow}
\newcommand{\Rarrow}{\Rightarrow}
\newcommand{\LRarrow}{\Leftrightarrow}
\newcommand{\jump}[1]{\llbracket #1 \rrbracket}
\newcommand{\avg}[1]{\{ #1 \}}
\def\etal{{\it et al.~}}
\newcommand{\vvvert}{|\kern-1pt|\kern-1pt|}
\newcommand{\enorm}[1]{\vvvert #1 \vvvert}
\newcommand{\ud}{\,\mathrm{d}}

\newcommand{\sa}{\nu_{\mathrm{sa}}}
\newcommand{\tsa}{\mathrm{sa}}
\newcommand{\brho}{\bar{\rho}}
\newcommand{\bp}{\bar{p}}
\newcommand{\bq}{\bar{q}}
\newcommand{\tu}{\tilde{u}}
\newcommand{\tv}{\tilde{v}}
\newcommand{\tS}{\tilde{S}}
\newcommand{\tE}{\tilde{E}}
\newcommand{\bmu}{\bar{\mu}}
\newcommand{\hh}{\tilde{h}}
%opening
\title{Manufactured Solution for the 2D Favre-Averaged Navier--Stokes Equations with Spalart-Allmaras turbulence model using Maple}
\author{Kemelli C. Estacio-Hiroms}

\begin{document}

\maketitle

\begin{abstract}
The Method of Manufactured Solutions is a valuable approach for code verification, providing means to verify how accurately the numerical method solves the partial differential equations of interest.
This document presents the source terms generated by the application of the Method of Manufactured Solutions on the 2D transient Favre-Averaged Navier--Stokes Equations with Spalart-Allmaras turbulence model using the analytical manufactured solutions for density, velocity and pressure presented by \citet{Roy2002}.
\end{abstract}





\section{Mathematical Model}

%-------------------------------------------------
Turbulent flows occur at high Reynolds numbers, when the inertia of the fluid overwhelms the viscosity of the fluid, causing the laminar flow motions to become unstable. Under these conditions, the flow is characterized by rapid fluctuations in pressure and velocity which are inherently three dimensional and unsteady. Turbulent flow is composed of large eddies that migrate across the flow generating smaller eddies as they go. These smaller eddies in turn generates smaller eddies until they become small enough that their energy is dissipated due to the presence of molecular viscosity.

In practice, the effect of this sensitivity
is to make the value of any flow quantity at any particular point in
time and space uncertain.  Thus, these quantities may be viewed as
random variables with associated probability density functions,
allowing the use of statistical techniques in the description and
analysis of the flow. Or, in other words, the full influence of the turbulent fluctuations on the mean flow must be modelled.

For flows with significant density variations it is possible to  capture the turbulent effects using the Favre averaged Navier-Stokes equations (FANS), together with baseline compressible Spalart-Allmaras (SA) turbulent model~\citep{Oliver2010}.

Mass conservation:
\begin{equation}\label{eq:ns01}
\pp{\bar{\rho}}{t} + \pp{}{x_i} (\bar{\rho}\tilde{u}_i) = 0, 
\end{equation}

Momentum conservation:
\begin{equation}\label{eq:ns02}
\pp{}{t} \left(\bar{\rho} \tilde{u}_i \right) + \pp{}{x_j} \left(\bar{\rho} \tilde{u}_j \tilde{u}_i  \right) = - \, \pp{\bar{p}}{x_i} + \pp{}{x_j}\left( 2 (\bar{\mu} + \mu_t) \tilde{S}_{ji} \right), \\
\end{equation}

Total energy conservation:
\begin{equation}\label{eq:ns03}
\pp{}{t} \left[ \bar{\rho} \left( \tilde{e} + \frac{1}{2} \tilde{u}_i \tilde{u}_i \right) \right] + \pp{}{x_j} \left[ \bar{\rho} \tilde{u}_j \left( \tilde{h} + \frac{1}{2} \tilde{u}_i \tilde{u}_i \right) \right] =  \pp{}{x_j} \left( 2 (\bar{\mu} + \mu_t) \tilde{S}_{ji} \tilde{u}_i \right) + \pp{}{x_j} \left[ \left( \frac{\bar{\mu}}{\Pr} + \frac{\mu_t}{\Pr_t} \right) \pp{\tilde{h}}{x_j} \right], \\
\end{equation}

Baseline compressible Spalart-Allmaras equation:
\begin{equation}\label{eq:ns04}
\pp{}{t}(\bar{\rho} \sa) + \pp{}{x_j} (\bar{\rho} \tilde{u}_j \sa) =  c_{b1} S_{\mathrm{sa}} \bar{\rho} \sa - c_{w1} f_w \bar{\rho} \left( \frac{\sa}{d} \right)^2 + \frac{1}{\sigma} \pp{}{x_k} \left[ (\bar{\mu} + \bar{\rho} \sa) \pp{\sa}{x_k} \right] + \frac{c_{b2}}{\sigma} \bar{\rho} \pp{\sa}{x_k} \pp{\sa}{x_k},
\end{equation}
%
where $[\tilde{\,\,}]$ denotes a Favre-averaging variable and $[\bar{\,\,}]$ denotes Reynolds averaging.

To close the equations, many additional relationships are
necessary---e.g., a constitutive relation for the viscous stress, an
equation of state, etc. In this work, the gas is considered calorically perfect and:
%
\begin{equation}
 \begin{split}\label{eq:closure}
&\bar{\mu} =\texttt{constant}, \quad \tilde{S}_{ij} = \tilde{s}_{ij} - \frac{1}{3} \tilde{s}_{kk} \delta_{ij}, \quad \tilde{s}_{ij} = \frac{1}{2} \left( \pp{\tilde{u}_i}{x_j} + \pp{\tilde{u}_j}{x_i} \right), \\
&\bar{p} = \bar{\rho} R \tilde{T}, \quad \tilde{e} = c_v \tilde{T}, \quad \tilde{h} = c_p \tilde{T} = \tilde{e} + \frac{\bar{p}}{\bar{\rho}} \\
&\mu_t = \bar{\rho} \nu_t = \bar{\rho} \sa f_{v1}, \quad S_{\mathrm{sa}} = \Omega + \frac{\sa}{\kappa^2 d^2} f_{v2}, \quad \Omega = \sqrt{2 \tilde{\Omega}_{ij} \tilde{\Omega}_{ij} }, \quad \widetilde{\Omega}_{ij} = \frac{1}{2} \left( \pp{\tilde{u}_i}{x_j} - \pp{\tilde{u}_j}{x_i} \right), \\
&f_{v2} = 1 - \frac{\chi}{1 + \chi f_{v1}}, \quad f_{v1} = \frac{\chi^3}{\chi^3 + c_{v1}^3}, \quad \chi = \frac{\sa}{\tilde{\nu}}, \\
&f_w = g \left( \frac{1 + c_{w3}^6}{g^6 + c_{w3}^6} \right)^{1/6}, \quad g = r + c_{w2} \left( r^6 - r \right), \quad r = \frac{\sa}{S_{\mathrm{sa}} \kappa^2 d^2}, 
 \end{split}
\end{equation}
%
where $d$ is the distance to the nearest no slip wall.

The constants $c_v$ and $c_p$ are fluid properties.  The constants $c_{b1}$, $c_{b2}$, $c_{v1}$, $\sigma$,
$c_{w1}$, $c_{w2}$, $c_{w3}$, and $\kappa$ are the SA model calibration parameters.

\section{Manufactured Solution}

The Method of Manufactured Solutions (MMS) applied to Favre-Averaged Navier--Stokes equations with baseline compressible Spalart-Allmaras turbulence model consists in modifying Equations~(\ref{eq:ns01})~--~(\ref{eq:ns04}) by adding a source term to the right-hand side of each equation, so the modified set of equations conveniently has the analytical solution chosen \textit{a priori}.

\citet{Roy2002} introduce the general form of the two-dimensional primitive manufactured solution variables to be  a function of sines and cosines in $x$ and $y$. In this work, \citet{Roy2002}'s manufactured solutions are modified in order to address temporal accuracy as well:
\begin{equation}
 \label{eq:manufactured01}
  \phi (x,y,t) = \phi_0+ \phi_x\, f_s \left(\frac{a_{\phi x} \pi x}{L} \right) +  \phi_y \,f_s\left(\frac{a_{\phi y} \pi y}{L}\right) + \phi_t \,f_s\left(\frac{a_{\phi t} \pi t}{L}\right),
\end{equation}
where $\phi=\rho,u,v,p$ or $\sa$, and $f_s(\cdot)$ functions denote either sine or cosine function. Note that in this case, $\phi_x$, $\phi_y$  and $\phi_t$ are constants  and the subscripts do not denote differentiation.

The manufactured analytical solutions (\ref{eq:manufactured01}) for each one of the variables in two-dimensional case of FANS equations with SA turbulence model~are:
 \begin{equation}
 \begin{split}
\label{eq:manufactured_2d}
\rho\left(x,y,t\right) &=  \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho y} \pi y}{L}\right)+ \rho_t \sin\left(\dfrac{a_{\rho t} \pi t}{L}\right),\\
u\left(x,y,t\right) &= u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u y} \pi y}{L}\right) + u_t \cos\left(\dfrac{a_{u t} \pi t}{L}\right),\\
v\left(x,y,t\right) &= v_{0}+v_{x} \cos\left(\frac{a_{v x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v y} \pi y}{L}\right)+ v_t \sin\left(\dfrac{a_{v t} \pi t}{L}\right),\\
p\left(x,y,t\right) &= p_{0}+p_{x} \cos\left(\frac{a_{p x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p y} \pi y}{L}\right)+ p_t \cos\left(\dfrac{a_{p t} \pi t}{L}\right),\\
\sa(x,y,t) &= \nu_{\tsa 0} +\nu_{\tsa x} \cos\left(\frac{a_{\sa x} \pi x}{L}\right) + \nu_{\tsa y} \cos\left(\frac{a_{\sa y} \pi y}{L}\right) + \nu_{\tsa t}\cos\left(\frac{a_{\sa t} \pi t}{L}\right).
\end{split}
\end{equation}

Source terms  for mass conservation ($Q_\rho$), momentum ($Q_u$, and $Q_v$), total energy ($Q_{E}$) and SA variable ($Q_{\sa}$) equations are obtained by symbolic manipulations of FANS equations with SA turbulence model above using Maple~13~\citep{Maple} and are presented in the following sections.



 \subsection{2D FANS Equations and SA Turbulence Model}\label{NS+SA}



MMS applied to the 2D transient FANS equations with SA turbulent model simply consists in modifying Equations~(\ref{eq:ns01}) -- (\ref{eq:ns04}) by adding a source term to the right-hand side of each equation:
 \begin{equation}
 \begin{split} \label{eq:ns2d_mod}
 &\Diff{\bar{\rho}}{t} +\nabla \cdot \left(\bar{\rho} \tilde{\bv{u}}\right) = Q_{\brho},\\
 &\Diff{\bar{\rho} \tilde{\bv{u}}}{t} +\nabla\cdot\left(\bar{\rho} \tilde{\bv{u}}\tilde{\bv{u}}\right) +\nabla \bar{p} -  \nabla \cdot ( 2(\bmu+\mu_t) \tilde{\bv{S}} )= Q_{\bv{\tu}},\\
 & \Diff{\bar{\rho} \tilde{E}}{t}+ \nabla \cdot (\bar{\rho} \tilde{\bv{u}} \tilde{H})-\nabla \cdot \bar{\bv{q}} - \nabla\cdot(2 (\bmu+\mu_t) \tilde{\bv{S}} \cdot \tilde{\bv{u}})= Q_{\tE},\\
 &\Diff{\bar{\rho} \sa}{t} +\nabla \cdot (\bar{\rho} \tilde{\bv{u}} \sa) - c_{b1} S_\tsa \bar{\rho} \sa +c_{w1} f_w \brho \left(\dfrac{\sa}{d}\right)^2 - \dfrac{1}{\sigma}\nabla \cdot \left( (\bmu+\bar{\rho}  \sa) \nabla \sa\right) -\dfrac{c_{b2} \bar{\rho} }{\sigma} \nabla \sa \cdot \nabla \sa =Q_{\sa},
 \end{split}
 \end{equation}
so the modified set of Equations (\ref{eq:ns2d_mod}) has Equation (\ref{eq:manufactured_2d}) as analytical solution.

Recall that the averaged kinematic viscosity, total energy per unit mass and the total enthalpy per unit mass are given, respectively, by:
\begin{equation}
 \begin{split}\label{eq:closure01}
  \tilde{\nu}=\dfrac{\bar{\mu}}{\bar{\rho}},\qquad \tilde{E}=\tilde{e}+\dfrac{\tilde{\bv{u}}\cdot \tilde{\bv{u}}}{2}, \quad \tilde{H}=\tilde{h}+\dfrac{\tilde{\bv{u}}\cdot \tilde{\bv{u}}}{2},
 \end{split}
\end{equation}
with $\tilde{e}$ and $\tilde{h}$ defined in Equation (\ref{eq:closure}). The averaged absolute viscosity $\bmu$ is assumed to be constant.

 The laminar mean heat-flux vector $\bar{\bv{q}}=(\bar{q}_x,\bar{q}_y)$ is given by:
%
\begin{equation}\label{eq:closure02}
 \bar{q}_x = \left(\dfrac{\bar{\mu}}{\Pr}+\dfrac{\mu_t}{\Pr_t}\right)\diff{\tilde{h}}{x}\quad \mbox{and} \quad \bar{q}_y = \left(\dfrac{\bar{\mu}}{\Pr}+\dfrac{\mu_t}{\Pr_t}\right)\diff{\tilde{h}}{y},
 \end{equation}
where the Prandtl number, $\Pr$, and the turbulent Prandtl number, $\Pr_t$, are also assumed to be constant.

Additionally, $\Omega$ and $\tilde{\bv{S}}$ in expression (\ref{eq:closure}) are:
\begin{gather*}
\label{eq:closure03}
 \Omega = \sqrt{\left( \diff{\tilde{u}}{y} - \diff{\tilde{v}}{x}\right)^2} \quad \mbox{and}\quad 
\tilde{\bv{S}}=\left[
\begin{array}{cc}
\tS_{xx} & \tS_{xy}\\
\tS_{yx} & \tS_{yy}
\end{array}\right] , 
\end{gather*}
with
\begin{equation*}
\tS_{xx}= \diff{\tilde{u}}{x}-\dfrac{1}{3} \nabla \cdot \tilde{\bv{u}},\quad \tS_{yy}= \diff{\tilde{v}}{y}-\dfrac{1}{3} \nabla \cdot \tilde{\bv{u}}, \quad \tS_{xy}= \tS_{yx}= \left( \diff{\tilde{u}}{y} + \diff{\tilde{v}}{x}\right).\\
\end{equation*}

% and  variable $\tilde{\bv{S}} $ ($\tS_{ij}$ in Equation. \ref{eq:closure05}) is the instantaneous viscous stress tensor:
% \begin{equation}\label{eq:closure06}
% \tS_{xx}= \diff{\tilde{u}}{x}-\dfrac{1}{3} \nabla \cdot \tilde{\bv{u}},\quad
% \tS_{yy}= \diff{\tilde{v}}{y}-\dfrac{1}{3} \nabla \cdot \tilde{\bv{u}}, \quad
% \tS_{xy}= \tS_{yx}= \left( \diff{\tilde{u}}{y} + \diff{\tilde{v}}{x}\right),
% \end{equation}



Source terms $Q_{\brho}$, $Q_{\tu}$, $Q_{\tv}$, $Q_{\tE}$ and $Q_{\sa}$ are presented in the subsequent sessions with the use of the auxiliary variables:
\begin{equation}
 \begin{split}
\label{eq:aux_2d}
\Rho &= \rho_{0}+ \rho_{x} \sin\left(\frac{a_{ \rho x} \pi x}{L}\right)+ \rho_{y} \cos\left(\frac{a_{ \rho y} \pi y}{L}\right)+ \rho_t \sin\left(\dfrac{a_{\rho t} \pi t}{L}\right),\\
\U &= u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)+u_{y} \cos\left(\frac{a_{u y} \pi y}{L}\right) + u_t \cos\left(\dfrac{a_{u t} \pi t}{L}\right),\\
\V &= v_{0}+v_{x} \cos\left(\frac{a_{v x} \pi x}{L}\right)+v_{y} \sin\left(\frac{a_{v y} \pi y}{L}\right)+ v_t \sin\left(\dfrac{a_{v t} \pi t}{L}\right),\\
\PP &= p_{0}+p_{x} \cos\left(\frac{a_{p x} \pi x}{L}\right)+p_{y} \sin\left(\frac{a_{p y} \pi y}{L}\right)+ p_t \cos\left(\dfrac{a_{p t} \pi t}{L}\right),\\
\Nu &= \nu_{\tsa 0} +\nu_{\tsa x} \cos\left(\frac{a_{\sa x} \pi x}{L}\right) + \nu_{\tsa y} \cos\left(\frac{a_{\sa y} \pi y}{L}\right) + \nu_{\tsa t}\cos\left(\frac{a_{\sa t} \pi t}{L}\right).
\end{split}
\end{equation}


\subsubsection{2D FANS Mass Conservation}

The 2D Favre-averaged mass conservation equation written as an operator is:
\begin{equation*}
  \Lo=\Diff{\brho }{t} +  \Diff{\brho \tu}{x}+\Diff{\brho \tv}{y}.
\end{equation*}

Analytically differentiating Equation (\ref{eq:manufactured_2d}) for $\brho$, $\tu$ and $\tv$ using operator $\Lo$ defined above gives  the source term~$Q_{\brho}$:
\begin{equation}
 \begin{split}
Q_{\brho} &= \dfrac{a_{\rho x} \pi \rho_x \U }{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+\\
&-\dfrac{a_{\rho y} \pi \rho_y \V }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+\\
&+\dfrac{\pi \Rho}{L}\left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right] +\\
&+\dfrac{a_{\rho t} \pi \rho_t }{L}\cos\left(\dfrac{a_{\rho t} \pi t}{L}\right).
 \end{split}
\end{equation}
where $\Rho,\,\U$ and $\V$ are given in Equation (\ref{eq:aux_2d}).

\subsubsection{2D FANS Momentum Conservation}

For the generation of the analytical source term $Q_{\tu}$ for the Favre-averaged $x$-momentum equation, the first component of Equation~(\ref{eq:ns02}) is written as an  operator $\Lo$:
\begin{equation*}
 \Lo= \Diff{\brho \tu}{t} +\Diff{\brho \tu^2 }{x}+\Diff{\brho \tu\tv}{y} +\Diff{\bp}{x}-\Diff{2(\bmu+\mu_t)\tS_{xx}}{x}-\Diff{2(\bmu+\mu_t)\tS_{xy}}{y},
\end{equation*}
which, when operated in Equation (\ref{eq:manufactured_2d}), provides source term $Q_{\tu}$:
\begin{equation}
 \begin{split}
 Q_{\tu} &= \dfrac{a_{\rho x} \pi \rho_x \U^2 }{L} \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \,\,-\,\,\dfrac{a_{\rho y} \pi \rho_y \U \V  }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+ \\
&-\dfrac{a_{uy} \pi u_y \Rho \V  }{L}\sin\left(\dfrac{a_{uy} \pi y}{L}\right)\,\,+\,\, \dfrac{\pi \Rho \U}{L}\left[2 a_{ux} u_x  \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y  \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right]+ \\
&-\dfrac{a_{px} \pi p_x  }{L}\sin\left(\dfrac{a_{px} \pi x}{L}\right)+ \\
&+\dfrac{f_{v1} \pi^2 \Rho \Nu}{L^2}\left[\nicefrac{4}{3} \; a_{ux}^2 u_x  \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{uy}^2 u_y  \cos\left(\dfrac{a_{uy} \pi y}{L}\right)\right] + \\
&+\dfrac{f_{v1} \pi^2 \Rho}{L^2}\left[\nicefrac{4}{3} \; a_{ux} a_{\nu_{sa} x} u_x \nu_{sa x}  \cos\left(\dfrac{a_{ux} \pi x}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} x} \pi x}{L}\right)- a_{uy} a_{\nu_{sa} y} u_y \nu_{sa y} \sin\left(\dfrac{a_{uy} \pi y}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} y} \pi y}{L}\right)\right.+\\
    &\qquad\left.- a_{vx} a_{\nu_{sa} y} v_x \nu_{sa y} \sin\left(\dfrac{a_{vx} \pi x}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} y} \pi y}{L}\right)-\nicefrac{2}{3} \;  a_{vy} a_{\nu_{sa} x} v_y \nu_{sa x} \cos\left(\dfrac{a_{vy} \pi y}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} x} \pi x}{L}\right)\right] + \\
&+\dfrac{f_{v1} \pi^2 \Nu}{L^2}\left[-\nicefrac{4}{3} \; a_{\rho x} a_{ux} \rho_x u_x  \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)  \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+\nicefrac{2}{3} \; a_{\rho x} a_{vy} \rho_x v_y  \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)  \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right.+\\
    &\qquad\left.-a_{\rho y} a_{uy} \rho_y u_y  \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)  \sin\left(\dfrac{a_{uy} \pi y}{L}\right)-a_{\rho y} a_{vx} \rho_y v_x  \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)  \sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right] + \\
&+\dfrac{\pi^2 \bmu}{3L^2}\left[\dfrac{c_{v1}^3 }{ \chi^3+c_{v1}^3} +f_{v1}\right]\left[4 a_{ux}^2 u_x  \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+3 a_{uy}^2 u_y  \cos\left(\dfrac{a_{uy} \pi y}{L}\right)\right] +\\
&+\dfrac{a_{\rho t} \pi \rho_t \U  }{L}\cos\left(\dfrac{a_{\rho t} \pi t}{L}\right)+ \\
&-\dfrac{a_{ut} \pi u_t \Rho  }{L}\sin\left(\dfrac{a_{ut} \pi t}{L}\right),
 \end{split}
\end{equation}
where
\begin{equation}\label{eq:chi}
  f_{v1} = \dfrac{\chi^3}{\chi^3+c_{v1}^3}\quad \mbox{and}\quad \chi =\dfrac{\Nu}{\tilde{\nu}} =\dfrac{\Rho \Nu}{\bmu},
\end{equation}
and $\Rho,\,\U,\,\V$ and $\Nu$ are given in Equation (\ref{eq:aux_2d}).


Analogously, for the generation of the analytical source term $Q_{\tv}$ for the Favre-averaged $y$-momentum equation, the second component of Equation  (\ref{eq:ns02})  is written as an  operator $\Lo$:
\begin{equation*}
 \Lo =\Diff{\brho \tv}{t} +\Diff{\brho \tu\tv}{x}+\Diff{\brho \tv^2}{y} +\Diff{\bp}{y}-\Diff{2(\bmu+\mu_t)\tS_{yx}}{x}-\Diff{2(\bmu+\mu_t)\tS_{yy}}{y},
\end{equation*}
and then applied to Equation  (\ref{eq:manufactured_2d}). It yields:

\begin{equation}
 \begin{split}
Q_{\tv} &= \dfrac{a_{\rho x} \pi \rho_x \U \V  }{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \,\,-\,\,\dfrac{a_{\rho y} \pi \rho_y \V^2 }{L} \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+ \\
&-\dfrac{a_{vx} \pi v_x \Rho \U  }{L}\sin\left(\dfrac{a_{vx} \pi x}{L}\right) \,\,+\,\,\dfrac{ \pi \Rho \V}{L}\left[a_{ux} u_x  \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+2 a_{vy} v_y  \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right]+ \\
&+\dfrac{a_{py} \pi p_y  }{L}\cos\left(\dfrac{a_{py} \pi y}{L}\right)+ \\
&+\dfrac{f_{v1} \pi^2 \Rho \Nu}{L^2}\left[a_{vx}^2 v_x  \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+\nicefrac{4}{3} \; a_{vy}^2 v_y  \sin\left(\dfrac{a_{vy} \pi y}{L}\right)\right] + \\
&+\dfrac{f_{v1} \pi^2 \Rho}{L^2}\left[-\nicefrac{2}{3} \; a_{ux} a_{\nu_{sa} y} u_x \nu_{sa y}  \cos\left(\dfrac{a_{ux} \pi x}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} y} \pi y}{L}\right)- a_{uy} a_{\nu_{sa} x} u_y \nu_{sa x} \sin\left(\dfrac{a_{uy} \pi y}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} x} \pi x}{L}\right)\right.+\\
    &\qquad -\left. a_{vx} a_{\nu_{sa} x} v_x \nu_{sa x} \sin\left(\dfrac{a_{vx} \pi x}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} x} \pi x}{L}\right)+\nicefrac{4}{3} \;  a_{vy} a_{\nu_{sa} y} v_y \nu_{sa y} \cos\left(\dfrac{a_{vy} \pi y}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} y} \pi y}{L}\right)\right] + \\
&+\dfrac{f_{v1} \pi^2 \Nu }{L^2}\left[a_{\rho x} a_{uy} \rho_x u_y  \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)  \sin\left(\dfrac{a_{uy} \pi y}{L}\right)+a_{\rho x} a_{vx} \rho_x v_x  \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)  \sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right.+\\
    &\qquad\left. -\nicefrac{2}{3} \; a_{\rho y} a_{ux} \rho_y u_x  \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)  \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+\nicefrac{4}{3} \; a_{\rho y} a_{vy} \rho_y v_y  \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)  \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right] + \\
&+ \dfrac{\pi^2 \bmu}{3L^2}\left[\dfrac{c_{v1}^3 }{ \chi^3+c_{v1}^3} +f_{v1}\right]\left[3 a_{vx}^2 v_x  \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+4 a_{vy}^2 v_y  \sin\left(\dfrac{a_{vy} \pi y}{L}\right)\right] +\\
&+\dfrac{a_{\rho t} \pi \rho_t \V}{L}  \cos\left(\dfrac{a_{\rho t} \pi t}{L}\right)+ \\
&+\dfrac{a_{vt} \pi v_t \Rho }{L} \cos\left(\dfrac{a_{vt} \pi t}{L}\right),
 \end{split}
\end{equation}
where $\chi$ and $f_{v1}$ are given in  Equation (\ref{eq:chi}), and  $\Rho,\,\U,\,\V$ and $\Nu$ are given in Equation (\ref{eq:aux_2d}).


\subsubsection{2D FANS Total Energy Conservation}

The operator for the 2D  Favre-averaged total energy is:
\begin{equation*}
\begin{split}
\Lo&=  \Diff{\brho \tE }{t}+ \Diff{\brho \tu \tE }{x}+\Diff{\brho \tv \tE}{y}+\Diff{\bp\tu}{x} +\Diff{\bp\tv}{y} - \Diff{\bq_x}{x} -\Diff{\bq_y}{y} +\\
  &-\Diff{2(\bmu+\mu_t)\tu \tS_{xx}}{x}-\Diff{2(\bmu+\mu_t)\tv \tS_{xy}}{x}-\Diff{2(\bmu+\mu_t) \tu \tS_{yx}}{y}-\Diff{2(\bmu+\mu_t)\tv \tS_{yy}}{y}.
\end{split}
\end{equation*}

Source term $Q_{\tE}$ is obtained by operating $\Lo$ on Equation  (\ref{eq:manufactured_2d}) together with the use of the  auxiliary relations for energy given in Equations (\ref{eq:closure}), (\ref{eq:closure01}) and (\ref{eq:closure02}). It yields:

\begin{equation*}
 \begin{split}
Q_{\tE}&= \dfrac{ a_{\rho x} \pi \rho_x \U(\U^2+\V^2) }{2L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)\quad -\quad \dfrac{ a_{\rho y} \pi \rho_y \V(\U^2+ \V^2) }{2L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)\quad +\quad \dfrac{a_{\rho t} \pi \rho_t (\U^2+\V^2) }{2L}\cos\left(\dfrac{a_{\rho t} \pi t}{L}\right)+\\
&-\dfrac{c_p a_{px} \pi p_x \U }{LR}\sin\left(\dfrac{a_{px} \pi x}{L}\right)\quad+\quad\dfrac{c_p a_{py} \pi p_y \V }{LR}\cos\left(\dfrac{a_{py} \pi y}{L}\right)+\\
&+\dfrac{c_p \pi \PP}{LR}\left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right] \,\,+\,\,\dfrac{c_v a_{\rho t} \pi \rho_t \PP }{L R \Rho}\cos\left(\dfrac{a_{\rho t} \pi t}{L}\right) +\\
&-\dfrac{a_{ut} \pi u_t \Rho \U }{L}\sin\left(\dfrac{a_{ut} \pi t}{L}\right)\quad+\quad\dfrac{a_{vt} \pi v_t \Rho \V }{L}\cos\left(\dfrac{a_{vt} \pi t}{L}\right)+\\
&+ \dfrac{\pi^2  \U \mu_t}{L^2}\left[\nicefrac{4}{3}\, a_{ux}^2 u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{uy}^2 u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)\right]+\\
&+\dfrac{\pi^2  \V \mu_t}{L^2}\left[a_{vx}^2 v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+\nicefrac{4}{3}\, a_{vy}^2 v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)\right] +\\
&+\cdots
 \end{split}
\end{equation*}
\begin{equation}\label{eq:ns_2d_e}
\begin{split}
&+\cdots\\
&+\dfrac{\pi^2 \mu_t}{L^2}\left[-\nicefrac{4}{3}\, a_{ux}^2 u_x^2 \cos\left(\dfrac{a_{ux} \pi x}{L}\right)^2+\nicefrac{4}{3}\, a_{ux} a_{vy} u_x v_y \cos\left(\dfrac{a_{ux} \pi x}{L}\right) \cos\left(\dfrac{a_{vy} \pi y}{L}\right)-a_{uy}^2 u_y^2 \sin\left(\dfrac{a_{uy} \pi y}{L}\right)^2\right.+\\
   &\qquad\left.-2 a_{uy} a_{vx} u_y v_x \sin\left(\dfrac{a_{uy} \pi y}{L}\right) \sin\left(\dfrac{a_{vx} \pi x}{L}\right)-a_{vx}^2 v_x^2 \sin\left(\dfrac{a_{vx} \pi x}{L}\right)^2-\nicefrac{4}{3}\, a_{vy}^2 v_y^2 \cos\left(\dfrac{a_{vy} \pi y}{L}\right)^2\right] +\\
&+\dfrac{\pi^2 f_{v1} \Rho \U}{L^2}\left[\nicefrac{4}{3}\, a_{ux} a_{\sa x} u_x \nu_{sa x} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) \sin\left(\dfrac{a_{\sa x} \pi x}{L}\right)-a_{uy} a_{\sa y} u_y \nu_{sa y} \sin\left(\dfrac{a_{uy} \pi y}{L}\right) \sin\left(\dfrac{a_{\sa y} \pi y}{L}\right)\right.+\\
     &\qquad\left.-a_{vx} a_{\sa y} v_x \nu_{sa y} \sin\left(\dfrac{a_{vx} \pi x}{L}\right) \sin\left(\dfrac{a_{\sa y} \pi y}{L}\right)-\nicefrac{2}{3}\, a_{vy} a_{\sa x} v_y \nu_{sa x} \cos\left(\dfrac{a_{vy} \pi y}{L}\right) \sin\left(\dfrac{a_{\sa x} \pi x}{L}\right)\right] +\\
&+\dfrac{ \pi^2 f_{v1} \Rho \V}{L^2}\left[-\nicefrac{2}{3}\, a_{ux} a_{\sa y} u_x \nu_{sa y} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) \sin\left(\dfrac{a_{\sa y} \pi y}{L}\right)-a_{uy} a_{\sa x} u_y \nu_{sa x} \sin\left(\dfrac{a_{uy} \pi y}{L}\right) \sin\left(\dfrac{a_{\sa x} \pi x}{L}\right)\right.+\\
    &\qquad\left.-a_{vx} a_{\sa x} v_x \nu_{sa x} \sin\left(\dfrac{a_{vx} \pi x}{L}\right) \sin\left(\dfrac{a_{\sa x} \pi x}{L}\right)+\nicefrac{4}{3}\, a_{vy} a_{\sa y} v_y \nu_{sa y} \cos\left(\dfrac{a_{vy} \pi y}{L}\right) \sin\left(\dfrac{a_{\sa y} \pi y}{L}\right)\right]+\\
&+\dfrac{\pi^2 f_{v1} \U \Nu}{L^2}\left[-\nicefrac{4}{3}\, a_{\rho x} a_{ux} \rho_x u_x \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+\nicefrac{2}{3}\, a_{\rho x} a_{vy} \rho_x v_y \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right.+\\
    &\qquad\left.-a_{\rho y} a_{uy} \rho_y u_y \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \sin\left(\dfrac{a_{uy} \pi y}{L}\right)-a_{\rho y} a_{vx} \rho_y v_x \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right] +\\
&+\dfrac{\pi^2 f_{v1} \V \Nu}{L^2}\left[a_{\rho x} a_{uy} \rho_x u_y \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \sin\left(\dfrac{a_{uy} \pi y}{L}\right)+a_{\rho x} a_{vx} \rho_x v_x \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right.+\\
    &\qquad\left.-\nicefrac{2}{3}\, a_{\rho y} a_{ux} \rho_y u_x \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+\nicefrac{4}{3}\, a_{\rho y} a_{vy} \rho_y v_y \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right] +\\
&-\dfrac{\pi^2 \bmu}{3L^2}\left[\dfrac{c_{v1}^3 }{\chi^3+c_{v1}^3}+f_{v1}\right] \left[4 a_{ux}^2 u_x^2 \cos\left(\dfrac{a_{ux} \pi x}{L}\right)^2-4 a_{ux} a_{vy} u_x v_y \cos\left(\dfrac{a_{ux} \pi x}{L}\right) \cos\left(\dfrac{a_{vy} \pi y}{L}\right)+3 a_{uy}^2 u_y^2 \sin\left(\dfrac{a_{uy} \pi y}{L}\right)^2\right.+\\
    &\qquad\left.+6 a_{uy} a_{vx} u_y v_x \sin\left(\dfrac{a_{uy} \pi y}{L}\right) \sin\left(\dfrac{a_{vx} \pi x}{L}\right)+3 a_{vx}^2 v_x^2 \sin\left(\dfrac{a_{vx} \pi x}{L}\right)^2+4 a_{vy}^2 v_y^2 \cos\left(\dfrac{a_{vy} \pi y}{L}\right)^2\right] +\\
&+ \dfrac{ \pi^2 \bmu \U}{3L^2}\left[\dfrac{c_{v1}^3 }{ \chi^3+c_{v1}^3} +f_{v1}\right] \left[4 a_{ux}^2 u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)+3 a_{uy}^2 u_y \cos\left(\dfrac{a_{uy} \pi y}{L}\right)\right]+\\
&+ \dfrac{\pi^2 \bmu \V}{3L^2}\left[\dfrac{c_{v1}^3 }{ \chi^3+c_{v1}^3} +f_{v1}\right] \left[3 a_{vx}^2 v_x \cos\left(\dfrac{a_{vx} \pi x}{L}\right)+4 a_{vy}^2 v_y \sin\left(\dfrac{a_{vy} \pi y}{L}\right)\right] +\\
&+\dfrac{\pi \Rho \U^2}{2L} \left[3 a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right] +\\
&-\dfrac{\pi \Rho \U \V}{L}\left[a_{uy} u_y \sin\left(\dfrac{a_{uy} \pi y}{L}\right)+a_{vx} v_x \sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right] +\\
&+\dfrac{ \pi \Rho \V^2}{2L} \left[a_{ux} u_x \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+3 a_{vy} v_y \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right]+\\
&- \dfrac{c_p \pi^2}{L^2 R \Rho \Nu}\dfrac{\mu_t}{\Pr_t}\left[a_{px} a_{\sa x} p_x \nu_{sa x} \sin\left(\dfrac{a_{px} \pi x}{L}\right) \sin\left(\dfrac{a_{\sa x} \pi x}{L}\right)-a_{py} a_{\sa y} p_y \nu_{sa y} \cos\left(\dfrac{a_{py} \pi y}{L}\right) \sin\left(\dfrac{a_{\sa y} \pi y}{L}\right)\right]+\\
 &- \dfrac{c_p \pi^2 \PP}{L^2 R \Rho^2 \Nu}\dfrac{\mu_t}{\Pr_t} \left[a_{\rho x} a_{\sa x} \rho_x \nu_{sa x} \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \sin\left(\dfrac{a_{\sa x} \pi x}{L}\right)-a_{\rho y} a_{\sa y} \rho_y \nu_{sa y} \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \sin\left(\dfrac{a_{\sa y} \pi y}{L}\right)\right] +\\
 &-\dfrac{c_p \pi^2}{ L^2 R \Rho^2}\left[\dfrac{\mu_t}{\Pr_t}+\dfrac{2\bmu}{\Pr}\right]\left[a_{px} a_{\rho x} \rho_x p_x \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right) \sin\left(\dfrac{a_{px} \pi x}{L}\right)+a_{py} a_{\rho y} \rho_y p_y \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right) \cos\left(\dfrac{a_{py} \pi y}{L}\right)\right] +\\
 &-\dfrac{c_p \pi^2 \PP}{ L^2 R \Rho^3}\left[\dfrac{\mu_t}{\Pr_t}+\dfrac{2\bmu}{\Pr}\right]\left[a_{\rho x}^2 \rho_x^2 \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)^2+a_{\rho y}^2 \rho_y^2 \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)^2\right] +\\
 &+\dfrac{c_p \pi^2}{L^2 R \Rho}\left[\dfrac{\mu_t}{\Pr_t}+\dfrac{\bmu}{\Pr}\right] \left[a_{px}^2 p_x \cos\left(\dfrac{a_{px} \pi x}{L}\right)+a_{py}^2 p_y \sin\left(\dfrac{a_{py} \pi y}{L}\right)\right] +\\
%
&-\dfrac{c_p \pi^2 \PP}{L^2 R \Rho^2}\left[\dfrac{\mu_t}{\Pr_t}+\dfrac{\bmu}{\Pr}\right] \left[a_{\rho x}^2 \rho_x \sin\left(\dfrac{a_{\rho x} \pi x}{L}\right)+a_{\rho y}^2 \rho_y \cos\left(\dfrac{a_{\rho y} \pi y}{L}\right)\right],
 \end{split}
\end{equation}
where  $\Rho,\,\PP,\, \U,\,\V$ and $\Nu$ are given in Equation (\ref{eq:aux_2d}),  $\chi$ and $f_{v1}$ are given in  Equation (\ref{eq:chi}),   and  $$\mu_t= f_{v1} \Rho \Nu.$$


\subsubsection{2D SA Transport Equation}

The operator for the viscosity-like baseline compressible Spalart-Allmaras equation is:
\begin{equation*}
\begin{split}
\Lo&=  \Diff{\brho \sa }{t}+ \Diff{\brho \tu \sa }{x}+\Diff{\brho \tv \sa}{y}- c_{b1} S_\tsa \bar{\rho} \sa +c_{w1} f_w \brho \left(\dfrac{\sa}{d}\right)^2 +\\
   &- \dfrac{1 }{\sigma}\left[\diff{}{x}\left((\bmu+\bar{\rho} \sa) \diff{\sa}{x}\right)+\diff{}{y}\left((\bmu+\bar{\rho} \sa) \diff{\sa}{y}\right)\right] -\dfrac{c_{b2} \bar{\rho} }{\sigma} \left[ \left(\diff{\sa}{x}\right)^2 + \left(\diff{\sa}{y}\right)^2\right].
\end{split}
\end{equation*}

Source term $Q_{\sa}$ is obtained by operating $\Lo$ on Equation  (\ref{eq:manufactured_2d}) together with the use of the  auxiliary relations given in Equation (\ref{eq:closure}). It yields:

\begin{equation}
 \begin{split}
  Q_{\sa} &= \dfrac{a_{\rho x} \pi \rho_x \U \Nu  }{L}\cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)+ \\
&-\dfrac{a_{\rho y} \pi \rho_y \V \Nu }{L}\sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)+ \\
&-\dfrac{a_{\nu_{sa} x} \pi \nu_{sa x} \Rho \U }{L}\sin\left(\dfrac{a_{\nu_{sa} x} \pi x}{L}\right)+ \\
&-\dfrac{a_{\nu_{sa} y} \pi \nu_{sa y} \Rho \V }{L}\sin\left(\dfrac{a_{\nu_{sa} y} \pi y}{L}\right)+ \\
&-\dfrac{(1+c_{b2}) \pi^2 \Rho}{L^2 \sigma}\left[a_{\nu_{sa} x}^2 \nu_{sa x}^2  \sin\left(\dfrac{a_{\nu_{sa} x} \pi x}{L}\right)^2+a_{\nu_{sa} y}^2 \nu_{sa y}^2  \sin\left(\dfrac{a_{\nu_{sa} y} \pi y}{L}\right)^2\right]+\\
&+\dfrac{\pi^2 \Nu}{ L^2\sigma}\left[a_{\rho x} a_{\nu_{sa} x} \rho_x \nu_{sa x}  \cos\left(\dfrac{a_{\rho x} \pi x}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} x} \pi x}{L}\right)-a_{\rho y} a_{\nu_{sa} y} \rho_y \nu_{sa y}  \sin\left(\dfrac{a_{\rho y} \pi y}{L}\right)  \sin\left(\dfrac{a_{\nu_{sa} y} \pi y}{L}\right)\right] +\\
 &+\dfrac{\pi \Rho \Nu}{L}\left[a_{ux} u_x  \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+a_{vy} v_y  \cos\left(\dfrac{a_{vy} \pi y}{L}\right)\right] + \\
 &+\dfrac{(\Rho \Nu+\bmu) \pi^2}{L^2 \sigma}\left[a_{\nu_{sa} x}^2 \nu_{sa x}  \cos\left(\dfrac{a_{\nu_{sa} x} \pi x}{L}\right)+a_{\nu_{sa} y}^2 \nu_{sa y}  \cos\left(\dfrac{a_{\nu_{sa} y} \pi y}{L}\right)\right]+\\
&+ \dfrac{a_{\rho t} \pi \rho_t \Nu}{L} \cos\left(\dfrac{a_{\rho t} \pi t}{L}\right)+\\
&- \dfrac{a_{\nu_{sa}t} \pi \nu_{sa_t}}{L} \Rho \sin\left(\dfrac{a_{\nu_{sa} t} \pi t}{L}\right)+\\
&-c_{b1} S_{\mathrm{sa}} \Rho \Nu+\\
&+c_{w1} f_w \Rho \left(\dfrac{\Nu}{d}\right)^2,
 \end{split}
\end{equation}
where $\Rho,\, \U,\,\V$ and $\Nu$ are defined in (\ref{eq:aux_2d}) and
\begin{equation}
 \begin{split}
&S_{\mathrm{sa}} = \Omega + \frac{\Nu}{\kappa^2 d^2} f_{v2}, \quad \Omega = \sqrt{\left[ \dfrac{a_{uy}\pi u_y}{L}  \sin\left(\dfrac{a_{uy} \pi y}{L}\right)- \dfrac{a_{vx}\pi v_x}{L}  \sin\left(\dfrac{a_{vx} \pi x}{L}\right)\right]^2}, \\
&f_{v2} = 1 - \frac{\chi}{1 + \chi f_{v1}}, \quad f_{v1} = \frac{\chi^3}{\chi^3 + c_{v1}^3}, \quad \chi = \dfrac{\Rho \Nu}{\bmu}, \\
&f_w = g \left( \frac{1 + c_{w3}^6}{g^6 + c_{w3}^6} \right)^{1/6}, \quad g = r + c_{w2} \left( r^6 - r \right), \quad r = \frac{\Nu}{S_{\mathrm{sa}} \kappa^2 d^2}.
 \end{split}
\end{equation}


\section{Comments}
The complexity, and consequently length, of the source terms increase with both dimension and physics handled by the governing equations. 
Applying commands in order to simplify extensive expressions is challenging even with a high performance workstation; thus, a suitable alternative to this issue is to simplify each equation by dividing it into a combination of sub-operators handling different physical phenomena. Then, each one of the operators may be applied to the manufactured solutions individually, and the resulting sub-source terms are combined back to represent the source term for the original equation.


For instance, instead of writing the two-dimensional FANS SA equation using one single operator~$\Lo$:
 \begin{equation} \label{eq:ns2d05}
\Lo=\Diff{\bar{\rho} \sa}{t} +\nabla \cdot (\bar{\rho} \tilde{\bv{u}} \sa) - c_{b1} S_\tsa \bar{\rho} \sa +c_{w1} f_w \brho \left(\dfrac{\sa}{d}\right)^2 - \dfrac{1}{\sigma}\nabla \cdot \left( (\bmu+\bar{\rho}  \sa) \nabla \sa\right) -\dfrac{c_{b2} \bar{\rho} }{\sigma} \nabla \sa \cdot \nabla \sa
\end{equation}
to then be used in the MMS, let Equation (\ref{eq:ns2d05}) be written with six operators:
\begin{equation}
 \begin{split}\label{sub01}
  \Lo_1&=\Diff{\bar{\rho} \sa}{t},\qquad\qquad\qquad\qquad\quad  \Lo_2=\nabla \cdot (\bar{\rho} \tilde{\bv{u}} \sa) ,\\
  \Lo_3&=- c_{b1} S_\tsa \bar{\rho} \sa ,\quad\quad\quad \qquad\qquad\Lo_4=c_{w1} f_w \brho \left(\dfrac{\sa}{d}\right)^2 ,\\
  \Lo_5&=- \dfrac{1}{\sigma}\nabla \cdot \left( (\bmu+\bar{\rho}  \sa) \nabla \sa\right) \quad\quad  \Lo_6= -\dfrac{c_{b2} \bar{\rho} }{\sigma} \nabla \sa \cdot \nabla \sa.
 \end{split}
\end{equation}

Naturally, $\Lo=\Lo_1+\Lo_2+\Lo_3+\Lo_4+\Lo_5+\Lo_6.$


 After the application of each sub-operator defined in (\ref{sub01}), the corresponding sub-source terms are also simplified, factorized and sorted. Then, the final factorized version is checked against the original one, in order to assure that not human error has been introduced.

An advantage of this strategy is the possibility of inclusion and/or removal of other physical effects without the need of re-doing previous manipulations. For instance, in order to simplify this model, assuming that the distance $d$ to the nearest wall is infinite, only changes should be made in only two operators:  $\Lo_3$ is simplified since $S_\tsa$ is reduced to $S_\tsa=\Omega$, and $\Lo_4=0$. The equations for conservation  of mass, momentum and total energy remain unchanged.


This strategy results in less time, decreases the computational effort and occasional software crashes, and also increases the flexibility in the code verification procedure.



\subsection{Boundary Conditions and C Files}
Additionally to verifying code capability of solving the governing equations accurately in the interior of the domain of interest, one may also verify the software capability of correctly imposing boundary conditions. Therefore, the gradients of the  analytical solutions (\ref{eq:manufactured_2d}) have been calculated:
\begin{equation*}
\nabla  \brho= \left[ \begin{array}{c}
 \dfrac{  a_{\rho x}  \pi \rho_x}{L} \cos\left( \dfrac{ a_{\rho x}  \pi  x}{L}\right)\vspace{5pt} \\
-\dfrac{  a_{\rho y}  \pi \rho_y}{L} \sin\left( \dfrac{ a_{\rho y}  \pi  y}{L}\right)
\end{array} \right],
\qquad
\nabla \bp = \left[ \begin{array}{c}
- \dfrac{  a_{px}  \pi p_x}{L} \sin\left( \dfrac{ a_{px}  \pi  x}{L}\right)\vspace{5pt}\\
  \dfrac{  a_{py}  \pi p_y}{L} \cos\left( \dfrac{ a_{py}  \pi  y}{L}\right)
\end{array} \right],
\quad
\nabla \tu = \left[ \begin{array}{c}
  \dfrac{  a_{ux}  \pi u_x}{L} \cos\left( \dfrac{ a_{ux}  \pi  x}{L}\right)\vspace{5pt}\\
 -   \dfrac{  a_{uy}  \pi u_y}{L} \sin\left( \dfrac{ a_{uy}  \pi  y}{L}\right)
\end{array} \right],
\end{equation*}
\begin{equation*}
\nabla  \tv= \left[ \begin{array}{c}
-  \dfrac{  a_{vx}  \pi v_x}{L}  \sin\left( \dfrac{ a_{vx}  \pi  x}{L}\right)\vspace{5pt}\\
    \dfrac{  a_{vy}  \pi v_y}{L} \cos\left( \dfrac{ a_{vy}  \pi  y}{L}\right)
\end{array} \right]
\quad\mbox{and}\quad
\nabla \sa = \left[ \begin{array}{c}
-\dfrac{  a_{\sa x}  \pi  \nu_{\tsa x} }{L} \sin\left(\frac{a_{\sa x} \pi x}{L}\right)\vspace{5pt}\\
-  \dfrac{  a_{\sa y}  \pi  \nu_{\tsa x}}{L}  \sin\left(\frac{a_{\sa y} \pi y}{L}\right)
\end{array} \right].
\end{equation*}
 and translated into $C$ codes:
\begin{verbatim}
grad_rho_an[0] = rho_x * cos(a_rhox * pi * x / L) * a_rhox * pi / L;
grad_rho_an[1] = -rho_y * sin(a_rhoy * pi * y / L) * a_rhoy * pi / L;
grad_p_an[0] = -p_x * sin(a_px * pi * x / L) * a_px * pi / L;
grad_p_an[1] = p_y * cos(a_py * pi * y / L) * a_py * pi / L;
grad_u_an[0] = u_x * cos(a_ux * pi * x / L) * a_ux * pi / L;
grad_u_an[1] = -u_y * sin(a_uy * pi * y / L) * a_uy * pi / L;
grad_v_an[0] = -v_x * sin(a_vx * pi * x / L) * a_vx * pi / L;
grad_v_an[1] = v_y * cos(a_vy * pi * y / L) * a_vy * pi / L;
grad_nu_sa_an[0] = -nu_sa_x * sin(a_nusax * pi * x / L) * a_nusax * pi / L;
grad_nu_sa_an[1] = -nu_sa_y * sin(a_nusay * pi * y / L) * a_nusay * pi / L;
\end{verbatim}

Files containing $C$ codes for the source terms have also been automatically generated. They are:\\ \texttt{FANS\_SA\_transient\_2d\_rho\_code.C, FANS\_SA\_transient\_2d\_u\_code.C, FANS\_SA\_transient\_2d\_v\_code.C,\\ FANS\_SA\_transient\_2d\_E\_code.C} and \texttt{FANS\_SA\_transient\_2d\_nu\_code.C}.

%\newpage
An example of the $C$ file from the source term $Q_{\sa}$ for the 2D Spalart-Allmaras equation is:
\begin{footnotesize}
\begin{verbatim}#include <math.h>

double SourceQ_nu (double x, double y, double t, double mu, double c_b1, double c_b2, double c_v1,
  double c_w1, double c_w2, double c_w3, double kappa, double d, double sigma)
{
  double Q_nu;
  double RHO;
  double U;
  double V;
  double NU_SA;
  double chi;
  double f_v1;
  double f_v2;
  double Omega;
  double Ssa;
  double r;
  double g;
  double f_w;
  NU_SA = nu_sa_0 + nu_sa_x * cos(a_nusax * PI * x / L) + nu_sa_y * cos(a_nusay * PI * y / L)
    + nu_sa_t * cos(a_nusat * PI * t / L);
  RHO = rho_0 + rho_x * sin(a_rhox * PI * x / L) + rho_y * cos(a_rhoy * PI * y / L)
    + rho_t * sin(a_rhot * PI * t / L);
  U = u_0 + u_x * sin(a_ux * PI * x / L) + u_y * cos(a_uy * PI * y / L) + u_t * cos(a_ut * PI * t / L);
  V = v_0 + v_x * cos(a_vx * PI * x / L) + v_y * sin(a_vy * PI * y / L) + v_t * sin(a_vt * PI * t / L);
  chi = NU_SA * RHO / mu;
  f_v1 = pow(chi, 0.3e1) / (pow(chi, 0.3e1) + pow(c_v1, 0.3e1));
  f_v2 = 0.1e1 - chi / (0.1e1 + chi * f_v1);
  Omega = PI * sqrt(pow(a_uy * u_y * sin(a_uy * PI * y / L)
    - a_vx * v_x * sin(a_vx * PI * x / L), 0.2e1) * pow(L, -0.2e1));
  Ssa = Omega + NU_SA * f_v2 * pow(kappa, -0.2e1) * pow(d, -0.2e1);
  r = NU_SA / Ssa * pow(kappa, -0.2e1) * pow(d, -0.2e1);
  g = r + c_w2 * (pow(r, 0.6e1) - r);
  f_w = g * pow((0.1e1 + pow(c_w3, 0.6e1)) / (pow(g, 0.6e1) + pow(c_w3, 0.6e1)), 0.1e1 / 0.6e1);

  Q_nu = (a_nusax * a_nusax * nu_sa_x * cos(a_nusax * PI * x / L)
    + a_nusay * a_nusay * nu_sa_y * cos(a_nusay * PI * y / L))
    * PI * PI * (NU_SA * RHO + mu) / sigma * pow(L, -0.2e1)
  - (a_nusax * a_nusax * nu_sa_x * nu_sa_x * pow(sin(a_nusax * PI * x / L), 0.2e1)
    + a_nusay * a_nusay * nu_sa_y * nu_sa_y * pow(sin(a_nusay * PI * y / L), 0.2e1))
    * PI * PI * RHO * (c_b2 + 0.1e1) / sigma * pow(L, -0.2e1)
  + a_rhox * PI * rho_x * U * NU_SA * cos(a_rhox * PI * x / L) / L
  - a_rhoy * PI * rho_y * V * NU_SA * sin(a_rhoy * PI * y / L) / L
  - a_nusax * PI * nu_sa_x * RHO * U * sin(a_nusax * PI * x / L) / L
  - a_nusay * PI * nu_sa_y * RHO * V * sin(a_nusay * PI * y / L) / L
  + (a_ux * u_x * cos(a_ux * PI * x / L) + a_vy * v_y * cos(a_vy * PI * y / L)) * PI * RHO * NU_SA / L
  + (a_rhox * a_nusax * rho_x * nu_sa_x * cos(a_rhox * PI * x / L) * sin(a_nusax * PI * x / L)
    - a_rhoy * a_nusay * rho_y * nu_sa_y * sin(a_rhoy * PI * y / L) * sin(a_nusay * PI * y / L))
    * PI * PI * NU_SA / sigma * pow(L, -0.2e1)
  + a_rhot * PI * rho_t * NU_SA * cos(a_rhot * PI * t / L) / L
  - a_nusat * PI * nu_sa_t * RHO * sin(a_nusat * PI * t / L) / L
  - c_b1 * Ssa * RHO * NU_SA + c_w1 * RHO * NU_SA * NU_SA * f_w * pow(d, -0.2e1);
  return(Q_nu);
}
\end{verbatim}
\end{footnotesize}


%---------------------------------------------------------------------------------------------------------
\bibliographystyle{chicago} 
\bibliography{../../MMS_bib}

\end{document}

