\documentclass[10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath,amsfonts}
\usepackage{geometry}
\geometry{ top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm}
\usepackage[authoryear]{natbib}
\usepackage{pdflscape}
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm, right=2cm}

\newcommand{\D}{\partial}
\newcommand{\Diff}[2] {\dfrac{\partial( #1)}{\partial #2}}
\newcommand{\diff}[2] {\dfrac{\partial #1 }{\partial #2}}
\newcommand{\gv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}% for vectors of Greek letters
\newcommand{\grad}[1]{\gv{\nabla} #1}
\newcommand{\bv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}
\newcommand{\bt}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}

%opening
\title{Manufactured Solution for 1D compressible Euler equations for hypersonic flows in thermal non-equilibruim using Maple\footnote{Work based on \citet*{Roy2002,Kirk2009}.}}
\author{Kemelli C. Estacio-Hiroms}

\begin{document}

\maketitle

\begin{abstract}
The Method of Manufactured Solutions is a valuable approach for code verification, providing means to verify how accurately the numerical method solves the equations of interest. The method generates a related set of governing equations by applying the differential operator for the governing equations to an analytical solution chosen \textit{a priori} to generate source terms, which are added the RHS of the original set of equations. Then, the modified set of equations may be discretized and solved numerically, so its solution may be compared to the exact solution. A choice of analytical solutions for the flow variables of the 1D Compressible Euler equations for hypersonic flows  in thermal non-equilibruim and their respective source terms are presented in this document.
\end{abstract}




\section{1D Euler Equations}
The conservation of mass, momentum, and total energy for a compressible fluid composed of a %chemically reacting%
 mixture of gases N and N$_2$ in thermal nonequilibrium may be written as:
\begin{align}
 \label{eq:pde_comp_mass_N}
 \diff{\rho_{\text{N}}}{t} &+ \Diff{\rho_{\text{N}} u }{x} = 0, \\
\label{eq:pde_comp_mass_N2}
 \diff{\rho_{\text{N}_2}}{t} &+ \Diff{\rho_{\text{N}_2} u }{x} =0 ,\\
 \label{eq:pde_comp_mom}
 \diff{\rho u }{t} &+ \Diff{\rho u^2}{x} = -\grad{p} ,\\
 \label{eq:pde_comp_energy}
 \diff{\rho E}{t} &+ \Diff{\rho  u  H}{x}= 0\\
\diff{\rho e_V }{t} &+ \Diff{\rho e_V u }{x}= 0,
\end{align}
where $\rho_s$ is the density of species $s$ (N or N$_2$), $\rho=\sum_s \rho_s$ is the mixture density, $ u $ is the average mixture velocity, $E$ is the total energy per unit mass, $e_V$ is the vibrational/electronic energy and $p$ is the pressure. Note that is this approach, \textbf{the flow is considered to not have chemical reactions.}



The total enthalpy, $H$, may be expressed in terms of the total energy, density, and pressure:
$$H = E + \dfrac{p}{\rho},$$
and the total energy, $E$, is composed of internal and kinetic components: $$E = e^{\text{int}} + \dfrac{ u^2 }{2}.$$

For non-ionized flows such as those considered in this work, the total internal energy, $e^{\text{int}}$, has the form:
\begin{align}
 e^{\text{int}} &= e^{\text{trans}} + e^{\text{rot}} + e^{\text{vib}} + e^{\text{elec}} + h^0 \\
 &= \sum_{s=1}^{ns} c_s e^{\text{trans}}_s + \sum_{s=mol} c_s e^{\text{rot}}_s + \sum_{s=mol} c_s e^{\text{vib}}_s + \sum_{s=1}^{ns} c_s h^0_s ,
\label{eq:energy_partition}
\end{align}
where $c_s=\left(\rho_s/\rho\right)$ is the mass fraction of species $s$.

The first three terms on the right of Equation~\eqref{eq:energy_partition} represent the energy due to molecular/atomic translation, molecular rotation and  molecular vibration. The final term is the heat of formation of the mixture and accounts for the energy stored in chemical bonds \citep{Ait1996,Kirk2009}.

Under the approximation that the translational and rotational states of the may be assumed fully populated, translational/rotational energy for each species may be expressed as:
\begin{equation}
 \label{eq:e_tr_combined}
 e^{\text{trans}}_s + e^{\text{rot}}_s = e^{\text{tr}}_s = C^{\text{tr}}_{v,s}\, T ,
\end{equation}
where the translational/rotational specific heat, $C^{\text{tr}}_{v,s}$ is given by
\begin{equation}
 C^{\text{tr}}_{v,s} =
 \begin{cases}
 \frac{5}{2} R_s & \text{for molecules}, \\
 \frac{3}{2} R_s & \text{for atoms.}
 \end{cases}
\end{equation}
where $R_s$ is the species gas constant, and $R_s = R/M_s$ where $R$ is the universal gas constant and $M_s$ is the species molar mass. The combined term $e^{\text{tr}}_s$ in Equation~\eqref{eq:e_tr_combined} represents the energy due to random thermal translational/rotational motion of a given species.

One approach for modeling the molecular vibrational energy is through analogy to a harmonic oscillator.  In this approach the energy potential between molecular nuclei is modeled as a quadratic function of separation distance\cite{Kirk2009}.  Under this assumption, the vibrational energy for each molecular species can be modeled as
\begin{equation}
  \label{eq:species_vibrational_energy}
  e^{\text{vib}}_s = 
  \begin{cases}    
    \frac{R_s\theta_{vs}}{\exp\left(\theta_{vs}/T_v\right) - 1} & \text{for molecules}, \\
    0 & \text{for atoms.}
  \end{cases}
\end{equation}
where $\theta_{vs}$ is the species characteristic temperature of vibration and $T_v$ is the mixture vibrational temperature.
The data for each of the species are given in Table \ref{table01}.


\begin{table}[htb]

\centering
\begin{tabular}{l l l}
\multicolumn{3}{c}{Parameters for Nitrogen atom and molecule.} \\
\hline\hline
 &     N$_2$     &  N  \\ [0.25ex]
\hline 
$M_s$ [kg/kg-mol]  & 28.02     &14.01               \vspace{2pt} \\
$R_s$ [J/ kg K]    & 296.7    &593.6               \vspace{2pt}\\
$h^0_s$ [K]        & 0        &$33.59\times 10^6$  \vspace{2pt}\\
$\theta_{v,s}$ [K] & 3393     &-                    \vspace{2pt}\\
\hline
\end{tabular}
\label{table01}
\caption{$M_s$ is the species molar mass,   $R_s$ is the species gas constant, $h^0_s$ is the activation energy, and $\theta_{vs}$ is the species characteristic temperature of vibration for the 5--species model \citep{Kessler2004}.}
\end{table}



Regardless of the thermal state of the mixture, once the translational/rotational temperature $T$ is determined the thermodynamic pressure of the mixture is readily obtained from Dalton's law of partial pressures:
\begin{equation}
 p = \sum_{s=1}^{ns} p_s = \sum_{s=1}^{ns} \rho_s R_s T .
 \label{eq:p_eq_state}
\end{equation}


\section{Manufactured Solution}

\citet{Roy2002} propose the general form of the primitive solution variables to be a function of sines and cosines:
\begin{equation}
 \label{eq:manufactured01}
 \phi (x,y) = \phi_0+ \phi_x f_s\left(\frac{a_{\phi x} \pi x}{L}\right) ,
\end{equation}
where $\phi=\rho_{\text{N}},\rho_{\text{N}_2}, u$ or $p$, and $f_s(\cdot)$ functions denote either sine or cosine function. Note that in this case, $\phi_x$ is constant and the subscript does not denote differentiation.

Therefore, the manufactured analytical solution for for each one of the variables in Euler equations are:
\begin{equation}
\begin{split}
\label{eq:manufactured02}
\rho_{\text{N}}(x) &= \rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{\rho \text{N} x}\pi x}{L}\right),\\
\rho_{\text{N}_2}(x) &= \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right),\\
u(x) &= u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right),\\
T(x) &= T_{0}+T_{x} \cos\left(\frac{a_{T x} \pi x}{L}\right).\\
T_V(x) &= T_{V0}+T_{Vx} \cos\left(\frac{a_{T_V x} \pi x}{L}\right).\\
\end{split}
\end{equation}

Recalling that $\rho=\sum_s \rho_s$, the manufactured analytical solution for the density of the mixture  is:
\begin{equation}
\label{eq:manufactured03}
\begin{split}
\rho(x) &= \rho_{\text{N}}+\rho_{\text{N}_2}\\
                     &= \rho_{\text{N}0} + \rho_{\text{N}_2 0} +
\rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right) + \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right) .
\end{split}
\end{equation}




\citet{Roy2002} present the constants used in the manufactured solutions for the 2D supersonic and subsonic cases, together with the source term for the 2D mass conservation equation. The resulting source terms for the 1D Euler flow with Nitrogen dissociation described by Equations (\ref{eq:pde_comp_mass_N}) -- (\ref{eq:pde_comp_energy}) are obtained through symbolic manipulation using the software Maple and are presented in the following sections.

%The governing equations (\ref{eq:euler2d_01}) -- (\ref{eq:euler2d_07}) are applied to the solutions in {\ref{eq:manufactured02}} using Maple and the resulting analytical source term are presented in the following sections.

\section{Euler mass conservation equation for Nitrogen atom}

The mass conservation equation for Nitrogen atom (N), written as an operator, is:
\begin{equation}
 \label{eq:euler1d_11}
L= \diff{\rho_\text{N}}{t} + \diff{\rho_\text{N} u}{x} 
\end{equation}

Analytically differentiating Equation (\ref{eq:manufactured02}) for $\rho_{\text{N}}$,  and $u$ using operator $L$ defined above together with suitable substitution for source term~$\dot{\omega}_\text{N}$ gives the source term $Q_{\rho_{\text{N}}}$:

\begin{equation}
\begin{split}
Q_{\rho_\text{N}} &=\dfrac{a_{\rho \text{N} x} \pi \rho_{\text{N}x}  }{L}\cos\left(\dfrac{a_{\rho \text{N} x} \pi x}{L}\right) \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)\right] +\\
& + \dfrac{a_{ux} \pi u_x }{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right) \left[\rho_{\text{N}0}+\rho_{\text{N}x} \sin\left(\dfrac{a_{\rho \text{N} x} \pi x}{L}\right)\right]
\end{split}
\end{equation}


\section{Euler mass conservation equation for Nitrogen molecule}

The mass conservation equation for Nitrogen molecule ( $\text{N}_2$), written as an operator, is:
\begin{equation}
 \label{eq:euler1d_11a}
L= \diff{\rho_{\text{N}_2}}{t} + \diff{\rho_{\text{N}_2} u }{x} 
\end{equation}

Analytically differentiating Equation (\ref{eq:manufactured02}) for $\rho_{\text{N}_2}$, $u$ and $v$ using operator $L$ defined above  gives the source term $Q_{\rho_{\text{N}_2}}$:

\begin{equation}
\begin{split}
Q_{\rho_{\text{N}_2}} = &- \dfrac{a_{ \rho \text{N}_2 x } \pi \rho_{\text{N}_2 x}}{L}\sin\left( \dfrac{a_{ \rho \text{N}_2 x } \pi x}{L}\right) \left[u_0+u_x \sin\left( \dfrac{a_{ux} \pi x}{L}\right)\right] + \\
&+\dfrac{a_{ux} \pi u_x }{L}\cos\left( \dfrac{a_{ux} \pi x}{L}\right) \left[\rho_{\text{N}_2 0}+\rho_{\text{N}_2 x} \cos\left( \dfrac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right]
\end{split}
\end{equation}




\section{Euler momentum equation}

For the generation of the analytical source term $Q_u$ for the $x$ momentum equation, Equation (\ref{eq:pde_comp_mom}) is written as an operator $L$:
\begin{equation}
 \label{eq:euler1d_12}
L=\Diff{\rho u}{t} + \Diff{\rho u^2 +p}{x}.
\end{equation}
which, when operated in to Equations (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}), and using expression (\ref{eq:p_eq_state}) provides source term $Q_{u}$:

\begin{equation}
\begin{split}
Q_u &= \dfrac{a_{\rho \text{N} x} \pi \rho_{\text{N}x}}{L M_\text{N}}\cos\left(\dfrac{a_{\rho \text{N} x} \pi x}{L}\right)\left(M_\text{N} \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)\right]^2+R\left[T_0+T_x \cos\left(\dfrac{a_{Tx} \pi x}{L}\right)\right]\right)   +\\
& -\dfrac{a_{\rho \text{N}_2 x} \pi \rho_{\text{N}_2 x}}{2L}\sin\left(\dfrac{a_{\rho \text{N}_2 x} \pi x}{L}\right)\left(2M_\text{N}\left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)\right]^2+R\left[T_0+T_x \cos\left(\dfrac{a_{Tx} \pi x}{L}\right)\right]\right)   +\\
& -\dfrac{a_{Tx} \pi T_x R}{2 L M_\text{N}}\sin\left(\dfrac{a_{Tx} \pi x}{L}\right)\left(2 \left[\rho_{\text{N}0}+\rho_{\text{N}x} \sin\left(\dfrac{a_{\rho \text{N} x} \pi x}{L}\right)\right]+\left[\rho_{\text{N}_2 0}+\rho_{\text{N}_2 x} \cos\left(\dfrac{a_{\rho \text{N}_2 x} \pi x}{L}\right)\right]\right)   +\\
& +\dfrac{2a_{ux} \pi u_x }{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right) \left[\rho_{\text{N}0}+\rho_{\text{N}x} \sin\left(\dfrac{a_{\rho \text{N} x} \pi x}{L}\right)+\rho_{\text{N}_2 0}+\rho_{\text{N}_2 x} \cos\left(\dfrac{a_{\rho \text{N}_2 x} \pi x}{L}\right)\right] \left[u_0+u_x \sin\left(\dfrac{a_{ux} \pi x}{L}\right)\right].
\end{split}
\end{equation}


\section{Euler energy equation}
The total energy equation is written as an operator:
\begin{equation}
 \label{eq:euler1d_14}
L=\diff{\rho E}{t} + \diff{\rho u H}{x} ,
\end{equation}
where $E=e^{\text{int}} + \dfrac{u^2 }{2} \quad \mbox{and}\quad H= E+ \dfrac{p}{\rho},$ with $e^{\text{int}}$ and $p$ as defined in Equations (\ref{eq:energy_partition}) and (\ref{eq:p_eq_state}), respectively.

Source term $Q_E$ is obtained by operating $L$ on Equations (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}):

\begin{equation}
\begin{split}
Q_E &= - \dfrac{a_{\rho \text{N}_2 x} \pi \rho_{\text{N}_2 x}}{L}  \, e^{\text{vib}}_{\text{N}_2}\, \sin\left(\dfrac{a_{\rho \text{N}_2 x} \pi x}{L}\right)  \left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right] +\\
&-\dfrac{a_{\rho \text{N}_2 x} \pi \rho_{\text{N}_2 x}}{4L M_\text{N}} \sin\left(\dfrac{a_{\rho \text{N}_2 x} \pi x}{L}\right)  \left( M_\text{N}  \left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right]^2+7 R \left[T_{0}+T_{x} \cos\left(\frac{a_{T x} \pi x}{L}\right)\right]+4 h^{0}_{\text{N}_2} M_\text{N}\right) \cdot \\
    &\quad \cdot\left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right]+\\
&+ \dfrac{ a_{\rho \text{N} x} \pi \rho_{\text{N}x}}{L}  \, e^{\text{vib}}_{\text{N}_2}\,\cos\left(\dfrac{a_{\rho \text{N} x} \pi x}{L}\right)  \left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right] +\\
&+ \dfrac{a_{\rho \text{N} x} \pi \rho_{\text{N}x}}{2L M_\text{N}} \cos\left(\dfrac{a_{\rho \text{N} x} \pi x}{L}\right)\left(M_\text{N}  \left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right]^2+5 R \left[T_{0}+T_{x} \cos\left(\frac{a_{T x} \pi x}{L}\right)\right]+2 h^{0}_{\text{N}} M_\text{N}\right) \cdot \\
    &\quad \cdot\left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right]+\\
&+ \dfrac{a_{ux} \pi u_x}{L}\dfrac{ R \theta_{V,\text{N}_2}}{2 M_\text{N} \left( \exp(\Phi) -1 \right)}\cos\left(\dfrac{a_{ux} \pi x}{L}\right) \left[\rho_{\text{N}0} + \rho_{\text{N}_2 0} + \rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right) + \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right] +\\
&+ \dfrac{ a_{ux} \pi u_x R}{4L M_\text{N}}\cos\left(\dfrac{a_{ux} \pi x}{L}\right)\left(10 \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{\rho \text{N} x}\pi x}{L}\right)\right]+7 \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right]\right)\cdot \\
    &\quad \cdot \left[T_{0}+T_{x} \cos\left(\frac{a_{T x} \pi x}{L}\right)\right]+\\
%
&+ \dfrac{a_{ux} \pi u_x}{4L M_\text{N}} \cos\left(\dfrac{a_{ux} \pi x}{L}\right)\left(6 M_\text{N} \left[\rho_{\text{N}0} + \rho_{\text{N}_2 0} + \rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right) + \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right] \right.\cdot \\
    &\quad \cdot \left. \left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right]^2 +4 h^{0}_{\text{N}} M_\text{N} \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{\rho \text{N} x}\pi x}{L}\right)\right]+4 h^{0}_{\text{N}_2} M_\text{N} \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right]\right) +\\
&-\dfrac{a_{Tx} \pi T_x R }{4L M_\text{N}}\sin\left(\dfrac{a_{Tx} \pi x}{L}\right)\left(10 \left[\rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{\rho \text{N} x}\pi x}{L}\right)\right]+7 \left[\rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right]\right)\cdot \\
    &\quad \cdot   \left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right]+\\
&- \dfrac{ a_{T_V x} \pi T_{Vx}}{L} \dfrac{\theta_{V,\text{N}_2}\exp(\Phi)}{\left( \exp(\Phi) -1 \right)}  \, e^{\text{vib}}_{\text{N}_2}\,\sin\left(\dfrac{a_{T_V x} \pi x}{L}\right)\cdot \\
    &\quad \cdot  \dfrac{\left[\rho_{\text{N}0} + \rho_{\text{N}_2 0} + \rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right) + \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right)\right]  \left[u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right)\right]}{ \left[T_{V0}+T_{Vx} \cos\left(\frac{a_{T_V x} \pi x}{L}\right)\right]^2}
\end{split}
\end{equation}


where
$$\Phi= \dfrac{\theta_{V,\text{N}_2}}{ \left[T_{V0}+T_{Vx} \cos\left(\frac{a_{T_V x} \pi x}{L}\right)\right]}$$

 $$ \, e^{\text{vib}}_{\text{N}_2}\, =\dfrac{R \theta_{V,\text{N}_2}}{2 M_\text{N} \left( \exp(\Phi) -1 \right)}$$



%---------------------------------------------------------------------------------------------------------
%\bibliographystyle{ieeetr}
\bibliographystyle{chicago} 
\bibliography{../../../MMS_bib}



\end{document}
