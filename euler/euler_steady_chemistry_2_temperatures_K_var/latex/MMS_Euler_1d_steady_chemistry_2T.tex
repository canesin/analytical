\documentclass[10pt]{article}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath,amsfonts}
\usepackage{geometry}
\geometry{ top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm}
\usepackage[authoryear]{natbib}
\usepackage{pdflscape}
%\geometry{papersize={216mm,330mm}, top=3cm, bottom=2.5cm, left=4cm, right=2cm}

\newcommand{\D}{\partial}
\newcommand{\Diff}[2] {\dfrac{\partial( #1)}{\partial #2}}
\newcommand{\diff}[2] {\dfrac{\partial #1 }{\partial #2}}
\newcommand{\gv}[1]{\ensure math{\box{\boldmath$ #1 $}}}% for vectors of Greek letters
\newcommand{\grad}[1]{\gv{\nabla} #1}
\newcommand{\bv}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}
\newcommand{\bt}[1]{\ensuremath{\mbox{\boldmath$ #1 $}}}
\newcommand{\Lo}{\,\mathcal{L}}
\newcommand{\Rho}{\,\mathtt{Rho}}
\newcommand{\T}{\,\mathtt{T}}
\newcommand{\U}{\,\mathtt{U}}
\newcommand{\TV}{\,\mathtt{T_V}}
\newcommand{\N}{\text{N}}
\newcommand{\elec}{\text{elec}}
\newcommand{\vib}{\text{vib}}


%opening
\title{Manufactured Solution for 1D Steady Euler Equations for Hypersonic Flows with Nitrogen Dissociation in Thermal Nonequilibrium\footnote{Work based on \citet*{Kirk2009}.}}
\author{Kemelli C. Estacio-Hiroms}

\begin{document}

\maketitle
\tableofcontents
\begin{abstract}
The Method of Manufactured Solutions is a valuable approach for code verification, providing means to verify how accurately the numerical method solves the equations of interest. The method generates a related set of governing equations that has known analytical (manufactured) solution. Then, the modified set of equations may be discretized and solved numerically, and the numerical solution may be compared to the manufactured analytical solution  chosen \textit{a priori}.

A choice of analytical solutions for the flow variables of the 1D steady Euler equations for chemically reacting hypersonic flows in thermal nonequilibrium  and their respective source terms are presented in this document.
\end{abstract}





\section{Mathematical Model}
Using the two-temperature model, the conservation of mass, momentum, and energy for a inviscid compressible fluid composed of a  mixture of gases N and N$_2$ in thermochemical nonequilibrium may be written as:
\begin{align}
%\begin{array}{ccc}
\label{eq:euler:rhoN}
&\nabla \cdot \left(\rho_{\text{N}} \bv{u}\right) = \dot{\omega}_{\text{N}},\vspace{5pt} \\
 \label{eq:euler:rhoN2}
&\nabla \cdot \left(\rho_{\text{N}_2}\bv{u}\right) = \dot{\omega}_{\text{N}_2},\vspace{5pt}\\
\label{eq:euler:u}
&\nabla\cdot\left(\rho\bv{u}\bv{u}\right) = -\nabla p,\vspace{5pt} \\
\label{eq:euler:E}
&\nabla\cdot\left(\rho \bv{u} H\right) = 0,\vspace{5pt} \\
\label{eq:euler:eV}
&\nabla\cdot (\rho e_V \bv{u})= \dot{\omega}_V ,
%\end{array}
\end{align}
%
where $\rho_s$ is the density of species $s$ (N or N$_2$), $\rho=\sum_s \rho_s$ is the mixture density,  $ \bv{u} $ is the mixture velocity and $e_V$ is  the vibrational/electronic energy. 
%
The total enthalpy, $H$, may be expressed in terms of the total energy, density, and pressure:
$$H = E + \dfrac{p}{\rho},$$
where the total energy, $E$, is composed of internal and kinetic components: $$E = e^{\text{int}} + \dfrac{ u^2 }{2}.$$ 


The total internal energy, $e^{\text{int}}$, has contributions from each of the distinct energy \emph{modes}:% - translational, rotational, vibrational and electronic. Specifically
\begin{equation}
 \begin{split}
e^{\text{int}} &= e^{\text{trans}} + e^{\text{rot}} + e^{\text{vib}} + e^{\elec} + h^0 \\
 &= \sum_{s=1}^{ns} c_s e^{\text{trans}}_s + \sum_{s=mol} c_s e^{\text{rot}}_s + \sum_{s=mol} c_s e^{\text{vib}}_s + \sum_{s=1}^{ns} c_s e^{\elec}_s + \sum_{s=1}^{ns} c_s h^0_s ,
\label{eq:energy_partition}  
 \end{split}
\end{equation}
where $c_s=\left(\rho_s/\rho\right)$ is the mass fraction of species $s$.

The first four terms on the right of Equation~\eqref{eq:energy_partition} represent the energy due to molecular/atomic translation, molecular rotation, molecular vibration, and electronic excitation. The final term is the heat of formation of the mixture and accounts for the energy stored in chemical bonds \citep{Ait1996,Kirk2009}. In the two-temperature model, the translational and rotational modes may modeled with a single translational/rotational temperature $T\equiv T_t = T_r$, while the vibrational and electronic energy are governed by a separate temperature $T_V \equiv T_v=T_e$. 
 
Under the approximation that the translational and rotational states of the may be assumed fully populated, translational/rotational energy for each species may be expressed as:
\begin{equation}
 \label{eq:e_tr_combined}
 e^{\text{trans}}_s + e^{\text{rot}}_s = e^{\text{tr}}_s = C^{\text{tr}}_{v,s}\, T ,
\end{equation}
where the translational/rotational specific heat, $C^{\text{tr}}_{v,s}$ is given by
\begin{equation*}
 C^{\text{tr}}_{v,s} =
 \begin{cases}
 \frac{5}{2} R_s & \text{for molecules}, \\
 \frac{3}{2} R_s & \text{for atoms},
 \end{cases}
\end{equation*}
where $R_s$ is the species gas constant, and $R_s = R/M_s$ where $R$ is the universal gas constant and $M_s$ is the species molar mass. The combined term $e^{\text{tr}}_s$ in Equation~\eqref{eq:e_tr_combined} represents the energy due to random thermal translational/rotational motion of a given species.
%---------------

In contrast to the translational/rotational states, the vibrational energy states are typically not fully populated. One approach for modeling the molecular vibrational energy is through analogy to a harmonic oscillator.  In this approach the energy potential between molecular nuclei is modeled as a quadratic function of separation distance.  Under this assumption, the vibrational energy for each molecular species can be modeled as:
\begin{equation}
  \label{eq:species_vibrational_energy}
  e^{\text{vib}}_s = 
  \begin{cases}    
    \dfrac{R_s\theta^{\vib}_{s}}{\exp\left(\theta^{\vib}_{s}/T_v\right) - 1} & \text{for molecules}, \\
    0 & \text{for atoms},
  \end{cases}
\end{equation}
where $\theta^{\vib}_{s}$ is the species characteristic temperature of vibration and $T_v$ is the mixture vibrational temperature.

%Recall that in the case of thermal equilibrium $T_r=T_t=T_v=T_e\equiv T$.%, therefore Equation (\ref{eq:species_vibrational_energy}) is simplified to:
% \begin{equation}
%   \label{eq:species_vibrational_energy2}
%   e^{\text{vib}}_s = 
%   \begin{cases}    
%     \frac{R_s\theta^{\vib}_{s}}{\exp\left(\theta^{\vib}_{s}/T \right) - 1} & \text{for molecules}, \\
%     0 & \text{for atoms.}
%   \end{cases}
% \end{equation}

The energy contained in the excited electronic states for a given species, $e^{\elec}_s$, can be obtained from the assumption that they are in a Boltzmann distribution governed by the electronic excitation temperature $T_e$~\citep{candler_thesis} as:
\begin{equation}
  \label{eq:elec_excitation}
  e^{\elec}_s = R_s \dfrac{\sum_{i=1}^\infty \theta^{\elec}_{s,i} g_{s,i} \exp\left(-\theta^{\elec}_{s,i}/T_e\right)}{ \sum_{i=1}^\infty g_{s,i} \exp\left(-\theta^{\elec}_{s,i}/T_e\right)}.
\end{equation}
where $g_{s,i}$ is the degeneracy of the electronic level $i$ of species $s$, and  $\theta^{\elec}_{s,i}$ is its characteristic temperature. In practice, a simple cut off criteria is applied to select the number of electronic energy levels in the calculation of the series. The number of electronic energy levels for N is 3 and number of electronic energy levels for N$_2$ is 15 \cite{dodod}.

Recalling that  in the two-temperature mode adopted in this work $T_e=T_v= T_V$, Equations (\ref{eq:species_vibrational_energy}) and (\ref{eq:elec_excitation}) may be simplified to:
\begin{equation*}
  e^{\text{vib}}_s = 
  \begin{cases}    
    \dfrac{R_s\theta^{\vib}_{s}}{\exp\left(\theta^{\vib}_{s}/T_V\right) - 1} & \text{for molecules}, \\
    0 & \text{for atoms},
  \end{cases}
\quad
e^{\elec}_s = R_s \dfrac{\sum_{i=1}^{nel_s} \theta^{\elec}_{s,i} g_{s,i} \exp\left(-\theta^{\elec}_{s,i}/T_V\right)}{ \sum_{i=1}^{nel_s} g_{s,i} \exp\left(-\theta^{\elec}_{s,i}/T_V\right)}.
\end{equation*}
where $nel_s$ is the number of electronic energy levels of species $s$. See Appendix \ref{Appendix:01} for N and N$_2$ data.

Therefore, 
\begin{equation}
  \label{eq:rev-Tv-relationship}
  \rho e_V\left(T_V\right) = \sum_{s=mol} \rho_s e^{\text{vib}}_s\left(T_V\right) + \sum_{s=1}^{ns} \rho_s e^{\text{elec}}_s\left(T_V\right).
\end{equation}

Regardless of the thermal state of the mixture, once the translational/rotational temperature $T$ is determined the thermodynamic pressure of the mixture is readily obtained from Dalton's law of partial pressures:
\begin{equation}
 p = \sum_{s=1}^{ns} p_s = \sum_{s=1}^{ns} \rho_s R_s T .
 \label{eq:p_eq_state}
\end{equation}



\subsection{Chemical Kinetics}
The rate of production/destruction of the individual species $s$, $\dot{\omega}_s$, is required to close the species continuity equations. For the dissociating Nitrogen flow ($  \text{N}_2 \rightleftharpoons 2 \text{N}$) case, let us consider the chemical reactions which occur among the five principal components of dissociating air -- $\text{N}_2,\text{O}_2,\text{NO},\text{N},\text{O}$ -- but neglecting three species in order to perform this 2--species problem. For this mixture, the single chemical reaction that occur is:
\begin{align*}
 \text{N}_2 + \mathcal{M} &\rightleftharpoons 2\text{N} + \mathcal{M} .
\end{align*}

This reaction can occur in either the forward or backward direction, as denoted by the bidirectional arrow. The reaction is presented such that they are endothermic in the forward direction, and $\mathcal{M}$ denotes a generic collision partner, which may be any of the species present in the flow, and  is unaltered by the reaction~\citep{Kirk2009}.
The rate of each reaction is therefore a sum of the forward and backward rates,  $k_{f}$ and $k_{b}$:
\begin{equation*}
 \begin{split}
\mathcal{R}_r &=  \mathcal{R}_{br} - \mathcal{R}_{fr} \\
                &= k_{br} \prod_{s=1}^{ns} \left(\frac{\rho_s}{M_s}\right)^{\beta_{sr}} - k_{fr} \prod_{s=1}^{ns} \left(\frac{\rho_s}{M_s}\right)^{\alpha_{sr}}
 \end{split}
\end{equation*}
where $\alpha_{sr}$ and $\beta_{sr}$ are the stoichiometric coefficients for reactants and products of species $s$.
For the Nitrogen dissociation,
\begin{equation}
\begin{split}             	                
\label{eq:reaction1}
 \mathcal{R}_1 &= \sum_{m\in\mathcal{M}}\left(k_{b_1 m} \frac{\rho_{\text{N}}}{M_{\text{N}}}\frac{\rho_{\text{N}}}{M_{\text{N}}}\frac{\rho_{\text{m}}}{M_{\text{m}}} - k_{f_1 m}\frac{\rho_{\text{N}_2}}{M_{\text{N}_2}}\frac{\rho_{\text{m}}}{M_{\text{m}}} \right) \\
%
&= k_{b_1 \text{N}} \dfrac{\rho_{\text{N}}^3}{M_\text{N}^3} -
k_{f_1 \text{N}}   \dfrac{\rho_{\text{N}_2} \rho_{\text{N}}}{2  M_\text{N}^2}+
k_{b_1 \text{N}_2} \dfrac{\rho_\text{N}^2 \rho_{\text{N}_2}}{2M_\text{N}^3 }-
k_{f_1 \text{N}_2} \dfrac{\rho_{\text{N}_2}^2}{4 M_\text{N}^2},
\end{split}
\end{equation}
recalling that $M_{\text{N}_2}=2 M_\text{N}.$


The species source terms $\dot{\omega}_s = M_s \sum_{r=1}^{nr}\left(\alpha_{sr}-\beta_{sr}\right)\left(\mathcal{R}_{br} - \mathcal{R}_{fr}\right)$ 
% \begin{equation}
%   \dot{\omega}_s = M_s \sum_{r=1}^{nr}\left(\alpha_{sr}-\beta_{sr}\right)\left(\mathcal{R}_{br} - \mathcal{R}_{fr}\right)
% \end{equation}
 where $nr$ is the number of reactions can now be expressed in terms of the individual reaction rates as follows:
\begin{align*}
 \dot{\omega}_{\text{N}_2} &= M_{\text{N}_2}\left(\mathcal{R}_1\right)= 2 M_\text{N} \mathcal{R}_1 ,\\
 \dot{\omega}_{\text{N}} &= M_{\text{N}}\left(-2\mathcal{R}_1 \right)=-2 M_\text{N} \mathcal{R}_1. 
\end{align*}
Note that these source terms sum identically to zero, as required by conservation of mass \citep{Kessler2004}.



The forward rate coefficients  $k_{fr}$  can then be expressed in a modified Arrhenius form as
\begin{equation}\label{eq:equilibrium_constant}
  k_{fr}\left(\bar{T}\right) = C_{fr} \bar{T}^{\eta_r} \exp \left(-E_{ar}/R\bar{T}\right)
\end{equation}
where $C_{fr}$ is the reaction rate constant, $\eta_r$ is the so-called pre-exponential factor, $E_{ar}$ is the activation energy.  These three constants are determined from curve fits to experimental data (e.g. see \cite{Ait1996}). The effective temperature, $\bar{T}$, is a function of the translational/rotational and vibrational temperatures, and in this work it is taken as:
\begin{equation}
	\label{eq:Tbar}
\bar{T}=T^{q} \, T_V^{1-q}, \quad 0\leq q\leq 1 .
\end{equation}


The corresponding backward rate coefficient   $k_{br}$  can be found using the principle of detailed balance, which states
\begin{equation}
  K_{eq} = \frac{k_{fr}\left(\bar{T}\right)}{k_{br}\left(\bar{T}\right)}
\end{equation}
where $K_{eq}$ is the equilibrium constant and may be obtained either by curve fits or through Gibbs' free energy techniques\footnote{Examples of curve fits for calculating the equilibrium constant may be found in \citet{Park1990}, whereas Gibbs' free energy techniques are employed in \citet{Nasa_chemistry}. }. 
In this work, $K_{eq}=K(T)$.


Therefore:
\begin{equation}
 \begin{split}
\label{eq:forward_rates1}
k_{f_1 \text{N}} &= C_{f_1 \text{N}} \bar{T}^{\eta_{f_1 \text{N}}} \exp\left(\frac{-E_{a\text{N}}}{R \bar{T}}\right) \qquad \,\mbox{and}\quad k_{b_1 \text{N}} = \dfrac{k_{f_1 \text{N}}}{K(T)},\\
%
k_{f_1 \text{N}_2} &= C_{f_1 \text{N}_2} \bar{T}^{\eta_{f_1 \text{N}_2}} \exp\left(\dfrac{-E_{a\text{N}_2}}{R \bar{T}}\right) \quad \mbox{and}\quad k_{b_1 \text{N}_2} = \dfrac{k_{f_1 \text{N}_2}}{K(T)},
%
%k_{b_1 \text{N}} &= \dfrac{k_{f_1 \text{N}}}{K(T)}\\
%k_{b_1 \text{N}_2} &= \dfrac{k_{f_1 \text{N}_2}}{K(T)}
 \end{split}
\end{equation}
are the forward and backward rates for Nitrogen atom and Nitrogen molecule, respectively.


\subsection{Vibrational/Electronic Energy Production \& Vibrational Relaxation}\label{sec:omega_v}

For the case of thermal nonequilibrium it remains to define the vibrational/electronic energy source term, $\dot{\omega}_V$, which appears in Equation (\ref{eq:euler:eV}).  This term represents the production/destruction of vibrational/electronic energy in the gas, and is due to both the creation of molecules with some vibrational/electronic energy and the transfer of energy between the various modes in the gas:
\begin{equation}
  \dot{\omega}_v = \dot{Q}_{v} + \dot{Q}_{\text{transfer}}.
\end{equation}

When molecular species are created in the gas at rate $\dot{\omega}_s$, they contribute vibrational/electronic energy at the rate: 
\begin{equation*}
  \dot{Q}_{vs}=\dot{\omega}_s\left(e^{\text{vib}}_{s} + e^{\text{elec}}_{s}\right),
\end{equation*}
so the net vibrational energy production rate is then simply:
\begin{equation}
  \label{eq:vibrational_energy_production}
  \dot{Q}_{v} = \sum_{s=1}^{ns} \dot{\omega}_s\left(e^{\text{vib}}_{s} + e^{\text{elec}}_{s}\right).
\end{equation}

There is also energy transfer among the various energy modes in the gas.  Strictly speaking, one such energy transfer is vibration-vibration coupling between the various molecules in the gas.  However, implicit in the use of a single vibrational energy equation is the assumption that the molecular vibrational energies equilibrate very rapidly and thus are adequately characterized with a single vibrational temperature $T_V$.  There is also energy transfer between translational and vibrational modes as well as rotational and vibrational modes \citep{Kirk2009}.  These latter two exchanges are grouped together and represented as a single vibrational energy transfer rate~$\dot{Q}^{\text{tr-vib}}$.  
In this work we adopt the Landau-Teller model for the vibrational energy transfer for a given species:
\begin{equation}
  \label{eq:landau_teller_energy_exchange}
  \dot{Q}^{\text{tr-vib}}_s = \rho_s \frac{\hat{e}^{\text{vib}}_{s} - e^{\text{vib}}_s}{\tau^{\text{vib}}_s},
\end{equation}
where $\hat{e}^{\text{vib}}_{s}$ is the species equilibrium vibrational energy (Equation~\eqref{eq:species_vibrational_energy} evaluated at temperature $T$) and the vibrational relaxation time $\tau^{\text{vib}}_s$ is given by:
\begin{equation}
  \tau^{\text{vib}}_s = \frac{\sum_{r=1}^{ns} \chi_r}{\sum_{r=1}^{ns} \chi_r/\tau^{\text{vib}}_{sr}}
\end{equation}
where $\chi_r$ is given by
\begin{equation}
  \label{eq:chi_definition}
  \chi_r = c_r\frac{M}{M_r},\quad \mbox{with}\quad M=\left(\sum_{s=1}^{ns}\frac{c_s}{M_s}\right)^{-1}
\end{equation}
and
\begin{align}
  \label{eq:tau_vib_sr}
  \tau^{\text{vib}}_{sr} &=  \frac{1}{P} \exp\left[A_{sr}\left(T^{-1/3} - 0.015 \mu^{1/4}_{sr}\right) - 18.42\right] ,\\
          A_{sr} &= 1.16\times 10^{-3} \mu^{1/2}_{sr}(\theta_{s}^\vib)^{4/3} ,\\
        \mu_{sr} &= \frac{M_s M_r}{M_s + M_r}.
\end{align}
%where the pressure in Equation~\eqref{eq:tau_vib_sr} is in units of atmospheres. 


Combining~\eqref{eq:landau_teller_energy_exchange} and~\eqref{eq:vibrational_energy_production} yields the desired net vibrational energy source term
\begin{equation}
  \dot{\omega}_V = \sum_{s=1}^{ns} \dot{Q}^{\text{tr-vib}}_s + \sum_{s=1}^{ns} \dot{\omega}_s\left(e^{\text{vib}}_{s} + e^{\text{elec}}_{s}\right).
\end{equation}

\section{Manufactured Solutions}

\citet{Roy2002} propose the general form of the primitive solution variables to be a function of sines and cosines:
\begin{equation}
 \label{eq:manufactured01}
 \phi (x) = \phi_0+ \phi_x f_s\left(\frac{a_{\phi x} \pi x}{L}\right) ,
\end{equation}
where $\phi=\rho_{\text{N}},\rho_{\text{N}_2}, u, T$ or $T_V$, and $f_s(\cdot)$ functions denote either sine or cosine function. Note that in this case, $\phi_x$ is constant and the subscript does not denote differentiation. Different choices of the constants used in the manufactured solutions for the 2D supersonic and subsonic cases of Euler and Navier-Stokes may be found in \citet{Roy2002}.

Therefore, the manufactured analytical solution for each one of the variables in Euler equations are:
\begin{equation}
\begin{split}
\label{eq:manufactured02}
\rho_{\text{N}}(x) &= \rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right),\\
\rho_{\text{N}_2}(x) &= \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right),\\
u(x) &= u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right),\\
T(x) &= T_{0}+T_{x} \cos\left(\frac{a_{T x} \pi x}{L}\right),\\
T_V(x) &= T_{V0}+T_{Vx} \cos\left(\frac{a_{T_V x} \pi x}{L}\right).\\
\end{split}
\end{equation}

Recalling that $\rho=\sum_s \rho_s$, the manufactured analytical solution for the density of the mixture  is:
\begin{equation}
\label{eq:manufactured03}
\begin{split}
\rho(x) &= \rho_{\text{N}}+\rho_{\text{N}_2}\\
                     &= \rho_{\text{N}0} + \rho_{\text{N}_2 0} +
\rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right) + \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right) .
\end{split}
\end{equation}



%The governing equations (\ref{eq:euler2d_01}) -- (\ref{eq:euler2d_07}) are applied to the solutions in {\ref{eq:manufactured02}} using Maple and the resulting analytical source term are presented in the following sections.

\subsection{1D Steady Euler Equations in Thermochemical Nonequilibrium}

The MMS applied to 1D steady Euler equations for a chemically reacting mixture of  N and N$_{2}$ in thermal nonequilibrium consists in modifying  Equations~(\ref{eq:euler:rhoN})--(\ref{eq:euler:eV}) by adding a source term to the right-hand side of each equation:
\begin{equation}
 \label{eq:euler_mod_2d}
\begin{split}
&\Diff{\rho_{\text{N}} u}{x} -\dot{\omega}_{\text{N}}= Q_{\rho_{\text{N}}},\\
&\Diff{\rho_{\text{N}_2} u}{x} -\dot{\omega}_{\text{N}_2}= Q_{\rho_{\text{N}_2}},\\
&\Diff{\rho u^2 }{x}+ \Diff{p}{x} = Q_u,\\
&\Diff{\rho uE}{x}+ \Diff{pu}{x} = Q_{E},\\
& \Diff{\rho e_V u }{x}-\dot{\omega}_V =Q_{e_V},
\end{split}
\end{equation}
%
so the modified set of Equations (\ref{eq:euler_mod_2d}) conveniently has the analytical solutions given in Equations (\ref{eq:manufactured02}) and~(\ref{eq:manufactured03}).
%

Source terms $ Q_{\rho_{\text{N}}}$, $ Q_{\rho_{\text{N}_2}}$, $Q_u$,  $Q_{E}$ and $Q_{e_V}$ are obtained by symbolic manipulations of equations above using Maple and are presented in the following sections. The following auxiliary variables have been included in order to improve readability and computational efficiency:
\begin{equation}
 \begin{split}
\label{eq:aux_1d}
\Rho_{\text{N}} &= \rho_{\text{N}0} + \rho_{\text{N}x} \sin\left(\frac{a_{  \rho \text{N} x }\pi x}{L}\right),\\
\Rho_{\text{N}_2} &= \rho_{\text{N}_2 0}+ \rho_{\text{N}_2 x} \cos\left(\frac{a_{ \rho \text{N}_2 x } \pi x}{L}\right),\\
\Rho&=\Rho_{\text{N}}+\Rho_{\text{N}_2},\\
\U &= u_{0}+u_{x} \sin\left(\frac{a_{u x} \pi x}{L}\right),\\
\T &= T_{0}+T_{x} \cos\left(\frac{a_{T x} \pi x}{L}\right),\\
\TV &= T_{V0}+T_{Vx} \cos\left(\frac{a_{T_V x} \pi x}{L}\right),\\
\end{split}
\end{equation}
which simply are the manufactured solutions, and the derivatives:
\begin{equation}
\begin{split}\label{eq:aux_01}
%
\diff{e_{\N}^{\elec}}{x} &= \dfrac{(e_{\N}^{\elec})^2  a_{T_V x} \pi T_{Vx} \,M_\N}{ LR \TV^2}\sin\left(\dfrac{a_{T_V x} \pi x}{L}\right) - \dfrac{  a_{T_V x} \pi T_{Vx} R }{M_\N \, L \TV^2 }\sin\left(\dfrac{a_{T_V x} \pi x}{L}\right)\mathtt{AUX1},	\\
%
\diff{e_{\N_2}^{\elec}}{x} &= \dfrac{2 (e_{\N_2}^{\elec})^2 a_{T_V x} \pi T_{Vx} \,M_\N}{ LR \TV^2}\sin\left(\dfrac{a_{T_V x} \pi x}{L}\right)- \dfrac{  a_{T_V x} \pi T_{Vx} R }{2M_\N \, L \TV^2 }\sin\left(\dfrac{a_{T_V x} \pi x}{L}\right)\mathtt{AUX2},	\\
%
\texttt{AUX1} &= \dfrac{\sum_{i=1}^{nel_{\N}}( \theta^{\elec}_{\N,i})^2 g_{\N,i} \exp\left(- \theta^{\elec}_{\N,i}/ \TV \right)} { \sum_{i=1}^{nel_{\N}} g_{\N,i} \exp\left(-\theta^{\elec}_{\N,i}/\TV\right)},	\\
%
\texttt{AUX2} &= \dfrac{\sum_{i=1}^{nel_{\N_2}}( \theta^{\elec}_{\N_2,i})^2 g_{\N_2,i} \exp\left(- \theta^{\elec}_{\N_2,i} / \TV \right)} {\sum_{i=1}^{nel_{\N_2}} g_{\N_2,i} \exp\left(-\theta^{\elec}_{\N_2,i}/\TV\right)}.
%	
\end{split}
\end{equation}


%The resulting source terms for the 1D steady Euler flow with Nitrogen dissociation in thermal equilibrium described by Equations (\ref{eq:euler01}) are obtained through symbolic manipulation using the software Maple and are presented in the following sections.



\subsection{Mass Conservation of Nitrogen Atom}

The mass conservation equation for Nitrogen atom (N), written as an operator, is:
\begin{equation*}
 \label{eq:euler1d_11}
\Lo =  \diff{\rho_\text{N} u}{x} - \dot{\omega}_{\text{N}}.
\end{equation*}

Analytically differentiating Equation (\ref{eq:manufactured02}) for $\rho_{\text{N}}$  and $u$ using operator $\Lo$ defined above together with suitable substitution for ~$\dot{\omega}_\text{N}$ gives the source term $Q_{\rho_{\text{N}}}$:



\begin{equation}
\begin{split}
Q_{\rho_\N} = \dfrac{a_{  \rho \N x } \pi \rho_{\N x} \U }{L}\cos\left(\dfrac{a_{  \rho \N x } \pi x}{L}\right) +\dfrac{a_{ux} \pi u_x \Rho_{\N}}{L} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) -\dot{\omega}_\N
\end{split}
\end{equation}
%
with $\Rho_\N$ and $\U$ defined in Equation (\ref{eq:aux_1d}). The source term $\dot{\omega}_\N$ is given by:
$$
\dot{\omega}_\N = -2 M_\N \mathcal{R}_1	
$$
where $M_{\text{N}}$ is the molar mass of Nitrogen and $\mathcal{R}_1$ is the reaction given according to Eq. (\ref{eq:reaction1}):
\begin{equation}\label{eq:reaction3}
\mathcal{R}_1= \dfrac{k_{f_1 \N}}{K(\T)} \dfrac{\Rho_{\N}^3}{M_\N^3} - k_{f_1 \N}   \dfrac{\Rho_{\N_2} \Rho_{\N}}{2  M_\N^2}+
\dfrac{k_{f_1 \N_2}}{K(\T)} \dfrac{\Rho_\N^2 \Rho_{\N_2}}{2M_\N^3 }- k_{f_1 \N_2} \dfrac{\Rho_{\N_2}^2}{4 M_\N^2},
\end{equation}
$K(\T)$ is a to-be-defined function for the equilibrium constant (\ref{eq:equilibrium_constant}), and $k_{f_1 \text{N}}$ and $k_{f_1 \text{N}_2}$ are defined by:
\begin{equation}
 \begin{split}\label{eq:forward_rates}
k_{f_1 \text{N}} &= C_{f_1 \text{N}} \bar{T}^{\eta_{f_1 \text{N}}} \exp\left(\dfrac{-E_{a\text{N}}}{R \bar{T}}\right),\\
k_{f_1 \text{N}_2} &= C_{f_1 \text{N}_2} \bar{T}^{\eta_{f_1 \text{N}_2}} \exp\left(\dfrac{-E_{a\text{N}_2}}{R \bar{T}}\right),\\
\bar{T}&=\T^q \TV^{1-q}.
 \end{split}
\end{equation}



\subsection{Mass Conservation of Nitrogen Molecule}

The mass conservation equation for Nitrogen molecule ($\text{N}_2$), written as an operator, is:
\begin{equation*}
 \label{eq:euler1d_11a}
\Lo =  \diff{\rho_{\text{N}_2} u }{x} - \dot{\omega}_{\text{N}_2}.
\end{equation*}

Analytically differentiating Equation (\ref{eq:manufactured02}) for $\rho_{\text{N}_2}$ and $u$ using operator $\Lo$ defined above together with suitable substitution for $\dot{\omega}_{\text{N}_2}$ gives the source term $Q_{\rho_{\text{N}_2}}$:

\begin{equation}
\begin{split}
Q_{\rho_{\N_2}} = -\dfrac{a_{  \rho \N_2 x } \pi \rho_{\N_2 x} \U }{L}\sin\left(\dfrac{a_{  \rho \N_2 x } \pi x}{L}\right) +\dfrac{a_{ux} \pi u_x \Rho_{\N_2}}{L} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) -\dot{\omega}_{\N_2}
\end{split}
\end{equation}
where $\Rho_{\N_2}$ and $\U$ defined in Equation (\ref{eq:aux_1d}) and:
$$
\dot{\omega}_{\N_2} =  M_{\N_2} \mathcal{R}_1	= 2 M_\N \mathcal{R}_1	
$$
with  $\mathcal{R}_1$ given in Equation (\ref{eq:reaction3}).


\subsection{Momentum Conservation}

For the generation of the analytical source term $Q_u$, $x$-momentum equation (\ref{eq:euler:u}) is written as an operator $\Lo$:
\begin{equation*}
 \label{eq:euler1d_12}
\Lo =\Diff{\rho u^2}{x}+\diff{p}{x},
\end{equation*}
which, when operated in to Equations (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}), provides source term $Q_{u}$:
%
\begin{equation}
\begin{split}
Q_u &=\dfrac{ a_{  \rho \N x } \pi \rho_{\N x} \U^2  }{L}\cos\left(\dfrac{a_{  \rho \N x } \pi x}{L}\right) +\\ 
&-\dfrac{a_{  \rho \N_2 x } \pi \rho_{\N_2 x} \U^2  }{L}\sin\left(\dfrac{a_{  \rho \N_2 x } \pi x}{L}\right) +\\ 
&+\dfrac{2 a_{ux} \pi u_x \Rho \U }{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right)  +\\ 
&-\dfrac{ a_{Tx} \pi T_x R  (2 \Rho_{\N}+\Rho_{\N_2})\sin\left(\dfrac{a_{Tx} \pi x}{L}\right) }{2L M_\N} +\\ 
&-\dfrac{ \pi R \T}{2L M_\N} \left[-2 a_{  \rho \N x } \rho_{\N x} \cos\left(\dfrac{a_{  \rho \N x } \pi x}{L}\right) +a_{  \rho \N_2 x } \rho_{\N_2 x} \sin\left(\dfrac{a_{  \rho \N_2 x } \pi x}{L}\right) \right]
\end{split}
\end{equation}
with $\Rho,\,\Rho_{\text{N}},\,\Rho_{\text{N}_2},\, \T$ and $\U$ defined in Equation (\ref{eq:aux_1d}).

\subsection{Total Energy Conservation}
The total energy equation is written as an operator:
\begin{equation*}
 \label{eq:euler1d_14}
\Lo =\diff{\rho u H}{x} ,
\end{equation*}
where $H= E+ \dfrac{p}{\rho} \quad \mbox{and}\quad E=e^{\text{int}} + \dfrac{u^2 }{2} ,$ with $p$ and $e^{\text{int}}$ as defined in Equations (\ref{eq:p_eq_state}) and (\ref{eq:energy_partition}), respectively.

Source term $Q_E$ is obtained by operating $\Lo$ on Equations (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}):

\begin{equation}
\begin{split}
Q_E &= \dfrac{3 a_{ux} \pi u_x \Rho \U^2 }{2L} \cos\left(\dfrac{a_{ux} \pi x}{L}\right) +\\ 
&+\dfrac{(h_{\N}^0+e_{\N}^{\elec}) a_{  \rho \N x } \pi \rho_{\N x} \U }{L} \cos\left(\dfrac{a_{  \rho \N x } \pi x}{L}\right) +\\ &-\dfrac{(h_{\N_2}^0+e_{\N_2}^{\elec}+e_{\N_2}^{\vib} \, ) a_{  \rho \N_2 x } \pi \rho_{\N_2 x} \U }{L} \sin\left(\dfrac{a_{  \rho \N_2 x } \pi x}{L}\right)  +\\ &+\dfrac{ (10 \Rho_{\N}+7 \Rho_{\N_2}) a_{ux} \pi u_x R \T  }{4L M_\N} \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+\\ 
&+\dfrac{(h_{\N}^0+e_{\N}^{\elec}) a_{ux} \pi u_x \Rho_{\N}}{L} \cos\left(\dfrac{a_{ux} \pi x}{L}\right)  +\\ 
&+\dfrac{(h_{\N_2}^0+e_{\N_2}^{\elec}+e_{\N_2}^{\vib} \, ) a_{ux} \pi u_x \Rho_{\N_2} }{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right) +\\ 
&-\dfrac{ (10 \Rho_{\N}+7 \Rho_{\N_2}) a_{Tx} \pi T_x R \U }{4L M_\N}\sin\left(\dfrac{a_{Tx} \pi x}{L}\right)  +\\ 
&-\dfrac{e_{\N_2}^{\vib} \, \theta^{\vib}_{\N_2} \,   a_{T_V x} \pi T_{Vx} \Rho_{\N_2} \U }{L \TV^2}\sin\left(\dfrac{a_{T_V x} \pi x}{L}\right) +\\
&-\dfrac{2 (e_{\N_2}^{\vib})^2 \, a_{T_V x} \pi T_{Vx} M_\N \Rho_{\N_2} \U }{L R \TV^2}\sin\left(\dfrac{a_{T_V x} \pi x}{L}\right) +\\
&-\dfrac{ \pi \U^3 }{2L}\left[-a_{  \rho \N x } \rho_{\N x} \cos\left(\dfrac{a_{  \rho \N x } \pi x}{L}\right) +a_{  \rho \N_2 x } \rho_{\N_2 x} \sin\left(\dfrac{a_{  \rho \N_2 x } \pi x}{L}\right) \right]  +\\ 
&-\dfrac{\pi R \U \T}{4L M_\N} \left[-10 a_{  \rho \N x } \rho_{\N x} \cos\left(\dfrac{a_{  \rho \N x } \pi x}{L}\right) +7 a_{  \rho \N_2 x } \rho_{\N_2 x} \sin\left(\dfrac{a_{  \rho \N_2 x } \pi x}{L}\right) \right]  +\\ 
&+\diff{e_{\N}^{\elec}}{x} \Rho_{\N} \U+\diff{e_{\N_2}^{\elec}}{x} \Rho_{\N_2} \U
\end{split}
\end{equation}
where $\Rho,\,\Rho_{\text{N}},\,\Rho_{\text{N}_2},\, \T$ and $\U$ are given  in Equation (\ref{eq:aux_1d}), the derivatives $\diff{e_{\N}^{\elec}}{x}$ and $\diff{e_{\N_2}^{\elec}}{x}$ are given in Equation (\ref{eq:aux_01}), and:
\begin{equation}
\begin{split}\label{eq:aux_02}
e_{\N}^{\elec} &=  \dfrac{R}{M_\N} \dfrac{\sum_{i=1}^{nel_{\N}}  \theta^{\elec}_{\N,i} \, g_{\N,i} \exp\left(- \theta^{\elec}_{\N,i}/ \TV \right)} { \sum_{i=1}^{nel_{\N}} g_{\N,i} \exp\left(-\theta^{\elec}_{\N,i}/\TV\right)},\vspace{5pt}	\\
%
e_{\N_2}^{\elec} &=\dfrac{R}{2 M_\N} \dfrac{\sum_{i=1}^{nel_{\N_2}}  \theta^{\elec}_{\N_2,i} \, g_{\N_2,i} \exp\left(- \theta^{\elec}_{\N_2,i} / \TV \right)} {\sum_{i=1}^{nel_{\N_2}} g_{\N_2,i} \exp\left(-\theta^{\elec}_{\N_2,i}/\TV\right)} \vspace{5pt},	\\
%
e_{\N_2}^{\vib} &= \dfrac{R}{2 M_\N} \frac{\theta^{\vib}_{\N_2}}{\exp\left(\theta^{\vib}_{\N_2}/ \TV \right) - 1} .
\end{split}
\end{equation}



\subsection{Vibrational Energy Conservation}
The vibrational energy equation is written as an operator:
\begin{equation*}
 \label{eq:euler1d_15}
\Lo =\diff{e_V \rho u }{x}-\dot{\omega}_V ,
\end{equation*}

For the N--N$_2$ mixture, $e_V$ is given by Equation (\ref{eq:rev-Tv-relationship}):
\begin{equation*}
\begin{split}
e_V= \dfrac{\rho_{\N_2}}{\rho} e_{\N_2}^{\vib} + \dfrac{\rho_{\N}}{\rho} e_{\N}^{\elec} + \dfrac{\rho_{\N_2}}{\rho} e_{\N_2}^{\elec}.
\end{split}
\end{equation*}

Therefore, source term $Q_{e_V}$ is obtained by operating $\Lo$ on Equations (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}):
%

\begin{equation}
\begin{split}\label{eq:source_eV}
Q_{e_V} &= \dfrac{e_{\N}^{\elec} a_{  \rho \N x } \pi \rho_{\N x} \U }{L} \cos\left(\dfrac{a_{  \rho \N x } \pi x}{L}\right) +\\ 
&- \dfrac{(e_{\N_2}^{\elec}+e_{\N_2}^{\vib} \, ) a_{  \rho \N_2 x } \pi \rho_{\N_2 x} \U }{L} \sin\left(\dfrac{a_{  \rho \N_2 x } \pi x}{L}\right)  +\\ 
&+ \dfrac{e_{\N}^{\elec} a_{ux} \pi u_x \Rho_{\N} }{L} \cos\left(\dfrac{a_{ux} \pi x}{L}\right)+\\ 
&+ \dfrac{(e_{\N_2}^{\elec}+e_{\N_2}^{\vib} \, ) a_{ux} \pi u_x \Rho_{\N_2} }{L}\cos\left(\dfrac{a_{ux} \pi x}{L}\right)  +\\ 
&-\dfrac{e_{\N_2}^{\vib} \, \theta^{\vib}_{\N_2} \, a_{T_V x} \pi T_{Vx}   \Rho_{\N_2} \U}{L \TV^2} \sin\left(\dfrac{a_{T_V x} \pi x}{L}\right) +\\
&-\dfrac{2 (e_{\N_2}^{\vib})^2 \, a_{T_V x} \pi T_{Vx} M_\N \Rho_{\N_2} \U }{L R \TV^2}\sin\left(\dfrac{a_{T_V x} \pi x}{L}\right) +\\
&+\diff{e_{\N}^{\elec}}{x} \Rho_{\N} \U+\diff{e_{\N_2}^{\elec}}{x} \Rho_{\N_2} \U +\\
&- \dot{\omega}_V
\end{split}
\end{equation}
%
where   $\Rho_{\text{N}},\,\Rho_{\text{N}_2},\, \T$ and $\U$ are given  in Equation (\ref{eq:aux_1d}),   $e_{\N}^{\elec}, e_{\N_2}^{\elec}$ and $e_{\N_2}^{\vib}  $ are given in Equation (\ref{eq:aux_02}). Source term e $\dot{\omega}_V$ is given according to Section \ref{sec:omega_v} as:
$$\dot{\omega}_V = \dot{\omega}_\N e_{\N}^{\elec} + \dot{\omega}_{\N_2} (e_{\N_2}^{\vib}+e_{\N_2}^{\elec})+\Rho_{\N_2} (e_{\N_2,eq}^{\vib}-e_{\N_2}^{\vib}) \left[\dfrac{2 \Rho_{\N}}{(2 \Rho_{\N}+\Rho_{\N_2}) \tau^{\vib}_{\N_2\N}}+\dfrac{\Rho_{\N_2}}{(2 \Rho_{\N}+\Rho_{\N_2}) \tau^{\vib}_{\N_2\N_2}}\right],$$
with
\begin{equation}
\begin{split}
e_{\N_2, eq}^{\vib} &= \dfrac{R}{2 M_\N} \frac{\theta^{\vib}_{\N_2}}{\exp\left(\theta^{\vib}_{\N_2}/ \T \right) - 1} , \vspace{5pt}\\
\tau^{\vib}_{\N_2\N_2} &= \dfrac{ \exp\left(\frac{29}{25000} M_\N^{1/2} (\theta^{\vib}_{\N_2})^{4/3}  \left[\T^{-1/3}-\frac{3}{2000} M_\N^{1/4}\right] -18.42\right)}{P}, \vspace{5pt}\\
\tau^{\vib}_{\N_2\N} &=\dfrac{ \exp\left(\frac{29}{75000} (6 M_\N)^{1/2} (\theta^{\vib}_{\N_2})^{4/3} \left[\T^{-1/3} -\frac{1}{200} (54M_\N)^{1/4}\right]-18.42\right)}{P}.
\end{split}
\end{equation}
and $P$ is given by the Dalton's law (\ref{eq:p_eq_state}):
$$P = \dfrac{\Rho_{\N}  \T R}{M_\N}+ \dfrac{\Rho_{\N_2}  \T R}{2 M_\N}.$$




\section{Hierarchic MMS}

The complexity, and consequently length, of the source terms increase with both dimension and physics handled by the governing equations. In some cases, such as the vibration energy equation, the final expression for $Q_{e_V}$ may pass 898,000 characters, including parenthesis and mathematical operators, prior to factorization.

Applying commands in order to simplify such extensive expression is challenging even with a very good machine; thus, a suitable alternative to this issue is to simplify the equation by dividing it into a combination of sub-operators handling different physical phenomena. Then, each one of the operators may be applied to the manufactured solutions individually and the resulting source terms are combined back to represent the source term for the original equation.


For instance, instead of writing the 1D steady vibrational energy equation using one single operator~$\Lo$:
\begin{equation}
 \label{eq:ns2d_04}
\begin{split}
\Lo= \diff{e_V \rho u }{x} -\dot{\omega}_V ,
%\Diff{\rho e_t}{t}& + \nabla \cdot (\rho \mathbf{u} H)+\nabla\cdot \mathbf{q} - \nabla \cdot (\bv{\tau u})
\end{split}
\end{equation}
to then be used in the MMS, let equation (\ref{eq:ns2d_04}) be written in two distinct operators:
\begin{equation*}
 \begin{split}
  \Lo_1&=\diff{e_V \rho u }{x},\\
  \Lo_2&= -\dot{\omega}_V.\\
   \end{split}
\end{equation*}

After the application of $\Lo_1$ and  $\Lo_2$,  the corresponding sub-source terms are also simplified, factorized and sorted. Then, the final factorized version is checked against the original one, to assure that not human error has been introduced.  This strategy  allowed the original  898,000 character-long  expression for $Q_{e_V}$ to be reduced to less than 6,400. Furthermore, this strategy combined with the use of the auxiliary variables listed in Equations (\ref{eq:aux_1d}) and (\ref{eq:aux_01}) allows the original source term to be reduced to only 2,600 characters (illustrated in Equation \ref{eq:source_eV}). The reduction is even more impressive in the transient case, where the over 7 million-character source term for the vibrational energy equation is reduced to only 11,500 and 3,200 characters, using the same strategy.



\subsection{Boundary Conditions and C Codes}

Source terms $Q_{\rho_\text{N} }$, $Q_{\rho \text{N}_{2}}$, $Q_u$, $Q_E$ and $Q_{e_V}$ have been generated by replacing the analytical Expressions (\ref{eq:manufactured02}) and~(\ref{eq:manufactured03}) into respective Equations (\ref{eq:euler:rhoN})--(\ref{eq:euler:eV}), followed by the usage of Maple commands for collecting, sorting and factorizing the terms. Files containing $C$ codes for the source terms have also been generated. They are: \texttt{ Euler\_1d\_steady\_chemistry\_2T\_rho\_N\_code.C, Euler\_1d\_steady\_chemistry\_2T\_rho\_N2\_code.C,\\ Euler\_1d\_steady\_chemistry\_2T\_u\_code.C, Euler\_1d\_steady\_chemistry\_2T\_E\_code.C} and \\
\texttt{Euler\_1d\_steady\_chemistry\_2T\_eV\_code.C}.

%\newpage
An example of the automatically generated C file from the source term for the mass conservation equation of N$_2$ is:
\begin{scriptsize}
 \begin{verbatim}
#include <math.h>

double SourceQ_rho_N2 (double x)
{
  double Q_rho_N2;
  double RHO_N;
  double RHO_N2;
  double U;
  double T;
  double TV;
  double kf1_N;
  double kf1_N2;
  double K;
  double R1;
  double w_dot_N2;
  double T_bar;
  RHO_N = rho_N_0 + rho_N_x * sin(a_rho_N_x * PI * x / L);
  RHO_N2 = rho_N2_0 + rho_N2_x * cos(a_rho_N2_x * PI * x / L);
  U = u_0 + u_x * sin(a_ux * PI * x / L);
  T = T_0 + T_x * cos(a_Tx * PI * x / L);
  TV = Tv_0 + Tv_x * cos(a_Tvx * PI * x / L);
  T_bar = pow(T, q) * pow(TV, 0.1e1 - q);
  K = calculate_equilibrium_constant_K(T);
  kf1_N2 = Cf1_N2 * pow(T_bar, etaf1_N2) * exp(-Ea_N2 / R / T_bar);
  kf1_N = Cf1_N * pow(T_bar, etaf1_N) * exp(-Ea_N / R / T_bar);
  R1 = kf1_N * pow(RHO_N, 0.3e1) / K * pow(M_N, -0.3e1) - kf1_N * RHO_N2 * RHO_N * pow(M_N, -0.2e1) / 0.2e1 
     + kf1_N2 * RHO_N * RHO_N * RHO_N2 / K * pow(M_N, -0.3e1) / 0.2e1 - kf1_N2 * RHO_N2 * RHO_N2 * pow(M_N, -0.2e1) / 0.4e1;
  w_dot_N2 = 0.2e1 * M_N * R1;
  Q_rho_N2 = -a_rho_N2_x * PI * rho_N2_x * U * sin(a_rho_N2_x * PI * x / L) / L 
     + a_ux * PI * u_x * RHO_N2 * cos(a_ux * PI * x / L) / L - w_dot_N2;
  return(Q_rho_N2);
}
 \end{verbatim}
\end{scriptsize}
%
and the source term for the vibrational energy $e_V$ of the mixture is:
\begin{scriptsize} 
\begin{verbatim}
#include <math.h>

double SourceQ_eV (double x, int energy_level_N, int energy_level_N2, double *g_N, double *g_N2, double *theta_e_N, double *theta_e_N2)
{
  double Q_eV;
  double e_elec_N;
  double e_elec_N_num;
  double e_elec_N_den;
  double e_elec_N2;
  double e_elec_N2_num;
  double e_elec_N2_den;
  double e_vib_N2;
  double e_vib_eq_N2;
  double RHO_N;
  double RHO_N2;
  double U;
  double T;
  double TV;
  double P;
  double tau_vib_N2_N;
  double tau_vib_N2_N2;
  double De_elecN2_Dx;
  double De_elecN_Dx;
  double AUX1;
  double AUX2;
  double w_dot_N;
  double w_dot_N2;
  double kf1_N;
  double kf1_N2;
  double R1;
  double K;
  double T_bar;
  int i;
  double w_dot_V;
  RHO_N = rho_N_0 + rho_N_x * sin(a_rho_N_x * PI * x / L);
  RHO_N2 = rho_N2_0 + rho_N2_x * cos(a_rho_N2_x * PI * x / L);
  U = u_0 + u_x * sin(a_ux * PI * x / L);
  T = T_0 + T_x * cos(a_Tx * PI * x / L);
  TV = Tv_0 + Tv_x * cos(a_Tvx * PI * x / L);
  P = RHO_N * R * T / M_N + RHO_N2 * R * T / M_N / 0.2e1;
  T_bar = pow(T, q) * pow(TV, 0.1e1 - q);
  K = calculate_equilibrium_constant_K(T);
  AUX1 = 0.0e0;
  AUX2 = 0.0e0;
  e_elec_N_num = 0.0e0;
  e_elec_N2_num = 0.0e0;
  e_elec_N_den = 0.0e0;
  e_elec_N2_den = 0.0e0;
  for (i = 1; i <= energy_level_N; i++)
  {
    e_elec_N_den = e_elec_N_den + g_N[i - 1] * exp(-theta_e_N[i - 1] / TV);
    e_elec_N_num = e_elec_N_num + theta_e_N[i - 1] * g_N[i - 1] * exp(-theta_e_N[i - 1] / TV);
    AUX1 = AUX1 + pow(theta_e_N[i - 1], 0.2e1) * g_N[i - 1] * exp(-theta_e_N[i - 1] / TV);
  }
  for (i = 1; i <= energy_level_N2; i++)
  {
    e_elec_N2_den = e_elec_N2_den + g_N2[i - 1] * exp(-theta_e_N2[i - 1] / TV);
    e_elec_N2_num = e_elec_N2_num + theta_e_N2[i - 1] * g_N2[i - 1] * exp(-theta_e_N2[i - 1] / TV);
    AUX2 = AUX2 + pow(theta_e_N2[i - 1], 0.2e1) * g_N2[i - 1] * exp(-theta_e_N2[i - 1] / TV);
  }
  e_elec_N = R * e_elec_N_num / M_N / e_elec_N_den;
  e_elec_N2 = R * e_elec_N2_num / M_N / e_elec_N2_den / 0.2e1;
  e_vib_N2 = R * theta_v_N2 / M_N / (exp(theta_v_N2 / TV) - 0.1e1) / 0.2e1;
  e_vib_eq_N2 = R * theta_v_N2 / M_N / (exp(theta_v_N2 / T) - 0.1e1) / 0.2e1;
  De_elecN_Dx = e_elec_N * e_elec_N * M_N * a_Tvx * PI * Tv_x * sin(a_Tvx * PI * x / L) / R * pow(TV, -0.2e1) / L 
    - R * AUX1 * a_Tvx * PI * Tv_x * sin(a_Tvx * PI * x / L) / M_N / e_elec_N_den * pow(TV, -0.2e1) / L;
  De_elecN2_Dx = 0.2e1 * e_elec_N2 * e_elec_N2 * M_N * a_Tvx * PI * Tv_x * sin(a_Tvx * PI * x / L) / R * pow(TV, -0.2e1) / L 
    - R * AUX2 * a_Tvx * PI * Tv_x * sin(a_Tvx * PI * x / L) / M_N / e_elec_N2_den * pow(TV, -0.2e1) / L / 0.2e1;
  tau_vib_N2_N = exp(0.29e2 / 0.75000e5 * sqrt(0.6e1) * sqrt(M_N) * pow(theta_v_N2, 0.4e1 / 0.3e1) 
    * (pow(T, -0.1e1 / 0.3e1) - pow(0.54e2, 0.1e1 / 0.4e1) * pow(M_N, 0.1e1 / 0.4e1) / 0.200e3) - 0.921e3 / 0.50e2) / P;
  tau_vib_N2_N2 = exp(0.29e2 / 0.25000e5 * sqrt(M_N) * pow(theta_v_N2, 0.4e1 / 0.3e1) 
    * (pow(T, -0.1e1 / 0.3e1) - 0.3e1 / 0.200e3 * pow(M_N, 0.1e1 / 0.4e1)) - 0.921e3 / 0.50e2) / P;
  kf1_N2 = Cf1_N2 * pow(T_bar, etaf1_N2) * exp(-Ea_N2 / R / T_bar);
  kf1_N = Cf1_N * pow(T_bar, etaf1_N) * exp(-Ea_N / R / T_bar);
  R1 = -RHO_N * RHO_N2 * kf1_N * pow(M_N, -0.2e1) / 0.2e1 - RHO_N2 * RHO_N2 * kf1_N2 * pow(M_N, -0.2e1) / 0.4e1 
    + RHO_N * RHO_N * RHO_N2 * kf1_N2 / K * pow(M_N, -0.3e1) / 0.2e1 + pow(RHO_N, 0.3e1) * kf1_N / K * pow(M_N, -0.3e1);
  w_dot_N = -0.2e1 * M_N * R1;
  w_dot_N2 = -w_dot_N;
  w_dot_V = e_elec_N * w_dot_N + (e_vib_N2 + e_elec_N2) * w_dot_N2 + (e_vib_eq_N2 - e_vib_N2) * RHO_N2 
    * (0.2e1 * RHO_N / (0.2e1 * RHO_N + RHO_N2) / tau_vib_N2_N + RHO_N2 / (0.2e1 * RHO_N + RHO_N2) / tau_vib_N2_N2);
  Q_eV = e_elec_N * a_rho_N_x * PI * rho_N_x * U * cos(a_rho_N_x * PI * x / L) / L 
    - (e_vib_N2 + e_elec_N2) * a_rho_N2_x * PI * rho_N2_x * U * sin(a_rho_N2_x * PI * x / L) / L 
    + e_elec_N * a_ux * PI * u_x * RHO_N * cos(a_ux * PI * x / L) / L 
    + (e_vib_N2 + e_elec_N2) * a_ux * PI * u_x * RHO_N2 * cos(a_ux * PI * x / L) / L 
    - e_vib_N2 * a_Tvx * PI * Tv_x * theta_v_N2 * RHO_N2 * U * sin(a_Tvx * PI * x / L) / L * pow(TV, -0.2e1) 
    - 0.2e1 * e_vib_N2 * e_vib_N2 * M_N * a_Tvx * PI * Tv_x * RHO_N2 * U * sin(a_Tvx * PI * x / L) / R * pow(TV, -0.2e1) / L 
    + De_elecN_Dx * RHO_N * U + De_elecN2_Dx * RHO_N2 * U - w_dot_V;
  return(Q_eV);
}
\end{verbatim}
 \end{scriptsize}

Finally, the gradients of the analytical solutions (\ref{eq:manufactured02}) and (\ref{eq:manufactured03}) have also been computed and their respective C codes are presented in  \texttt{Euler\_1d\_chemistry\_manuf\_solutions\_grad\_and\_code.C}. Therefore,
\begin{equation}
\begin{split}
\nabla \rho_{\text{N}} &=  \dfrac{ a_{ \rho \text{N} x} \pi \rho_{\text{N}x} }{L} \cos\left( \dfrac{ a_{\rho \text{N} x} \pi x }{L}\right),
\quad\quad\quad\,
\nabla \rho_{\text{N}_2} =  \dfrac{ a_{ \rho \text{N}_2 x} \pi \rho_{\text{N}_2 x} }{L} \sin\left( \dfrac{ a_{ \rho \text{N}_2 x} \pi x }{L}\right),\vspace{10pt}\\
\quad
%
\nabla T &=- \dfrac{ a_{Tx} \pi T_x }{L} \sin\left( \dfrac{ a_{Tx} \pi x }{L}\right),
\quad\qquad\qquad
%
\nabla u = \dfrac{ a_{ux} \pi u_x}{L} \cos\left( \dfrac{ a_{ux} \pi x }{L}\right),
\vspace{10pt}\\
%
\nabla T_V &= - \dfrac{ a_{T_V x} \pi T_{Vx} }{L} \sin\left( \dfrac{ a_{T_Vx} \pi x }{L}\right),
\quad\quad\quad\,\,
%
\nabla \rho =\nabla \left( \rho_\text{N}\right) + \nabla \left(\rho_{\text{N}_2} \right),
\end{split}
\end{equation}
 are written in C language as:




\begin{small}
	

\begin{verbatim}
grad_rho_an_N[0] = rho_N_x * cos(a_rho_N_x * pi * x / L) * a_rho_N_x * pi / L;
grad_rho_an_N2[0] = -rho_N2_x * sin(a_rho_N2_x * pi * x / L) * a_rho_N2_x * pi / L;
grad_rho_an[0] = rho_N_x * cos(a_rho_N_x * pi * x / L) * a_rho_N_x * pi / L 
	       - rho_N2_x * sin(a_rho_N2_x * pi * x / L) * a_rho_N2_x * pi / L;
grad_u_an[0] = u_x * cos(a_ux * pi * x / L) * a_ux * pi / L;
grad_T_an[0] = -T_x * sin(a_Tx * pi * x / L) * a_Tx * pi / L;
grad_Tv_an[0] = -Tv_x * sin(a_Tvx * pi * x / L) * a_Tvx * pi / L;
\end{verbatim}


\end{small}

%---------------------------------------------------------------------------------------------------------
%\bibliographystyle{ieeetr}
\bibliographystyle{chicago} 
\bibliography{../../MMS_bib}


\appendix

\input{list_of_variables}

\end{document}
